import{api as i}from"./axios.af8f8fcb.js";import{u as d}from"./useHelpers.1a30e8cf.js";import{u as f}from"./auth-user.5d5f881c.js";import{r as a,a as _,t as b,C as g}from"./index.33b032fc.js";const r=a(!1),n=a([]),e=a({nombre:"",direccion:"",establecimiento:"",punto_emision:"",secuencia_factura_produccion:"",secuencia_factura_pruebas:"",company_id:"",ambiente:"PRUEBA"}),c=a(!1),l=a(!1),m=a(!1),S=f(),{claim:p}=_.read(S.token),y=async()=>{n.value=[];const{data:o}=await i.get("/companies");o.forEach(t=>{n.value.push({label:t.nombre_comercial,value:t.id})})},U=()=>{const{mostrarNotify:o}=d(),t=()=>{e.value.nombre="",e.value.direccion="",e.value.establecimiento="",e.value.punto_emision="",e.value.secuencia_factura_produccion="",e.value.company_id=""},v=()=>{e.value.establecimiento=e.value.establecimiento.toString().replace(/\D/g,""),e.value.punto_emision=e.value.punto_emision.toString().replace(/\D/g,""),e.value.secuencia_factura_produccion=e.value.secuencia_factura_produccion.toString().replace(/\D/g,"")};return b(()=>{g(e.value,(s,u)=>{e.value.nombre=s.nombre.toUpperCase()})}),{actualizarLista:m,api:i,claim:p,formSucursal:e,loading:r,limpiarFormulario:t,cargarCompanies:y,listCompanies:n,allowOnlyNumber:v,modalAgregarSucursal:c,modalEditarSucursal:l,onSubmit:async s=>{if(parseInt(e.value.establecimiento)<=0||parseInt(e.value.punto_emision)<=0||parseInt(e.value.secuencia_factura_produccion)<=0)return o("warning","Los valores deben ser mayor o igual a 1");try{if(r.value=!0,s)e.value.establecimiento=e.value.establecimiento.toString(),e.value.punto_emision=e.value.punto_emision.toString(),e.value.secuencia_factura_produccion=e.value.secuencia_factura_produccion.toString(),await i.patch("/sucursal/"+e.value.id,e.value);else{let u;if(p.roles[0]=="Super-Administrador"){if(e.value.company_id=="")return r.value=!1,o("warning","Debes seleccionar alguna empresa");u={headers:{company_id:e.value.company_id}}}await i.post("/sucursal",e.value,u)}o("positive",`Sucursal ${s?"editado":"agregado"} exitosamente`),c.value=!1,l.value=!1,m.value=!0,r.value=!1}catch(u){console.log(u),r.value=!1}}}};export{U as u};
