import{Q as T,a as h}from"./QBreadcrumbs.1badd016.js";import{r as v,l as B,o as $,c as x,f as o,g as n,e,ae as r,Q as f,ad as a,i as V,h as _,bc as D,aU as Q,aV as C,aW as F,O as P,bb as M,ba as R,aj as A,d as z,a as H,af as O}from"./index.0072019f.js";import{Q as G}from"./QSelect.8e1d4322.js";import{Q as E}from"./QForm.8ee574e6.js";import{C as K}from"./ClosePopup.c5bac205.js";import{a as j}from"./axios.33d7c27d.js";import{u as W}from"./useHelpers.601a8809.js";import{u as J}from"./useSucursal.1fe22896.js";import{u as L}from"./use-quasar.ee20291b.js";import"./format.a97667ab.js";const w=v({id:"",host:"",usuario:"",puerto:0,password:"",email_client:"",seguridad:"",empresa:"",company_id:null}),q=v(!1),X=v(!1),Y=v(!0),Z=v(!1),ee=()=>{const{mostrarNotify:c}=W();return{api:j,formEmail:w,mostrarNotify:c,limpiarFormulario:()=>{w.value={id:"",host:"",usuario:"",puerto:0,password:"",email_client:"",seguridad:"",empresa:"",company_id:null}},loading:q,onSubmit:async()=>{try{q.value=!0;const{id:s,company_id:m,empresa:b,puerto:y,...u}=w.value,{data:d}=await j.patch(`/email/${s}`,{...u,company_id:b,puerto:y});c("positive",d.msg),q.value=!1,q.value=!1}catch(s){q.value=!1,c("warning",s.response.data.message)}},loadingTesting:X,isPwd:Y,prompt:Z}};const se={class:"row"},te=e("label",{for:""},"Host/servidor:",-1),le=[te],oe=e("label",{for:""},"Puerto:",-1),ae=[oe],ie=e("label",{for:""},"Usuario/Correo:",-1),re=[ie],ne=e("label",{for:""},"Contrase\xF1a:",-1),de=[ne],me=e("label",{for:""},"Empresa:",-1),ue=[me],ce=e("div",{class:"text-h6"},"Correo del cliente",-1),pe={__name:"FormEmail",props:["edit"],setup(c){const g=B(),{api:p,formEmail:s,loadingTesting:m,onSubmit:b,mostrarNotify:y,isPwd:u,prompt:d}=ee();let{cargarCompanies:S,listCompanies:U}=J();S();const I=async()=>{const{data:t}=await p.get(`/email/${g.params.email_id}`);s.value={...t,empresa:t.company_id.id}},k=async()=>{try{m.value=!0;const{data:t}=await p.post("/email/testing",{...s.value,puerto:parseInt(s.value.puerto)});y("positive",t),m.value=!1,d.value=!1}catch(t){let l="";m.value=!1,t.response?t.response.data.message?l=t.response.data.message:l=`${t.response.data.code} - ${t.response.data.command} `:l="Hubo un error al enviar el email, por favor verique bien sus datos",y("negative",l),d.value=!1}},N=()=>{s.value.puerto=s.value.puerto.replace(/\D/g,"")};return I(),(t,l)=>($(),x(A,null,[o(E,{onSubmit:l[7]||(l[7]=i=>a(b)())},{default:n(()=>[e("div",se,[e("div",{class:r(["col-xs-11 col-md-2 flex items-center q-mt-lg",[t.$q.screen.width<1022?"justify-center q-mt-lg":"justify-end"]])},le,2),e("div",{class:r(["col-xs-11 col-md-3 q-ml-md",[t.$q.screen.width<1022?"q-mt-sm":"q-mt-lg"]])},[o(f,{modelValue:a(s).host,"onUpdate:modelValue":l[0]||(l[0]=i=>a(s).host=i),modelModifiers:{trim:!0},"input-class":"resaltarTextoInput",dense:"",outlined:"",required:""},null,8,["modelValue"])],2),e("div",{class:r(["col-xs-11 col-md-2 flex items-center q-mt-lg",[t.$q.screen.width<1022?"justify-center":"justify-end"]])},ae,2),e("div",{class:r(["col-xs-11 col-md-3 q-ml-md",[t.$q.screen.width<1022?"q-mt-sm":"q-mt-lg"]])},[o(f,{type:t.$q.platform.is.mobile?"number":"text",modelValue:a(s).puerto,"onUpdate:modelValue":l[1]||(l[1]=i=>a(s).puerto=i),modelModifiers:{trim:!0},"input-class":"resaltarTextoInput",onKeyup:N,dense:"",outlined:"",required:""},null,8,["type","modelValue"])],2),e("div",{class:r(["col-xs-11 col-md-2 flex items-center q-mt-lg",[t.$q.screen.width<1022?"justify-center":"justify-end"]])},re,2),e("div",{class:r(["col-xs-11 col-md-3 q-ml-md",[t.$q.screen.width<1022?"q-mt-sm":"q-mt-lg"]])},[o(f,{modelValue:a(s).usuario,"onUpdate:modelValue":l[2]||(l[2]=i=>a(s).usuario=i),modelModifiers:{trim:!0},"input-class":"resaltarTextoInput",dense:"",outlined:"",required:""},null,8,["modelValue"])],2),e("div",{class:r(["col-xs-11 col-md-2 flex items-center q-mt-lg",[t.$q.screen.width<1022?"justify-center":"justify-end"]])},de,2),e("div",{class:r(["col-xs-11 col-md-3 q-ml-md",[t.$q.screen.width<1022?"q-mt-sm":"q-mt-lg"]])},[o(f,{"input-class":"resaltarTextoInput",type:a(u)?"password":"text","label-color":"blue-grey-3",outlined:"",dense:"",modelValue:a(s).password,"onUpdate:modelValue":l[4]||(l[4]=i=>a(s).password=i),modelModifiers:{trim:!0},required:""},{append:n(()=>[o(V,{name:a(u)?"visibility_off":"visibility",color:"blue-grey",class:"cursor-pointer",onClick:l[3]||(l[3]=i=>u.value=!a(u))},null,8,["name"])]),prepend:n(()=>[o(V,{name:"key"})]),_:1},8,["type","modelValue"])],2),e("div",{class:r(["col-xs-11 col-md-2 flex items-center q-mt-lg",[t.$q.screen.width<1022?"justify-center":"justify-end"]])},ue,2),e("div",{class:r(["col-xs-11 col-md-3 q-ml-md",[t.$q.screen.width<1022?"q-mt-sm":"q-mt-lg"]])},[o(G,{outlined:"",dense:"",modelValue:a(s).empresa,"onUpdate:modelValue":l[5]||(l[5]=i=>a(s).empresa=i),readonly:"","emit-value":"","map-options":"",options:a(U)},null,8,["modelValue","options"])],2),e("div",{class:r(["col-xs-11 col-md-11 q-ml-md text-center q-pb-xl q-pt-lg",[t.$q.screen.width<1022?"q-mt-sm":"q-mt-lg"]])},[o(_,{onClick:l[6]||(l[6]=i=>d.value=!a(d)),label:"Probar Configuraci\xF3n",class:r([[t.$q.screen.width>600||"q-mb-md"],"q-mr-lg"]),"icon-right":"send",outline:"",rounded:"",style:D([{color:"#696cff"},!t.$q.platform.is.mobile||"font-size: 12px"])},null,8,["class","style"]),o(_,{type:"submit",label:"Guardar","icon-right":"save",outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}})],2)])]),_:1}),o(R,{modelValue:a(d),"onUpdate:modelValue":l[9]||(l[9]=i=>M(d)?d.value=i:null)},{default:n(()=>[o(Q,{style:{"min-width":"350px"}},{default:n(()=>[o(C,null,{default:n(()=>[ce]),_:1}),o(E,{onSubmit:k},{default:n(()=>[o(C,{class:"q-pt-none"},{default:n(()=>[o(f,{type:"email",dense:"",modelValue:a(s).email_client,"onUpdate:modelValue":l[8]||(l[8]=i=>a(s).email_client=i),autofocus:"",required:""},null,8,["modelValue"])]),_:1}),o(F,{align:"right",class:"text-primary"},{default:n(()=>[P(o(_,{flat:"",label:"Cancelar"},null,512),[[K]]),o(_,{type:"submit",loading:a(m),flat:"",label:"Enviar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},fe={class:"q-ma-lg q-pt-md"},qe={class:"row q-col-gutter-lg"},ve={class:"col-12"},ge={key:0,class:"col-xs-12 col-sm-12 col-md-6"},ye=e("label",{class:"text-h6 q-pr-md"},"Datos del servidor correo",-1),_e=[ye],be={class:"q-px-md"},he={class:"row q-col-gutter-md"},we={class:"col-xs-12 col-md-12 q-pt-xs"},ke=z({__name:"EditEmail",setup(c){const g=L(),{claim:p}=H.read(g.token);return(s,m)=>($(),x("div",fe,[e("div",qe,[e("div",ve,[o(Q,{flat:"",class:"shadow_custom"},{default:n(()=>[e("div",{class:r(["row q-py-md q-pl-md",s.$q.screen.xs?"justify-center":"justify-between"])},[a(p).roles[0]=="SUPER-ADMINISTRADOR"?($(),x("div",ge,[o(T,{class:r(["row q-mr-lg",[s.$q.screen.width<1022?"justify-center q-pt-sm":"justify-start "]])},{default:n(()=>[o(h,{label:"Inicio",icon:"home",to:"/"}),o(h,{label:"Emails",icon:"mail",to:"/emails"}),o(h,{label:"Email",icon:"edit"})]),_:1},8,["class"])])):O("",!0),e("div",{class:r(["col-xs-12 col-sm-12 col-md-6 q-mt-sm",[s.$q.screen.width<1022?"text-center":"text-right"]])},_e,2)],2),e("div",be,[e("div",he,[e("div",we,[o(pe,{edit:!0})])])])]),_:1})])])]))}});export{ke as default};
