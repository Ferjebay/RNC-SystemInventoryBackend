import{d as I,r as N,o as n,a9 as y,g as s,bc as R,aU as j,f as c,e,ab as a,aV as D,ae as r,c as i,af as b,ad as m,aa as u,O as v,h as S}from"./index.c1e9c266.js";import{Q as w}from"./QBadge.26100003.js";import{Q as _}from"./QTd.73524116.js";import{Q as F}from"./QInnerLoading.6590b929.js";import{Q as E}from"./QTable.fe6d5a67.js";import{a as q,Q as T,d as P}from"./format.94f2824d.js";import{Q as L}from"./QList.6ef072d3.js";import{Q as U}from"./QBtnDropdown.cafef135.js";import{C as k}from"./ClosePopup.e17be494.js";import{u as V}from"./useHelpers.b0f80051.js";const z={class:"text-h6 text-center"},M={class:"row q-gutter-sm text-center"},H=e("label",{class:"text-subtitle1 text-weight-medium"}," Num. Comprobantes: ",-1),X=[H],G=e("label",{class:"text-subtitle1 text-weight-medium"},"Clave de Acceso:",-1),J=[G],K={style:{width:"100%","word-wrap":"break-word"}},W=e("label",{class:"text-subtitle1 text-weight-medium"},"Descripci\xF3n:",-1),Y=[W],Z=e("label",{class:"text-subtitle1 text-weight-medium"},"Sucursal:",-1),ee=[Z],te={class:"text-subtitle1 text-weight-medium"},le={key:0},se={key:1},ae=e("label",{class:"text-subtitle1 text-weight-medium"},"Usuario:",-1),oe=[ae],ce={class:"text-subtitle1 text-weight-medium"},re={key:0},ne={key:1},de=e("label",{class:"text-subtitle1 text-weight-medium"}," Estado: ",-1),ie=[de],ue={class:"col-xs-12 col-sm-12 q-my-sm"},me={class:"row"},_e={key:0,class:"col-xs-12 col-sm-6 row items-center"},xe={style:{"margin-right":"5px"}},pe={class:"text-right"},be=e("td",null,[e("b",null,"TOTAL BRUTO:")],-1),he={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},ye={class:"text-right"},ge=e("td",{class:""},[e("b",null,"DESCUENTOS:")],-1),fe={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},De={class:"text-right"},ve=e("td",null,[e("b",null,"SUBTOTAL:")],-1),we={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},qe={class:"text-right"},Te={class:"q-py-none"},Pe={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},ke={class:"text-right"},$e={style:{width:"90px"}},Ce={key:1,class:"col-xs-12 row justify-center q-my-sm col-sm-5"},Ee=I({__name:"DetalleProducts",props:{detalleData:{}},setup($){const t=$,C=[{label:"Codigo",align:"left",name:"codigoBarra"},{label:"Producto",align:"left",name:"product"},{label:"Cantidad",align:"center",field:"cantidad"},{label:"Precio de Venta",align:"center",name:"pvp"},{name:"descuento",label:"Descuento",align:"center"},{name:"iva",label:"Aplica IVA",align:"center"},{name:"total",label:"Total",align:"center"}],{api:Q,claim:A,mostrarNotify:O,formatearNumero:x}=V();let p;t.detalleData.buyToProduct?t.detalleData.isActive?p="Aceptado":p="Anulado":p=t.detalleData.estadoSRI;const g=async(o,d)=>{try{const{data:l}=await Q.post("/invoices/download-ride-xml",{clave_acceso:o,tipo_documento:d,razon_social:A.company.nombre_comercial},{responseType:"arraybuffer"}),B=new Blob([l],{type:d=="ride"?"application/pdf":"application/xml"}),h=document.createElement("a");h.href=window.URL.createObjectURL(B),h.download=`${o}${d=="ride"?".pdf":".xml"}`,document.body.appendChild(h),h.click(),document.body.removeChild(h)}catch{O("negative","No se encontro el archivo")}},f=N({sortBy:"desc",descending:!1,page:1,rowsPerPage:10,rowsNumber:15});return(o,d)=>(n(),y(j,{style:R(o.$q.screen.width<=1023?"max-width: 92vw;":"max-width: 60vw;")},{default:s(()=>[c(D,{class:"q-pb-none"},{default:s(()=>[e("div",z,a(t.detalleData.buyToProduct?"Detalle de Compra":t.detalleData.estadoSRI=="PROFORMA"?"Detalle de la Proforma":"Detalle de la Factura"),1)]),_:1}),c(D,{class:"q-pb-none q-pt-xs"},{default:s(()=>[e("div",M,[e("div",{class:r(["col-xs-12 col-sm-5",[o.$q.screen.xs?"text-center":"text-right"]])},X,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-sm flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,a(t.detalleData.numero_comprobante),1)],2),t.detalleData.buyToProduct?b("",!0):(n(),i("div",{key:0,class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},J,2)),t.detalleData.buyToProduct?b("",!0):(n(),i("div",{key:1,class:r(["col-xs-12 col-sm-6 q-mt-none flex items-center",[o.$q.screen.xs?"justify-left":"q-ml-lg text-left"]])},[e("label",K,a(t.detalleData.clave_acceso),1)],2)),t.detalleData.buyToProduct?(n(),i("div",{key:2,class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},Y,2)):b("",!0),t.detalleData.buyToProduct?(n(),i("div",{key:3,class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,a(t.detalleData.descripcion),1)],2)):b("",!0),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},ee,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,a(t.detalleData.sucursal_id.nombre),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},[e("label",te,a(t.detalleData.buyToProduct?"Proveedor":"Cliente"),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[t.detalleData.buyToProduct?(n(),i("label",le,a(t.detalleData.proveedor_id.razon_social),1)):(n(),i("label",se,a(t.detalleData.customer_id.nombres),1))],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},oe,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,a(t.detalleData.user_id.fullName.toUpperCase()),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},[e("label",ce,a(t.detalleData.buyToProduct?"Fecha de Compra:":"Fecha de Emisi\xF3n:"),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[t.detalleData.buyToProduct?(n(),i("label",re,a(t.detalleData.fecha_compra),1)):(n(),i("label",ne,a(t.detalleData.created_at),1))],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},ie,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[c(w,{outline:"",class:"q-py-xs q-px-md",color:o.$q.dark.isActive?"blue-grey-3":"blue-grey-7",label:m(p)},null,8,["color","label"])],2),e("div",ue,[c(E,{style:{"max-height":"300px"},class:r([o.$q.dark.isActive?"":"my-sticky-header-table2"]),rows:t.detalleData.invoiceToProduct?t.detalleData.invoiceToProduct:t.detalleData.buyToProduct,columns:C,pagination:f.value,"onUpdate:pagination":d[0]||(d[0]=l=>f.value=l),"hide-bottom":"","row-key":"name"},{"body-cell-indice":s(l=>[c(_,{props:l},{default:s(()=>[u(a(l.pageIndex+1),1)]),_:2},1032,["props"])]),"body-cell-descuento":s(l=>[c(_,{props:l},{default:s(()=>[u(a(l.row.descuento)+"%",1)]),_:2},1032,["props"])]),"body-cell-product":s(l=>[c(_,{props:l},{default:s(()=>[u(a(l.row.product_id.nombre),1)]),_:2},1032,["props"])]),"body-cell-iva":s(l=>[t.detalleData.buyToProduct?(n(),y(_,{key:0,props:l},{default:s(()=>[u(a(l.row.iva?"SI":"NO"),1)]),_:2},1032,["props"])):(n(),y(_,{key:1},{default:s(()=>[u(a(l.row.product_id.aplicaIva?"SI":"NO"),1)]),_:2},1024))]),"body-cell-total":s(l=>[c(_,{props:l},{default:s(()=>[u(a(l.row.v_total),1)]),_:2},1032,["props"])]),"body-cell-codigoBarra":s(l=>[c(_,{props:l},{default:s(()=>[u(a(l.row.product_id.codigoBarra),1)]),_:2},1032,["props"])]),"body-cell-pvp":s(l=>[c(_,{props:l},{default:s(()=>[u(a(m(x)(parseFloat(l.row.v_total)/parseInt(l.row.cantidad))),1)]),_:2},1032,["props"])]),loading:s(()=>[c(F,{showing:"",color:"primary"})]),_:1},8,["class","rows","pagination"]),e("div",me,[!o.$q.screen.xs&&m(p)!=="PROFORMA"?(n(),i("div",_e,[c(U,{class:"q-mr-xs",label:"Descargar Documento",outline:"",color:"primary",icon:"download"},{default:s(()=>[c(L,null,{default:s(()=>[v((n(),y(q,{clickable:"",onClick:d[1]||(d[1]=l=>g(t.detalleData.clave_acceso,"ride"))},{default:s(()=>[c(T,null,{default:s(()=>[c(P,null,{default:s(()=>[u("Descargar RIDE")]),_:1})]),_:1})]),_:1})),[[k]]),v((n(),y(q,{onClick:d[2]||(d[2]=l=>g(t.detalleData.clave_acceso,"xml")),clickable:""},{default:s(()=>[c(T,null,{default:s(()=>[c(P,null,{default:s(()=>[u("Descargar XML")]),_:1})]),_:1})]),_:1})),[[k]])]),_:1})]),_:1})])):b("",!0),e("div",{class:r(["col-xs-12 col-sm-6",[m(p)=="PROFORMA"?"col-sm-12":"col-sm-5"]]),style:{display:"flex","justify-content":"end"}},[e("table",xe,[e("tr",pe,[be,e("td",he,a(m(x)(t.detalleData.subtotal)),1)]),e("tr",ye,[ge,e("td",fe,a(m(x)(t.detalleData.descuento)),1)]),e("tr",De,[ve,e("td",we,a(m(x)(parseFloat(t.detalleData.subtotal)-parseFloat(t.detalleData.descuento))),1)]),e("tr",qe,[e("td",Te,[e("b",null,"IVA("+a(t.detalleData.porcentaje_iva)+"%):",1)]),e("td",Pe,a(m(x)(t.detalleData.iva)),1)]),e("tr",ke,[e("td",null,[e("b",null,a(t.detalleData.buyToProduct?"TOTAL DE COMPRA:":"TOTAL DE VENTA:"),1)]),e("td",$e,[c(w,{outline:"",class:"text-subtitle1 text-weight-bold",color:"secondary",label:`${m(x)(t.detalleData.total)}`},null,8,["label"])])])])],2),o.$q.screen.xs?(n(),i("div",Ce,[c(S,{type:"submit",label:"Descargar Documento","icon-right":"picture_as_pdf",outline:"",rounded:"",style:{color:"#696cff"},size:"14px"})])):b("",!0)])])])]),_:1})]),_:1},8,["style"]))}});export{Ee as _};
