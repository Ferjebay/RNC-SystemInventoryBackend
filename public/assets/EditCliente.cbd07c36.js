import{Q as $t,a as Me}from"./QBreadcrumbs.7ae23304.js";import{k as wt,t as Ne,r as S,n as G,x as st,B as qt,bH as rt,N as ae,a6 as fe,p as J,am as Je,al as xt,bf as Ct,i as oe,M as kt,z as Le,bb as Vt,aH as At,m as De,au as Oe,V as et,v as Ie,a0 as Pt,K as It,L as St,s as nt,H as Tt,I as Dt,Z as Et,o as y,a7 as I,g as a,e,ac as V,f as t,Q as ee,ab as b,a9 as k,h as Q,a8 as x,c as re,ad as X,aP as be,aQ as ge,af as Ce,aT as Ue,ah as Se,bs as Qe,a5 as Ft,bo as Rt,bI as Mt,bJ as Nt,w as Ot,ag as Ut,aI as Lt,aS as tt}from"./index.63602cd2.js";import{u as ke}from"./useCliente.0eb6e3da.js";import{u as Qt,a as Bt,b as jt,c as Yt,e as he,d as zt,_ as Gt}from"./ServicioInternet.259dc489.js";import{Q as Ht}from"./QResizeObserver.a766e183.js";import{r as Kt,Q as Te}from"./QSelect.eb6986f4.js";import{Q as ie}from"./QBadge.3ad7d9bf.js";import{Q as Ve}from"./QForm.3f67d641.js";import{d as z}from"./date.c89e349e.js";import{Q as Be,a as Y}from"./QTable.fc3e737e.js";import{a as _e,Q as at}from"./QTooltip.5a826ced.js";import{C as we}from"./ClosePopup.4ff1d69f.js";import{a as me,Q as se,c as ne}from"./QItemLabel.b338ce31.js";import{Q as Wt}from"./QList.ad591dc3.js";import{Q as ot}from"./QDate.4f66fb24.js";import{Q as lt}from"./QPopupProxy.4642cfe0.js";import{M as Zt}from"./index.2065a85c.js";import"./useHelpers.d026a779.js";import"./use-quasar.37c9aa3a.js";import"./axios.22257619.js";import"./touch.3df10340.js";import"./QChip.8319138a.js";import"./ModalMapBox.82c4a0d2.js";import"./QBtnGroup.c72eeeaa.js";import"./format.2bc25e5f.js";let Xt=0;const Jt=["click","keydown"],ea={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${Xt++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function ta(s,h,l,u){const d=wt(rt,Ne);if(d===Ne)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Ne;const{proxy:T}=Le(),N=S(null),E=S(null),R=S(null),D=G(()=>s.disable===!0||s.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},s.ripple===!0?{}:s.ripple)),O=G(()=>d.currentModel.value===s.name),o=G(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(O.value===!0?" q-tab--active"+(d.tabProps.value.activeClass?" "+d.tabProps.value.activeClass:"")+(d.tabProps.value.activeColor?` text-${d.tabProps.value.activeColor}`:"")+(d.tabProps.value.activeBgColor?` bg-${d.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(s.icon&&s.label&&d.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(s.noCaps===!0||d.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(s.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(u!==void 0?u.linkClass.value:"")),i=G(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(d.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(s.contentClass!==void 0?` ${s.contentClass}`:"")),p=G(()=>s.disable===!0||d.hasFocus.value===!0||O.value===!1&&d.hasActiveTab.value===!0?-1:s.tabindex||0);function w(c,n){if(n!==!0&&N.value!==null&&N.value.focus(),s.disable===!0){u!==void 0&&u.hasRouterLink.value===!0&&Je(c);return}if(u===void 0){d.updateModel({name:s.name}),l("click",c);return}if(u.hasRouterLink.value===!0){const v=(r={})=>{let f;const F=r.to===void 0||Vt(r.to,s.to)===!0?d.avoidRouteWatcher=At():null;return u.navigateToRouterLink(c,{...r,returnRouterError:!0}).catch(L=>{f=L}).then(L=>{if(F===d.avoidRouteWatcher&&(d.avoidRouteWatcher=!1,f===void 0&&(L===void 0||L.message.startsWith("Avoided redundant navigation")===!0)&&d.updateModel({name:s.name})),r.returnRouterError===!0)return f!==void 0?Promise.reject(f):L})};l("click",c,v),c.defaultPrevented!==!0&&v();return}l("click",c)}function U(c){xt(c,[13,32])?w(c,!0):Ct(c)!==!0&&c.keyCode>=35&&c.keyCode<=40&&c.altKey!==!0&&c.metaKey!==!0&&d.onKbdNavigate(c.keyCode,T.$el)===!0&&Je(c),l("keydown",c)}function W(){const c=d.tabProps.value.narrowIndicator,n=[],v=J("div",{ref:R,class:["q-tab__indicator",d.tabProps.value.indicatorClass]});s.icon!==void 0&&n.push(J(oe,{class:"q-tab__icon",name:s.icon})),s.label!==void 0&&n.push(J("div",{class:"q-tab__label"},s.label)),s.alert!==!1&&n.push(s.alertIcon!==void 0?J(oe,{class:"q-tab__alert-icon",color:s.alert!==!0?s.alert:void 0,name:s.alertIcon}):J("div",{class:"q-tab__alert"+(s.alert!==!0?` text-${s.alert}`:"")})),c===!0&&n.push(v);const r=[J("div",{class:"q-focus-helper",tabindex:-1,ref:N}),J("div",{class:i.value},kt(h.default,n))];return c===!1&&r.push(v),r}const te={name:G(()=>s.name),rootRef:E,tabIndicatorRef:R,routeData:u};st(()=>{d.unregisterTab(te)}),qt(()=>{d.registerTab(te)});function A(c,n){const v={ref:E,class:o.value,tabindex:p.value,role:"tab","aria-selected":O.value===!0?"true":"false","aria-disabled":s.disable===!0?"true":void 0,onClick:w,onKeydown:U,...n};return ae(J(c,v,W()),[[fe,D.value]])}return{renderTab:A,$tabs:d}}var qe=De({name:"QTab",props:ea,emits:Jt,setup(s,{slots:h,emit:l}){const{renderTab:u}=ta(s,h,l);return()=>u("div")}});function aa(s,h,l){const u=l===!0?["left","right"]:["top","bottom"];return`absolute-${h===!0?u[0]:u[1]}${s?` text-${s}`:""}`}const oa=["left","center","right","justify"];var it=De({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:s=>oa.includes(s)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(s,{slots:h,emit:l}){const{proxy:u}=Le(),{$q:d}=u,{registerTick:T}=Oe(),{registerTick:N}=Oe(),{registerTick:E}=Oe(),{registerTimeout:R,removeTimeout:D}=et(),{registerTimeout:O,removeTimeout:o}=et(),i=S(null),p=S(null),w=S(s.modelValue),U=S(!1),W=S(!0),te=S(!1),A=S(!1),c=[],n=S(0),v=S(!1);let r=null,f=null,F;const L=G(()=>({activeClass:s.activeClass,activeColor:s.activeColor,activeBgColor:s.activeBgColor,indicatorClass:aa(s.indicatorColor,s.switchIndicator,s.vertical),narrowIndicator:s.narrowIndicator,inlineLabel:s.inlineLabel,noCaps:s.noCaps})),$=G(()=>{const m=n.value,g=w.value;for(let q=0;q<m;q++)if(c[q].name.value===g)return!0;return!1}),C=G(()=>`q-tabs__content--align-${U.value===!0?"left":A.value===!0?"justify":s.align}`),_=G(()=>`q-tabs row no-wrap items-center q-tabs--${U.value===!0?"":"not-"}scrollable q-tabs--${s.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${s.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${s.mobileArrows===!0?"":"out"}-arrows`+(s.dense===!0?" q-tabs--dense":"")+(s.shrink===!0?" col-shrink":"")+(s.stretch===!0?" self-stretch":"")),H=G(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+C.value+(s.contentClass!==void 0?` ${s.contentClass}`:"")),K=G(()=>s.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),le=G(()=>s.vertical!==!0&&d.lang.rtl===!0),$e=G(()=>Kt===!1&&le.value===!0);Ie(le,pe),Ie(()=>s.modelValue,m=>{Ee({name:m,setCurrent:!0,skipEmit:!0})}),Ie(()=>s.outsideArrows,Ae);function Ee({name:m,setCurrent:g,skipEmit:q}){w.value!==m&&(q!==!0&&s["onUpdate:modelValue"]!==void 0&&l("update:modelValue",m),(g===!0||s["onUpdate:modelValue"]===void 0)&&(dt(w.value,m),w.value=m))}function Ae(){T(()=>{je({width:i.value.offsetWidth,height:i.value.offsetHeight})})}function je(m){if(K.value===void 0||p.value===null)return;const g=m[K.value.container],q=Math.min(p.value[K.value.scroll],Array.prototype.reduce.call(p.value.children,(j,M)=>j+(M[K.value.content]||0),0)),B=g>0&&q>g;U.value=B,B===!0&&N(pe),A.value=g<parseInt(s.breakpoint,10)}function dt(m,g){const q=m!=null&&m!==""?c.find(j=>j.name.value===m):null,B=g!=null&&g!==""?c.find(j=>j.name.value===g):null;if(q&&B){const j=q.tabIndicatorRef.value,M=B.tabIndicatorRef.value;r!==null&&(clearTimeout(r),r=null),j.style.transition="none",j.style.transform="none",M.style.transition="none",M.style.transform="none";const P=j.getBoundingClientRect(),Z=M.getBoundingClientRect();M.style.transform=s.vertical===!0?`translate3d(0,${P.top-Z.top}px,0) scale3d(1,${Z.height?P.height/Z.height:1},1)`:`translate3d(${P.left-Z.left}px,0,0) scale3d(${Z.width?P.width/Z.width:1},1,1)`,E(()=>{r=setTimeout(()=>{r=null,M.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",M.style.transform="none"},70)})}B&&U.value===!0&&ve(B.rootRef.value)}function ve(m){const{left:g,width:q,top:B,height:j}=p.value.getBoundingClientRect(),M=m.getBoundingClientRect();let P=s.vertical===!0?M.top-B:M.left-g;if(P<0){p.value[s.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(P),pe();return}P+=s.vertical===!0?M.height-j:M.width-q,P>0&&(p.value[s.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(P),pe())}function pe(){const m=p.value;if(m===null)return;const g=m.getBoundingClientRect(),q=s.vertical===!0?m.scrollTop:Math.abs(m.scrollLeft);le.value===!0?(W.value=Math.ceil(q+g.width)<m.scrollWidth-1,te.value=q>0):(W.value=q>0,te.value=s.vertical===!0?Math.ceil(q+g.height)<m.scrollHeight:Math.ceil(q+g.width)<m.scrollWidth)}function Ye(m){f!==null&&clearInterval(f),f=setInterval(()=>{vt(m)===!0&&de()},5)}function ze(){Ye($e.value===!0?Number.MAX_SAFE_INTEGER:0)}function Ge(){Ye($e.value===!0?0:Number.MAX_SAFE_INTEGER)}function de(){f!==null&&(clearInterval(f),f=null)}function ut(m,g){const q=Array.prototype.filter.call(p.value.children,Z=>Z===g||Z.matches&&Z.matches(".q-tab.q-focusable")===!0),B=q.length;if(B===0)return;if(m===36)return ve(q[0]),q[0].focus(),!0;if(m===35)return ve(q[B-1]),q[B-1].focus(),!0;const j=m===(s.vertical===!0?38:37),M=m===(s.vertical===!0?40:39),P=j===!0?-1:M===!0?1:void 0;if(P!==void 0){const Z=le.value===!0?-1:1,ce=q.indexOf(g)+P*Z;return ce>=0&&ce<B&&(ve(q[ce]),q[ce].focus({preventScroll:!0})),!0}}const mt=G(()=>$e.value===!0?{get:m=>Math.abs(m.scrollLeft),set:(m,g)=>{m.scrollLeft=-g}}:s.vertical===!0?{get:m=>m.scrollTop,set:(m,g)=>{m.scrollTop=g}}:{get:m=>m.scrollLeft,set:(m,g)=>{m.scrollLeft=g}});function vt(m){const g=p.value,{get:q,set:B}=mt.value;let j=!1,M=q(g);const P=m<M?-1:1;return M+=P*5,M<0?(j=!0,M=0):(P===-1&&M<=m||P===1&&M>=m)&&(j=!0,M=m),B(g,M),pe(),j}function He(m,g){for(const q in m)if(m[q]!==g[q])return!1;return!0}function pt(){let m=null,g={matchedLen:0,queryDiff:9999,hrefLen:0};const q=c.filter(P=>P.routeData!==void 0&&P.routeData.hasRouterLink.value===!0),{hash:B,query:j}=u.$route,M=Object.keys(j).length;for(const P of q){const Z=P.routeData.exact.value===!0;if(P.routeData[Z===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:ce,query:Fe,matched:ht,href:yt}=P.routeData.resolvedLink.value,Re=Object.keys(Fe).length;if(Z===!0){if(ce!==B||Re!==M||He(j,Fe)===!1)continue;m=P.name.value;break}if(ce!==""&&ce!==B||Re!==0&&He(Fe,j)===!1)continue;const ue={matchedLen:ht.length,queryDiff:M-Re,hrefLen:yt.length-ce.length};if(ue.matchedLen>g.matchedLen){m=P.name.value,g=ue;continue}else if(ue.matchedLen!==g.matchedLen)continue;if(ue.queryDiff<g.queryDiff)m=P.name.value,g=ue;else if(ue.queryDiff!==g.queryDiff)continue;ue.hrefLen>g.hrefLen&&(m=P.name.value,g=ue)}m===null&&c.some(P=>P.routeData===void 0&&P.name.value===w.value)===!0||Ee({name:m,setCurrent:!0})}function ft(m){if(D(),v.value!==!0&&i.value!==null&&m.target&&typeof m.target.closest=="function"){const g=m.target.closest(".q-tab");g&&i.value.contains(g)===!0&&(v.value=!0,U.value===!0&&ve(g))}}function _t(){R(()=>{v.value=!1},30)}function Pe(){We.avoidRouteWatcher===!1?O(pt):o()}function Ke(){if(F===void 0){const m=Ie(()=>u.$route.fullPath,Pe);F=()=>{m(),F=void 0}}}function gt(m){c.push(m),n.value++,Ae(),m.routeData===void 0||u.$route===void 0?O(()=>{if(U.value===!0){const g=w.value,q=g!=null&&g!==""?c.find(B=>B.name.value===g):null;q&&ve(q.rootRef.value)}}):(Ke(),m.routeData.hasRouterLink.value===!0&&Pe())}function bt(m){c.splice(c.indexOf(m),1),n.value--,Ae(),F!==void 0&&m.routeData!==void 0&&(c.every(g=>g.routeData===void 0)===!0&&F(),Pe())}const We={currentModel:w,tabProps:L,hasFocus:v,hasActiveTab:$,registerTab:gt,unregisterTab:bt,verifyRouteModel:Pe,updateModel:Ee,onKbdNavigate:ut,avoidRouteWatcher:!1};Pt(rt,We);function Ze(){r!==null&&clearTimeout(r),de(),F!==void 0&&F()}let Xe;return st(Ze),It(()=>{Xe=F!==void 0,Ze()}),St(()=>{Xe===!0&&Ke(),Ae()}),()=>J("div",{ref:i,class:_.value,role:"tablist",onFocusin:ft,onFocusout:_t},[J(Ht,{onResize:je}),J("div",{ref:p,class:H.value,onScroll:pe},nt(h.default)),J(oe,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(W.value===!0?"":" q-tabs__arrow--faded"),name:s.leftIcon||d.iconSet.tabs[s.vertical===!0?"up":"left"],onMousedownPassive:ze,onTouchstartPassive:ze,onMouseupPassive:de,onMouseleavePassive:de,onTouchendPassive:de}),J(oe,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(te.value===!0?"":" q-tabs__arrow--faded"),name:s.rightIcon||d.iconSet.tabs[s.vertical===!0?"down":"right"],onMousedownPassive:Ge,onTouchstartPassive:Ge,onMouseupPassive:de,onMouseleavePassive:de,onTouchendPassive:de})])}}),xe=De({name:"QTabPanel",props:Qt,setup(s,{slots:h}){return()=>J("div",{class:"q-tab-panel",role:"tabpanel"},nt(h.default))}}),ct=De({name:"QTabPanels",props:{...Bt,...Tt},emits:jt,setup(s,{slots:h}){const l=Le(),u=Dt(s,l.proxy.$q),{updatePanelsList:d,getPanelContent:T,panelDirectives:N}=Yt(),E=G(()=>"q-tab-panels q-panel-parent"+(u.value===!0?" q-tab-panels--dark q-dark":""));return()=>(d(h),Et("div",{class:E.value},T(),"pan",s.swipeable,()=>N.value))}});const la={class:"my-card"},sa={class:"q-pt-none"},ra={class:"row q-pt-sm"},na={class:"col-xs-12 col-md-7"},ia={class:"row"},ca=e("div",{class:"col-11 flex justify-start items-center"},[e("label",{class:"text-h6 text-weight-medium"}," >> Datos del Cliente:")],-1),da={class:"col-xs-12 col-md-6 col-sm-6"},ua={class:"col-xs-12 col-md-6 col-sm-6"},ma={class:"col-xs-12 col-md-6 col-sm-6"},va={class:"col-xs-12 col-md-6 col-sm-6"},pa={class:"col-xs-12 col-md-6 col-sm-6"},fa={class:"col-xs-12 col-md-6 col-sm-6"},_a={class:"col-xs-11 col-md-5"},ga={class:"row q-col-gutter-sm q-col-gutter-y-md"},ba=e("label",{class:"text-h6 text-weight-medium"}," >> Resumen Notificaciones:",-1),ha=[ba],ya={class:"col-xs-12 col-md-6"},$a={style:{display:"flex"}},wa={style:{width:"30%"},class:"q-mr-xs q-ml-md"},qa={style:{width:"70%","text-align":"left"}},xa=e("br",null,null,-1),Ca=e("div",null,"D\xEDa de pago",-1),ka={class:"col-xs-12 col-md-6"},Va={style:{display:"flex"}},Aa={style:{width:"30%"},class:"q-mr-xs q-ml-md"},Pa={style:{width:"70%","text-align":"left"}},Ia=e("br",null,null,-1),Sa=e("div",null,"Crear Factura",-1),Ta={class:"col-xs-12 col-md-6"},Da={style:{display:"flex"}},Ea={style:{width:"30%"},class:"q-mr-xs q-ml-md"},Fa={style:{width:"70%","text-align":"left"}},Ra=e("br",null,null,-1),Ma=e("div",null,"D\xEDa de corte",-1),Na={class:"row justify-center q-mt-md"},Oa={__name:"ResumenPage",setup(s){const{api:h,mostrarNotify:l,formCliente:u,validaciones:d,validarDatosPersonales:T}=ke(),{dia_pago:N,dia_corte:E,dia_crear_factura:R}=he(),D=S(!1),O=async()=>{if(!T())try{D.value=!0;const{planInternet:i,created_at:p,updated_at:w,...U}=u.value,{data:W}=await h.put(`/customers/actualizarDatosPersonales/${u.value.id}`,U);u.value={...W.cliente[0]},l("positive",W.msg),D.value=!1}catch(i){D.value=!1,l("warning",i.response.data.message)}};return(o,i)=>(y(),I(Ve,{onSubmit:O},{default:a(()=>[e("div",la,[e("div",sa,[e("div",ra,[e("div",na,[e("div",ia,[ca,e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Cliente: ",2)],2),e("div",da,[t(ee,{modelValue:b(u).nombres,"onUpdate:modelValue":[i[0]||(i[0]=p=>b(u).nombres=p),i[1]||(i[1]=p=>(b(u).nombres=b(u).nombres.toUpperCase(),b(d).nombres.isValid=!0))],modelModifiers:{trim:!0},error:!b(d).nombres.isValid,"input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(d).nombres.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Email: ",2)],2),e("div",ua,[t(ee,{modelValue:b(u).email,"onUpdate:modelValue":i[2]||(i[2]=p=>b(u).email=p),modelModifiers:{trim:!0},error:!b(d).email.isValid,"input-class":"resaltarTextoInput",onKeyup:i[3]||(i[3]=p=>b(d).email.isValid=!0),dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(d).email.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Celular: ",2)],2),e("div",ma,[t(ee,{type:o.$q.platform.is.mobile?"number":"text",modelValue:b(u).celular,"onUpdate:modelValue":i[4]||(i[4]=p=>b(u).celular=p),modelModifiers:{trim:!0},counter:"",maxlength:"10","input-class":"resaltarTextoInput",error:!b(d).celular.isValid,onKeyup:i[5]||(i[5]=p=>(b(d).celular.isValid=!0,b(u).celular=b(u).celular.replace(/\D/g,""))),dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(d).celular.message),3)]),_:1},8,["type","modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Direcci\xF3n: ",2)],2),e("div",va,[t(ee,{modelValue:b(u).direccion,"onUpdate:modelValue":i[6]||(i[6]=p=>b(u).direccion=p),error:!b(d).direccion.isValid,"input-class":"resaltarTextoInput",onKeyup:i[7]||(i[7]=p=>b(d).direccion.isValid=!0),dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(d).direccion.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Tipo de Documento: ",2)],2),e("div",pa,[t(Te,{dense:"",modelValue:b(u).tipo_documento,"onUpdate:modelValue":[i[8]||(i[8]=p=>b(u).tipo_documento=p),i[9]||(i[9]=p=>b(d).tipo_documento.isValid=!0)],modelModifiers:{trim:!0},outlined:"",error:!b(d).tipo_documento.isValid,"emit-value":"","map-options":"",options:[{label:"RUC",value:"04"},{label:"Cedula",value:"05"},{label:"Pasaporte",value:"06"}]},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(d).tipo_documento.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," N. Identificaci\xF3n: ",2)],2),e("div",fa,[t(ee,{type:o.$q.platform.is.mobile?"number":"text",modelValue:b(u).numero_documento,"onUpdate:modelValue":i[10]||(i[10]=p=>b(u).numero_documento=p),readonly:b(u).tipo_documento==="","input-class":"resaltarTextoInput",counter:"",maxlength:b(u).tipo_documento==="04"?13:10,error:!b(d).numero_documento.isValid,onKeyup:i[11]||(i[11]=p=>(b(d).numero_documento.isValid=!0,b(u).numero_documento=b(u).numero_documento.replace(/\D/g,""))),dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(d).numero_documento.message),3)]),_:1},8,["type","modelValue","readonly","maxlength","error"])])])]),e("div",_a,[e("div",ga,[e("div",{class:V(["col-11 flex justify-start items-center",[o.$q.screen.xs?"q-my-md":""]])},ha,2),e("div",ya,[e("div",null,[t(ie,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:o.$q.dark.isActive?"indigo-6":"indigo-8",filled:""},{default:a(()=>[e("div",$a,[e("div",wa,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",qa,[e("div",null,k(b(N)),1),xa,Ca])])]),_:1},8,["color"])])]),e("div",ka,[e("div",null,[t(ie,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:(o.$q.dark.isActive,"orange-9"),filled:""},{default:a(()=>[e("div",Va,[e("div",Aa,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",Pa,[e("div",null,k(b(z).formatDate(b(R),"DD/MM/YYYY"))+" 12:00 AM",1),Ia,Sa])])]),_:1},8,["color"])])]),e("div",Ta,[e("div",null,[t(ie,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:o.$q.dark.isActive?"red-7":"red-9",filled:""},{default:a(()=>[e("div",Da,[e("div",Ea,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",Fa,[e("div",null,k(b(E)),1),Ra,Ma])])]),_:1},8,["color"])])])])])])]),e("div",Na,[e("div",{class:V(["q-pb-md",[o.$q.screen.width>600||" q-ml-lg"]])},[t(Q,{type:"submit",icon:"save",loading:D.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Guardar Cambios ")]),_:1},8,["loading"])],2)])])]),_:1}))}};const Ua={class:"my-card"},La={class:"q-pt-none"},Qa={class:"row q-pt-sm"},Ba={class:"col-12"},ja={class:"row"},Ya=e("label",{class:"text-h6 text-weight-medium"}," >> Servicios de Internet:",-1),za={class:"text-h6 text-weight-medium"},Ga={class:"col-12 q-mt-md"},Ha={class:"text-h6 text-center"},Ka={__name:"ServiciosPage",setup(s){const h=[{name:"cont",label:"#",align:"center"},{name:"nombre_plan",align:"center",label:"Plan",field:"nombre_plan"},{name:"precio",label:"Costo",field:"precio",align:"center"},{name:"ipv4",label:"IP",field:"ipv4",align:"center"},{name:"router",label:"Router",field:"router",align:"center"},{name:"fecha_instalacion",label:"Instalado",field:"fecha_instalacion",align:"center"},{name:"direccion",label:"Direcci\xF3n",field:"direccion",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}],{api:l,client_name:u,route:d,servicios:T,mostrarNotify:N}=he();ke();const E=S([]),R=S(!1),D=S(null);E.value=T.value;const O=async()=>{R.value=!1,D.value=null,T.value=[];const{data:i}=await l.get("/customers/find/"+d.params.client_id);i[0].planInternet.forEach(p=>{T.value.push({detalles:{...p,cliente:u.value},servicio_id:p.id,precio:p.precio,direccion:`${p.direccion==""?"- - - - -":p.direccion}`,fecha_instalacion:p.fecha_instalacion,ipv4:p.ipv4,nombre_plan:p.perfil_internet.nombre_plan,router:p.router_id.nombre,estado:`${p.isActive?"Activo":"Inactivo"}`})}),E.value=T.value},o=async(i,p)=>{Qe.create({title:`<div class="text-center">
              <i class="fa-regular fa-circle-question"></i>
                ${p=="activar"?"Activar Servicio":"Suspender Servicio"}
            </div>`,message:`<div class="text-center">                  
                  \xBFEstas seguro que deseas ${p=="activar"?"activar":"suspender"} el servicio al cliente?
              </div>
              <div class="text-center">                  
                ${i.detalles.cliente}
              </div>`,html:!0,ok:{push:!0,label:`Si, ${p=="activar"?"Activar":"Suspender"}`,color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{const{data:w}=await l.put(`/customers/activeOrSuspendService/${i.detalles.id}`,{router:i.detalles.router_id,address_list:i.detalles.perfil_internet.address_list,ipv4:i.detalles.ipv4,estado:p});N("positive",`El cliente fue ${p=="activar"?" activado":"suspendido"}`),O()}catch(w){N("negative",w.response.data.message)}})};return(i,p)=>(y(),re(Se,null,[t(Ve,{onSubmit:p[0]||(p[0]=()=>{})},{default:a(()=>[e("div",Ua,[e("div",La,[e("div",Qa,[e("div",Ba,[e("div",ja,[e("div",{class:V(["col-12 flex items-center",i.$q.screen.xs?"justify-center":"justify-between"])},[Ya,e("label",za,[t(Q,{outline:"",color:"primary",label:"Agregar Servicio",class:V(["q-mr-xs",!i.$q.screen.xs||"q-mt-sm"])},null,8,["class"])])],2),e("div",Ga,[t(Be,{rows:E.value,columns:h,class:V([i.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50],"row-key":"name"},{"body-cell-cont":a(w=>[t(Y,{props:w},{default:a(()=>[x(k(w.rowIndex+1),1)]),_:2},1032,["props"])]),"body-cell-estado":a(w=>[t(Y,{props:w},{default:a(()=>[w.row.estado=="Activo"?(y(),I(ie,{key:0,outline:"",color:"positive",label:"Activo",class:"q-pa-sm"})):(y(),I(ie,{key:1,outline:"",color:"red",label:"Inactivo",class:"q-pa-sm"}))]),_:2},1032,["props"])]),"body-cell-acciones":a(w=>[t(Y,{props:w},{default:a(()=>[w.row.estado!=="Inactivo"?(y(),I(Q,{key:0,round:"",color:"blue-grey",onClick:U=>(D.value={...w.row.detalles,estado:w.row.estado},R.value=!0),icon:"edit",class:"q-mr-sm",size:"10px"},null,8,["onClick"])):X("",!0),w.row.estado!=="Inactivo"?(y(),I(Q,{key:1,round:"",color:"blue-grey",onClick:U=>o(w.row,"inactivar"),icon:"power_settings_new",class:"q-mr-sm",size:"10px"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Suspender ")]),_:1})]),_:2},1032,["onClick"])):(y(),I(Q,{key:2,round:"",color:"blue-grey",onClick:U=>o(w.row,"activar"),icon:"check_circle",class:"q-mr-sm",size:"10px"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Activar ")]),_:1})]),_:2},1032,["onClick"]))]),_:2},1032,["props"])]),_:1},8,["rows","class"])])])])])])])]),_:1}),t(Ue,{modelValue:R.value,"onUpdate:modelValue":p[1]||(p[1]=w=>R.value=w)},{default:a(()=>[t(be,{style:{width:"900px","max-width":"80vw"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",Ha,[x(" Editar Servicio "),ae(t(Q,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[we]])])]),_:1}),t(Ce,{class:"q-mb-md",inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(zt,{servicio:D.value,edit:!0,onActualizarDatos:O},null,8,["servicio"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Wa={__name:"ConfiguracionPage",setup(s){return(h,l)=>(y(),I(Gt,{edit:!0}))}},Za=()=>({imprimirAbono:(l,u,d,T)=>`
    <html>
    <head>
      <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
      <meta name="viewport" content="width=device-width, initial" />
      <style>
        th, td {
          text-align: center;
          white-space: nowrap; /* Omitir espacios en blanco */
        }
      </style>
    </head>
      <body>
        <table border="0" align="center" style="font-size: 8px; width: 230px;">
          <tbody>
            <tr>
              <td>
                <pre>    ${l.company_name}         -</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>       R.U.C.: ${l.ruc}         </pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Direccion: ${l.direccion}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Fecha: ${l.fecha_abono}          Hora: ${l.hora_abono}</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>Cliente: ${u.cliente}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>${u.tipo_documento=="05"?"Cedula:":"R.U.C:"}: ${u.num_doc}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Correo: ${u.email}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>----------------------------------------</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Cant.         Servicio             Total</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>----------------------------------------</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>1     Servicio de Internet        $${(parseFloat(l.monto_pendiente)+parseFloat(l.totalAbonado)).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                        IVA(12%): $00.00</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                       Descuento: $00.00</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                   Valor Abonado: $${parseFloat(l.valor).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                   Total Abonado: $${parseFloat(l.totalAbonado).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                 Valor pendiente: $${parseFloat(l.monto_pendiente).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>      Forma de Pago:</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>  ${l.forma_pago}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Atentido Por: ${d}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Gracias por su Compra</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>-</pre>
              </td>
            </tr>
        </table>
      </body>
    </html>
    `,imprimirFactura:(l,u,d,T)=>`
    <html>
    <head>
      <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
      <meta name="viewport" content="width=device-width, initial" />
      <style>
        th, td {
          text-align: center;
          white-space: nowrap; /* Omitir espacios en blanco */
        }
      </style>
    </head>
      <body>
        <table border="0" align="center" style="font-size: 8px; width: 230px;">
          <tbody>
            <tr>
              <td>
                <pre>    ${l.company_name}         -</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>       R.U.C.: ${l.ruc}         </pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Direccion: ${l.direccion}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Ambiente: PRUEBA         Emision: NORMAL</pre>
              </td>
            </tr>   
            <tr>
              <td>
                <pre>Fecha: ${l.pagos[l.pagos.length-1].fecha_abono}          Hora: ${l.pagos[l.pagos.length-1].hora_abono}</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>Num. Comprobante: ${l.num_comprobante}</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>Clave Acceso:</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>${l.clave_acceso}</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>Cliente: ${u.cliente}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>${u.tipo_documento=="05"?"Cedula:":"R.U.C:"}: ${u.num_doc}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Correo: ${u.email}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>----------------------------------------</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Cant.         Servicio             Total</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>----------------------------------------</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>1     Servicio de Internet        $${parseFloat(l.precio).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
              <pre>                        Subtotal: $${l.precio}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                        IVA(12%): $00.00</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                       Descuento: $00.00</pre>
              </td>
            </tr>
            <tr>
              <td>
              <pre>                           Total: $${l.precio}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>      Forma de Pago:</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>SIN UTILIZACION DEL SISTEMA FINANCIERO</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Atentido Por: ${d}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Gracias por su Compra</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>-</pre>
              </td>
            </tr>
        </table>
      </body>
    </html>
    `});const ye=s=>(Mt("data-v-1319842c"),s=s(),Nt(),s),Xa={class:"text-h6 text-center"},Ja={class:"row q-pt-lg q-gutter-lg justify-center"},eo={class:"col-12"},to=ye(()=>e("label",null,"Forma de pago:",-1)),ao={class:"col-12 q-mt-sm"},oo=ye(()=>e("label",null,"N\xBA transacci\xF3n:",-1)),lo={key:0,class:"col-12 q-mt-sm"},so=ye(()=>e("label",null,"Pagar Importe Total:",-1)),ro={class:"col-12 q-mt-sm"},no={key:1,class:"col-12 q-mt-sm"},io=ye(()=>e("label",null,"Monto Pendiente:",-1)),co={key:2,class:"col-12 q-mt-sm"},uo=ye(()=>e("label",null,"Sucursal a Facturar:",-1)),mo={class:"col-12 q-mt-none"},vo=ye(()=>e("label",null,"Notas:",-1)),po={class:"col-xs-9 col-sm-12 q-mt-lg q-mb-md flex justify-center"},fo={__name:"ModalPago",props:["servicio","nuevoPago"],emits:["actualizarDatos"],setup(s,{emit:h}){const l=s,u=["forma_pago","montoPendiente","montoCancelar"],{api:d,claim:T,mostrarNotify:N,route:E}=ke(),{showModalPago:R}=he(),D=S([]),O=S(!1),o=S({forma_pago:"",n_transaccion:"",importe_total:!0,sucursal_id:"",montoCancelar:"",montoPendiente:"",detalle:""}),i=S({forma_pago:{message:"",isValid:!0},montoPendiente:{message:"",isValid:!0},montoCancelar:{message:"",isValid:!0},sucursal_id:{message:"",isValid:!0}});if(l.nuevoPago)if(l.servicio.pagos.length==0)o.value.montoPendiente=l.servicio.precio,o.value.montoCancelar=l.servicio.precio;else{let A=0;l.servicio.pagos.forEach(n=>{A+=parseFloat(n.valor)});const c=parseFloat(l.servicio.precio)-A;o.value.montoPendiente=c.toString(),o.value.montoCancelar=c.toString()}else o.value={...l.servicio.pago,montoCancelar:parseFloat(l.servicio.pago.valor).toFixed(2)};const p=A=>{let c=0;c=o.value[A];const n=/^\d{0,9}(\.\d{1,2})?$/;setTimeout(function(){let v=0;if(v=o.value[A],!n.test(v.toString())){const r=parseFloat(c.toString().substring(0,c.toString().length-1));o.value[A]=r}},0)},w=()=>{let A=!1;return l.nuevoPago&&(u.forEach(c=>{(o.value[c].length==0||o.value[c]==0)&&(i.value[c].message="Debes completar este campo",i.value[c].isValid=!1,A=!0)}),(T.roles[0]=="Super-Administrador"||T.roles[0]=="Administrador")&&o.value.sucursal_id==""&&l.servicio.tipo_comprobante!="Recibo"&&parseFloat(o.value.montoCancelar)>=parseFloat(o.value.montoPendiente)&&(i.value.sucursal_id.message="Debes seleccionar una sucursal",i.value.sucursal_id.isValid=!1,A=!0)),A},U=["Efectivo Oficina/Sucursal","Dep\xF3sito Bancario","Transferencia Bancaria","Facilito","Punto Agil"],W=async()=>{if(w())return;const A=Date.now(),c=z.formatDate(A,"DD/MM/YYYY"),n=z.formatDate(A,"HH:mma"),v=parseFloat(o.value.montoPendiente)-parseFloat(o.value.montoCancelar);let r=0;l.nuevoPago&&l.servicio.pagos.forEach($=>{r+=parseFloat($.valor)});let f;if(l.nuevoPago)f=l.servicio.pagos,f.unshift({valor:o.value.montoCancelar,monto_pendiente:v.toString(),totalAbonado:(r+parseFloat(o.value.montoCancelar)).toString(),fecha_abono:c,hora_abono:n,detalle:o.value.detalle,n_transaccion:o.value.n_transaccion,forma_pago:o.value.forma_pago});else{const $=l.servicio.pagos.pagos.findIndex(C=>l.servicio.pago.hora_abono==C.hora_abono&&l.servicio.pago.valor==C.valor);l.servicio.pagos.pagos[$]={...o.value}}let F,L;l.nuevoPago?(F={pagos:f,estadoSRI:v<=0?"PAGADO":"PENDIENTE"},L=l.servicio.pago_id):(F={pagos:l.servicio.pagos.pagos},L=l.servicio.pagos.pago_id);try{let $={headers:{sucursal_id:o.value.sucursal_id}};O.value=!0;const{data:C}=await d.patch(`/pagos/${L}`,F,$);if(v<=0&&l.servicio.tipo_comprobante!="Recibo"&&l.nuevoPago){let _={customer_id:E.params.client_id,tipo:"EMISION",subtotal:parseFloat(l.servicio.precio),iva:parseFloat(l.servicio.iva),descuento:0,total:parseFloat(l.servicio.precio),entity:"Pagos",pago_id:l.servicio.pago_id,user_id:T.id,products:[{aplicaIva:l.servicio.iva>0,cantidad:1,pvp:l.servicio.precio,descuento:0,nombre:"SERVICIO DE INTERNET",codigoBarra:l.servicio.pago_id.split("-")[0]}]};await d.post("/CE/facturas/generarFacturaElectronica",_,$)}O.value=!1,N("positive",C.msg),R.value=!1,h("actualizarDatos")}catch($){console.log($)}},te=async A=>{D.value=[];const{data:c}=await d.get(`/sucursal/find/${A}/company`);c.forEach(n=>{D.value.push({label:n.nombre,value:n.id})}),D.value.length==1&&(o.value.sucursal_id=D.value[0].value)};return(T.roles[0]=="Super-Administrador"||T.roles[0]=="Administrador")&&te(T.company.id),(A,c)=>(y(),I(be,{style:{width:"450px !important","max-width":"fit-content"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",Xa,[x(k(l.nuevoPago?"Agregar Pago:":"Editar Pago")+" ",1),ae(t(Q,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[we]])])]),_:1}),t(Ce,{inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(Ve,{onSubmit:W},{default:a(()=>[e("div",Ja,[e("div",eo,[to,t(Te,{color:"orange","transition-show":"scale","transition-hide":"scale","onUpdate:modelValue":[c[0]||(c[0]=n=>i.value.forma_pago.isValid=!0),c[1]||(c[1]=n=>o.value.forma_pago=n)],error:!i.value.forma_pago.isValid,outlined:"",modelValue:o.value.forma_pago,dense:"",options:U},{error:a(()=>[e("label",{class:V(A.$q.dark.isActive?"text-red-4":"text-negative")},k(i.value.forma_pago.message),3)]),_:1},8,["error","modelValue"])]),e("div",ao,[oo,t(ee,{modelValue:o.value.n_transaccion,"onUpdate:modelValue":c[2]||(c[2]=n=>o.value.n_transaccion=n),dense:"",outlined:""},null,8,["modelValue"])]),l.nuevoPago?(y(),re("div",lo,[so,t(Rt,{color:"green","onUpdate:modelValue":[c[3]||(c[3]=n=>o.value.montoCancelar=o.value.montoPendiente),c[4]||(c[4]=n=>o.value.importe_total=n)],size:"lg",modelValue:o.value.importe_total},null,8,["modelValue"])])):X("",!0),e("div",ro,[e("label",null,k(l.nuevoPago?"Monto a Cancelar:":"Monto Cancelado"),1),t(ee,{modelValue:o.value.montoCancelar,"onUpdate:modelValue":[c[5]||(c[5]=n=>o.value.montoCancelar=n),c[6]||(c[6]=n=>(p("montoCancelar"),i.value.montoCancelar.isValid=!0))],modelModifiers:{trim:!0},readonly:o.value.importe_total||!l.nuevoPago,"input-style":"padding-right: 27px;",type:"number",step:"0.01",error:!i.value.montoCancelar.isValid,"input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:V(A.$q.dark.isActive?"text-red-4":"text-negative")},k(i.value.montoCancelar.message),3)]),prepend:a(()=>[t(oe,{name:"attach_money"})]),_:1},8,["modelValue","readonly","error"])]),l.nuevoPago?(y(),re("div",no,[io,t(ee,{modelValue:o.value.montoPendiente,"onUpdate:modelValue":[c[7]||(c[7]=n=>o.value.montoPendiente=n),c[8]||(c[8]=n=>(p("montoPendiente"),i.value.montoPendiente.isValid=!0))],modelModifiers:{trim:!0},disable:"",type:"number",step:"0.01",error:!i.value.montoPendiente.isValid,"input-style":"padding-right: 27px;","input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:V(A.$q.dark.isActive?"text-red-4":"text-negative")},k(i.value.montoCancelar.message),3)]),prepend:a(()=>[t(oe,{name:"attach_money"})]),_:1},8,["modelValue","error"])])):X("",!0),l.servicio.tipo_comprobante!="Recibo"&&l.nuevoPago&&parseFloat(o.value.montoCancelar)>=parseFloat(o.value.montoPendiente)?(y(),re("div",co,[uo,D.value.length>1?(y(),I(Te,{key:0,modelValue:o.value.sucursal_id,"onUpdate:modelValue":[c[9]||(c[9]=n=>o.value.sucursal_id=n),c[10]||(c[10]=n=>i.value.sucursal_id.isValid=!0)],error:!i.value.sucursal_id.isValid,outlined:"",options:D.value,"emit-value":"","map-options":"",dense:""},{error:a(()=>[e("label",{class:V(A.$q.dark.isActive?"text-red-4":"text-negative")},k(i.value.sucursal_id.message),3)]),"no-option":a(()=>[t(me,null,{default:a(()=>[t(se,{class:"text-grey"},{default:a(()=>[x(" No se encontro sucursal ")]),_:1})]),_:1})]),_:1},8,["modelValue","error","options"])):X("",!0)])):X("",!0),e("div",mo,[vo,t(ee,{modelValue:o.value.detalle,"onUpdate:modelValue":c[11]||(c[11]=n=>o.value.detalle=n),modelModifiers:{trim:!0},outlined:"",rows:"2",type:"textarea"},null,8,["modelValue"])]),e("div",po,[t(Q,{type:"submit",icon:"save",loading:O.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Guardar ")]),_:1},8,["loading"])])])]),_:1})]),_:1})]),_:1}))}};var _o=Ft(fo,[["__scopeId","data-v-1319842c"]]);const go={class:"text-h6 text-center"},bo={class:"row q-col-gutter-lg q-mt-md justify-center"},ho={class:"col-xs-12 col-md-9"},yo={class:"row q-col-gutter-lg"},$o={class:"col-xs-12 col-sm-6 q-pt-sm"},wo=e("label",{class:"q-mr-md row items-center"},"Vencimiento:",-1),qo={class:"row items-center justify-end"},xo={class:"col-xs-12 col-sm-6 q-pt-sm"},Co=e("label",{class:"q-mr-md row items-center"},"Fecha:",-1),ko={class:"row items-center justify-end"},Vo={class:"col-12"},Ao={class:"full-width row flex-center text-lime-10 q-gutter-sm"},Po=e("span",{class:"text-subtitle1"}," Agrega alg\xFAn Producto ",-1),Io={class:"q-my-none"},So={key:0,class:"col-xs-12 col-sm-5 q-mt-sm"},To=e("label",null,"Sucursal a Facturar:",-1),Do={class:"col-xs-12 col-sm-7",style:{display:"flex","justify-content":"end"}},Eo={class:"text-right"},Fo=e("td",null,[e("b",null,"TOTAL BRUTO:")],-1),Ro={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Mo={class:"text-right"},No=e("td",null,[e("b",null,"DESCUENTOS:")],-1),Oo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Uo={class:"text-right"},Lo=e("td",null,[e("b",null,"SUBTOTAL:")],-1),Qo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Bo={class:"text-right"},jo=e("td",null,[e("b",null,"IVA(12%):")],-1),Yo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},zo={class:"text-right"},Go=e("td",null,[e("b",null,"TOTAL:")],-1),Ho={style:{width:"50px"}},Ko={class:"col-xs-9 col-sm-12 q-pt-none q-mb-md flex justify-center"},Wo={__name:"ModalNuevaFactura",setup(s){const{api:h,claim:l,pagos:u,mostrarNotify:d,route:T,showModalNuevaFactura:N}=he(),E=S([{name:"acciones",label:"Quitar",align:"left"},{label:"Producto/Servicio",align:"left",field:"producto",name:"producto"},{name:"cantidad",label:"Cantidad",align:"left"},{name:"iva",label:"IVA(%)",align:"center"},{name:"descuento",label:"Descuento %",align:"left",field:"descuento"},{name:"v_total",label:"Total",align:"center",field:"v_total"}]),R=S([]),D=S([]),O=S(!1),o=S({fechaVencimiento:"",fecha:"",sucursal_id:""}),{vencimiento:i,servicio:{perfil_internet:{nombre_plan:p,descarga_Mbps:w,subida_Mbps:U,impuesto:W},factura_id:{tipo_comprobante:te},precio:A}}=u.value[0],c=i.split("/"),n=`${c[2]}-${c[1]}-${c[0]}`;o.value.fechaVencimiento=z.addToDate(n,{months:1,day:1});const v=z.addToDate(n,{months:2,day:1});o.value.fechaVencimiento=z.formatDate(o.value.fechaVencimiento,"YYYY/MM/DD"),o.value.fecha=z.formatDate(Date.now(),"YYYY/MM/DD");const r=`
Servicio de Internet Banda ancha
facturaci\xF3n del ${z.formatDate(o.value.fechaVencimiento,"DD/MM/YYYY")} al ${z.formatDate(v,"DD/MM/YYYY")}
Fecha de Suspensi\xF3n : ${z.formatDate(o.value.fechaVencimiento,"DD/MM/YYYY")}
Plan de Internet : ${p}
Descarga : ${w} Mbps
Subida : ${U} Mbps`;R.value.unshift({tipo:"servicio",producto:r,cantidad:1,iva:W,descuento:0,precio:A,v_total:parseFloat(A)-W*parseFloat(A)/100});const f=G(()=>{let $=0,C=0,_=0,H=0;return R.value.forEach(K=>{K.descuento>0&&(_+=parseFloat(K.v_total)*parseFloat(K.descuento)/100),K.iva&&(C+=(parseFloat(K.v_total)-parseFloat(K.v_total)*parseFloat(K.descuento)/100)*(parseInt(K.iva)/100)),$+=parseFloat(K.v_total)}),H=$+C-_,{subtotal:parseFloat((Math.floor($*100)/100).toString()),iva:parseFloat((Math.floor(C*100)/100).toString()),descuento:parseFloat((Math.floor(_*100)/100).toString()),total:parseFloat((Math.floor(H*100)/100).toString())}}),F=async $=>{D.value=[];const{data:C}=await h.get(`/sucursal/find/${$}/company`);C.forEach((_,H)=>{D.value.push({label:_.nombre,value:_.id}),H+1==C.length&&D.value.length>0&&(o.value.sucursal_id=D.value[0].value)})};l.roles[0]=="Super-Administrador"||l.roles[0]=="Administrador"?F(l.company.id):o.value.sucursal_id=l.sucursales[0];const L=async()=>{Qe.create({title:"\xBFDeseas agregar esta factura?",ok:{push:!0,color:"cyan-10",label:"Agregar"},cancel:{push:!0,color:"blue-grey-6",label:"Cancelar"}}).onOk(async()=>{try{let $={headers:{sucursal_id:o.value.sucursal_id}};O.value=!0;const C={estadoSRI:"PAGADO",pagos:[{detalle:"",fecha_abono:z.formatDate(o.value.fecha,"DD/MM/YYYY"),forma_pago:"Efectivo",hora_abono:z.formatDate(Date.now(),"HH:mma"),monto_pendiente:"0",n_transaccion:"",totalAbonado:`${f.value.total}`,valor:`${f.value.total}`}]},{data:_}=await h.post("/pagos/create",{servicio:u.value[0].servicio.id,...C,dia_pago:z.formatDate(o.value.fechaVencimiento,"YYYY-MM-DD")},$);if(te!="Recibo"){let H=[];R.value.forEach((le,$e)=>{H.push({aplicaIva:le.iva>0,cantidad:le.cantidad,pvp:le.v_total,descuento:le.descuento,nombre:le.tipo=="servicio"?"SERVICIO DE INTERNET":le.producto,codigoBarra:_.id.split("-")[0]+`${$e}`})});let K={customer_id:T.params.client_id,tipo:"EMISION",subtotal:f.value.subtotal,iva:f.value.iva,descuento:f.value.descuento,total:f.value.total,entity:"Pagos",pago_id:_.id,user_id:l.id,products:H};await h.post("/CE/facturas/generarFacturaElectronica",K,$)}O.value=!1,N.value=!1,d("positive","Factura Generado"),emit("actualizarDatos")}catch($){d("negative","Algo salio mal"),console.log($)}})};return($,C)=>(y(),I(be,{style:{width:"1000px","max-width":"80vw"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",go,[x(" Nueva Factura Servicio "),ae(t(Q,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[we]])])]),_:1}),t(Ce,{inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(Ve,{onSubmit:Ot(L,["prevent"])},{default:a(()=>[e("div",bo,[e("div",ho,[e("div",yo,[e("div",$o,[wo,t(ee,{dense:"",filled:"",modelValue:o.value.fechaVencimiento,"onUpdate:modelValue":C[1]||(C[1]=_=>o.value.fechaVencimiento=_),mask:"date",rules:["date"]},{append:a(()=>[t(oe,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(lt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(ot,{modelValue:o.value.fechaVencimiento,"onUpdate:modelValue":C[0]||(C[0]=_=>o.value.fechaVencimiento=_)},{default:a(()=>[e("div",qo,[ae(t(Q,{label:"Close",color:"primary",flat:""},null,512),[[we]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",xo,[Co,t(ee,{dense:"",filled:"",modelValue:o.value.fecha,"onUpdate:modelValue":C[3]||(C[3]=_=>o.value.fecha=_),mask:"date",rules:["date"],hint:"ejfiojwef","hide-hint":""},{append:a(()=>[t(oe,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(lt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(ot,{modelValue:o.value.fecha,"onUpdate:modelValue":C[2]||(C[2]=_=>o.value.fecha=_)},{default:a(()=>[e("div",ko,[ae(t(Q,{label:"Close",color:"primary",flat:""},null,512),[[we]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),e("div",Vo,[t(Be,{rows:R.value,columns:E.value,"row-key":"name",class:V([$.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50]},{"no-data":a(({})=>[e("div",Ao,[Po,t(oe,{size:"2em",name:"playlist_add"})])]),"body-cell-producto":a(_=>[t(Y,{props:_},{default:a(()=>[e("pre",Io,"                      "+k(_.row.producto)+`
                    `,1)]),_:2},1032,["props"])]),"body-cell-cantidad":a(_=>[t(Y,{props:_},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",readonly:_.row.tipo=="servicio",min:"0",max:_.row.stock,type:"number",style:{width:"100px"},modelValue:_.row.cantidad,"onUpdate:modelValue":H=>_.row.cantidad=H,modelModifiers:{trim:!0}},null,8,["readonly","max","modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-descuento":a(_=>[t(Y,{props:_},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",min:"0",max:"100",type:"number",style:{width:"100px"},modelValue:_.row.descuento,"onUpdate:modelValue":H=>_.row.descuento=H},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-iva":a(_=>[t(Y,{props:_},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",min:"0",max:"100",type:"number",style:{width:"100px"},modelValue:_.row.iva,"onUpdate:modelValue":H=>_.row.iva=H,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-v_total":a(_=>[t(Y,{props:_},{default:a(()=>[x(" $"+k(_.row.v_total),1)]),_:2},1032,["props"])]),"body-cell-acciones":a(_=>[t(Y,{props:_},{default:a(()=>[t(Q,{round:"",color:"deep-orange",disable:_.row.tipo=="servicio",onClick:H=>$.quitarArticulo(_.row.id),icon:"close",size:"8px"},null,8,["disable","onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","class"])]),b(l).roles[0]=="Super-Administrador"||b(l).roles[0]=="Administrador"?(y(),re("div",So,[To,D.value.length>1?(y(),I(Te,{key:0,modelValue:o.value.sucursal_id,"onUpdate:modelValue":C[4]||(C[4]=_=>o.value.sucursal_id=_),outlined:"",options:D.value,"emit-value":"","map-options":"",dense:""},{"no-option":a(()=>[t(me,null,{default:a(()=>[t(se,{class:"text-grey"},{default:a(()=>[x(" No se encontro sucursales ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"])):X("",!0)])):X("",!0),e("div",Do,[e("table",{class:V([$.$q.screen.xs?"":"linearTablaDetalle"])},[e("tr",Eo,[Fo,e("td",Ro," $"+k(f.value.subtotal),1)]),e("tr",Mo,[No,e("td",Oo," $"+k(f.value.descuento),1)]),e("tr",Uo,[Lo,e("td",Qo," $"+k(f.value.subtotal-f.value.descuento),1)]),e("tr",Bo,[jo,e("td",Yo," $"+k(f.value.iva),1)]),e("tr",zo,[Go,e("td",Ho,[t(ie,{outline:"",class:"text-subtitle1 text-weight-bold",color:"secondary",label:`$${f.value.total}`},null,8,["label"])])])],2)]),e("div",Ko,[t(Q,{type:"submit",icon:"save",loading:O.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Crear Factura ")]),_:1},8,["loading"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}))}};const Zo={class:"my-card"},Xo={class:"q-pt-none"},Jo={class:"row"},el={class:"col-12"},tl={class:"row"},al={class:"col-12 text-right"},ol={class:"col-12 q-mt-md"},ll=e("br",null,null,-1),sl=e("br",null,null,-1),rl=e("br",null,null,-1),nl=e("br",null,null,-1),il={class:"row q-col-gutter-sm"},cl=e("div",{class:"full-width row flex-center text-lime-10 q-gutter-sm"},[e("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun registros ")],-1),dl={__name:"IndexFacturas",setup(s){const h=S([{name:"x",align:"center",label:" ",field:"x"},{name:"n_comprobantes",align:"center",label:"N. Comprobante",field:"n_comprobantes"},{name:"emitido",label:"Emitido",field:"emitido",align:"center"},{name:"vencimiento",label:"Vencimiento",field:"vencimiento",align:"center"},{name:"precio",label:"Total",field:"precio",align:"center"},{name:"iva",label:"Impuesto",field:"iva",align:"center"},{name:"pagado",label:"Pagado",field:"pagado",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}]),l=S(!0),u=S({}),{api:d,servicios:T,pagos:N,showModalPago:E,showModalNuevaFactura:R,dia_vencimiento:D}=he(),{claim:O,route:o}=ke();let i;const p=()=>{const n=new Zt("http://205.235.6.108:3000/socket.io/socket.io.js",{extraHeaders:{autentication:O.id}});i==null||i.removeAllListeners(),i=n.socket("/"),i.on("updateStateInvoice",()=>{N.value=[],U()})},w=async()=>{const{data:n}=await d.get("/customers/find/"+o.params.client_id);return n},U=async()=>{try{N.value=[];const{data:n}=await d.get("/pagos/find/"+T.value[0].servicio_id);n.length>0&&n[0].servicio.factura_id.tipo_comprobante=="Recibo"&&(h.value[1].label="Tipo Comprobante"),n.forEach(v=>{var C;let r;v.servicio.factura_id.tipo_impuesto=="Impuestos incluido"?r=`${Math.floor(parseFloat(v.servicio.precio)*.12*100)/100}`:r=0;let f=0;v.pagos.forEach(_=>{f+=parseFloat(_.valor)});const F=(C=v.estadoSRI)==null?void 0:C.trim();let L=parseInt(v.servicio.factura_id.dia_gracia.split(" ")[0]);const $=z.addToDate(v.dia_pago,{days:L+1});N.value.push({ambiente:v.sucursal_id?v.sucursal_id.ambiente:"",clave_acceso:v.clave_acceso,company_name:v.servicio.router_id.company_id.nombre_comercial,num_comprobante:v.num_comprobante,sucursal_id:v.sucursal_id!==null?v.sucursal_id.id:null,pago_id:v.id,ruc:v.servicio.perfil_internet.router_id.company_id.ruc,direccion:v.sucursal_id!==null?v.sucursal_id.direccion:null,emitido:z.formatDate(v.created_at,"DD/MM/YYYY"),vencimiento:z.formatDate($,"DD/MM/YYYY"),precio:`${v.servicio.precio}`,tipo_comprobante:v.servicio.factura_id.tipo_comprobante,iva:r,pagos:v.pagos,pagado:f,servicio:v.servicio,estado:F,cancelado:f>=parseFloat(v.servicio.precio),expand:!1,loading:!1})})}catch(n){console.log(n)}},W=async(n,v)=>{N.value[v].loading=!0;let r={headers:{sucursal_id:n.sucursal_id}},f={ambiente:n.ambiente,clave_acceso:n.clave_acceso,company_name:n.company_name,sucursal_id:n.sucursal_id,customer_id:o.params.client_id,num_comprobante:n.num_comprobante,tipo:"EMISION",subtotal:parseFloat(n.precio),iva:parseFloat(n.iva),descuento:0,total:parseFloat(n.precio),entity:"Pagos",pago_id:n.pago_id,user_id:O.id,products:[{aplicaIva:n.iva>0,cantidad:1,pvp:n.precio,descuento:0,nombre:"SERVICIO DE INTERNET",codigoBarra:n.pago_id.split("-")[0]}]};n.estado.trim()=="ERROR ENVIO RECEPCION"&&await d.post("/CE/facturas/recepcionComprobantesOffline",f,r),n.estado.trim()=="RECIBIDA"&&await d.post("/CE/facturas/autorizacionComprobantesOffline",f,r),N.value[v].loading=!1},te=async(n,v,r=null)=>{r&&(n.company_name=r.company_name,n.ruc=r.ruc,n.direccion=r.direccion);const f=await w(),F={cliente:f[0].nombres,tipoDoc:f[0].tipo_documento,num_doc:f[0].numero_documento,email:f[0].email},{imprimirAbono:L,imprimirFactura:$}=Za();let C="";v=="Recibo"?C=L(n,F,O.fullName,v):C=$(n,F,O.fullName,v);var _=window.open("","_blank");_.document.write(C),_.print(),_.close()},A=(n,v,r,f)=>{Qe.create({title:"\xBFEstas seguro de eliminar este abono?",message:`<span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Fecha abonado:
                  </strong> 
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${n.fecha_abono} ${n.hora_abono}
                  </label>
                </span>
                <span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Forma de pago:
                  </strong> 
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${n.forma_pago} 
                  </label>
                </span>
                <span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Valor Abonado:
                  </strong> 
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    $${parseFloat(n.valor).toFixed(2)}
                  </label>                
                </span>`,html:!0,ok:{push:!0,label:"Eliminar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{const F=[...v];let L=0;F.reverse().map(($,C)=>{n.hora_abono==$.hora_abono&&n.valor==$.valor?$.delete=!0:($.totalAbonado=(parseFloat($.valor)+L).toString(),$.monto_pendiente=(parseFloat(r)-parseFloat($.totalAbonado)).toString(),L+=parseFloat($.totalAbonado))}),setTimeout(async()=>{const $=F.filter(C=>C.delete!==!0);await d.patch(`/pagos/${f}`,{pagos:$}),U()},1e3)}catch(F){mostrarNotify("negative",F.response.data.message)}})},c=async n=>{await d.post(`/CE/facturas/getRide/${n}`,{},{responseType:"blob"}).then(v=>{var r=new Blob([v.data],{type:"application/pdf"}),f=URL.createObjectURL(r);window.open(f)}).catch(v=>{v.response.status==422&&this.$setLaravelErrors(v.response.data.errors)})};return U(),p(),(n,v)=>(y(),re(Se,null,[t(Ve,{onSubmit:v[1]||(v[1]=()=>{})},{default:a(()=>[e("div",Zo,[e("div",Xo,[e("div",Jo,[e("div",el,[e("div",tl,[e("div",al,[t(Q,{onClick:v[0]||(v[0]=r=>R.value=!0),outline:"",color:"primary",label:"Factura de Servicio",class:V(["q-mr-xs",!n.$q.screen.xs||"q-mt-sm"])},null,8,["class"])]),e("div",ol,[t(Be,{rows:b(N),columns:h.value,class:V([n.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50],"row-key":"name"},{body:a(r=>[t(at,{props:r},{default:a(()=>[r.row.estado!="NO PAGADO"?(y(),I(Y,{key:0,"auto-width":""},{default:a(()=>[t(Q,{size:"sm",color:"accent",round:"",dense:"",onClick:f=>r.row.expand=!r.row.expand,icon:r.row.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024)):(y(),I(Y,{key:1,"auto-width":""})),t(Y,{key:"n_comprobantes",props:r},{default:a(()=>[x(k(r.row.tipo_comprobante=="Recibo"?"Recibo":r.row.num_comprobante==""||r.row.num_comprobante==null?"- - - - - -":r.row.num_comprobante),1)]),_:2},1032,["props"]),t(Y,{key:"emitido",props:r},{default:a(()=>[x(k(r.row.emitido),1)]),_:2},1032,["props"]),t(Y,{key:"vencimiento",props:r},{default:a(()=>[x(k(r.row.vencimiento),1)]),_:2},1032,["props"]),t(Y,{key:"precio",props:r},{default:a(()=>[x(" $"+k(r.row.precio),1)]),_:2},1032,["props"]),t(Y,{key:"iva",props:r},{default:a(()=>[x(" $"+k(r.row.iva),1)]),_:2},1032,["props"]),t(Y,{key:"pagado",props:r},{default:a(()=>[x(" $"+k(r.row.pagado),1)]),_:2},1032,["props"]),t(Y,{key:"estado",props:r},{default:a(()=>[r.row.estado=="AUTORIZADO"?(y(),I(ie,{key:0,outline:"",class:"q-py-xs q-px-md",color:"secondary"},{default:a(()=>[x(" PAGADO "),ll,x(" Y "),sl,x(" AUTORIZADO ")]),_:1})):r.row.estado=="NO PAGADO"||r.row.estado=="PENDIENTE"?(y(),I(ie,{key:1,outline:"",class:"q-py-xs q-px-md",color:n.$q.dark.isActive?"blue-grey-3":"blue-grey-7",label:r.row.estado},null,8,["color","label"])):r.row.estado=="PAGADO"?(y(),I(ie,{key:2,outline:"",class:"q-py-xs q-px-md",color:"secondary",label:r.row.estado},null,8,["label"])):(y(),I(ie,{key:3,outline:"",class:"q-py-xs q-px-md",color:n.$q.dark.isActive?"warning":"orange-10"},{default:a(()=>[x(" PAGADO "),rl,x(" - "),nl,x(" "+k(r.row.estado),1)]),_:2},1032,["color"]))]),_:2},1032,["props"]),t(Y,{key:"acciones",props:r},{default:a(()=>[r.row.cancelado?X("",!0):(y(),I(Q,{key:0,round:"",color:"blue-grey",onClick:f=>(E.value=!0,u.value=r.row),icon:"done",size:"10px",class:"q-mr-sm"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Agregar Pago ")]),_:1})]),_:2},1032,["onClick"])),r.row.estado=="ERROR ENVIO RECEPCION"||r.row.estado=="ERROR ENVIO RECEPCION - ANULACION"||r.row.estado=="RECIBIDA"?(y(),I(Q,{key:1,round:"",color:"blue-grey",icon:"fa-solid fa-retweet",loading:r.row.loading,onClick:f=>W(r.row,r.rowIndex),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Emitir Factura Electr\xF3nica ")]),_:1})]),_:2},1032,["loading","onClick"])):X("",!0),r.row.estado=="AUTORIZADO"?(y(),I(Q,{key:2,round:"",color:"blue-grey",icon:"print",onClick:f=>te(r.row,"factura"),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Imprimir comprobante ")]),_:1})]),_:2},1032,["onClick"])):X("",!0),r.row.estado=="AUTORIZADO"?(y(),I(Q,{key:3,round:"",color:"blue-grey",icon:"fa-solid fa-file-pdf",onClick:f=>c(r.row.clave_acceso),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Descargar PDF ")]),_:1})]),_:2},1032,["onClick"])):X("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"]),ae(t(at,{props:r},{default:a(()=>[t(Y,{colspan:"100%"},{default:a(()=>[e("div",il,[(y(!0),re(Se,null,Ut(r.row.pagos,(f,F)=>(y(),re("div",{key:F,class:"col-4"},[t(Wt,{bordered:"",padding:"",dense:""},{default:a(()=>[t(ne,{header:"",class:"text-center"},{default:a(()=>[x(" Fecha Abonado: "+k(f.fecha_abono)+" "+k(f.hora_abono),1)]),_:2},1024),ae((y(),I(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,null,{default:a(()=>[x("Forma de Pago:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ne,null,{default:a(()=>[x(k(f.forma_pago),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]]),ae((y(),I(me,{tag:"label",class:""},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,null,{default:a(()=>[x("Valor Abonado:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ne,null,{default:a(()=>[x("$"+k(f.valor),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]]),ae((y(),I(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,null,{default:a(()=>[x("N\xBA transacci\xF3n:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ne,null,{default:a(()=>[x(k(f.n_transaccion),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]]),ae((y(),I(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,null,{default:a(()=>[x("Detalle:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ne,null,{default:a(()=>[x(k(f.detalle==""?"Sin detalles":f.detalle),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]]),ae((y(),I(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,{class:"text-center"},{default:a(()=>[r.row.estado=="PENDIENTE"?(y(),I(Q,{key:0,square:"",onClick:L=>(E.value=!0,u.value={pagos:r.row,pago:f},l.value=!1),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md q-mr-md",outline:"",rounded:"",dense:"","icon-right":"edit"},null,8,["onClick","color"])):X("",!0),t(Q,{square:"",onClick:L=>te(f,"Recibo",r.row),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md",outline:"",rounded:"",dense:"","icon-right":"print"},null,8,["onClick","color"]),r.row.estado=="PENDIENTE"?(y(),I(Q,{key:1,square:"",onClick:L=>A(f,r.row.pagos,r.row.precio,r.row.pago_id),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md q-ml-md",outline:"",rounded:"",dense:"","icon-right":"delete"},null,8,["onClick","color"])):X("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]])]),_:2},1024)]))),128))])]),_:2},1024)]),_:2},1032,["props"]),[[Lt,r.row.expand]])]),"no-data":a(({icon:r})=>[cl]),_:1},8,["rows","columns","class"])])])])])])])]),_:1}),t(Ue,{modelValue:b(E),"onUpdate:modelValue":v[2]||(v[2]=r=>tt(E)?E.value=r:null)},{default:a(()=>[t(_o,{servicio:u.value,nuevoPago:l.value,onActualizarDatos:U},null,8,["servicio","nuevoPago"])]),_:1},8,["modelValue"]),t(Ue,{modelValue:b(R),"onUpdate:modelValue":v[3]||(v[3]=r=>tt(R)?R.value=r:null)},{default:a(()=>[t(Wo,{onActualizarDatos:U})]),_:1},8,["modelValue"])],64))}},ul={class:"q-gutter-y-md"},ml={__name:"FacturacionPagos",setup(s){const h=S("facturas");return(l,u)=>(y(),re("div",ul,[t(be,null,{default:a(()=>[t(it,{modelValue:h.value,"onUpdate:modelValue":u[0]||(u[0]=d=>h.value=d),draggable:"false",dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":""},{default:a(()=>[t(qe,{name:"facturas",label:"Facturas"}),t(qe,{name:"configuracion",label:"Configuraci\xF3n"})]),_:1},8,["modelValue"]),t(Ce),t(ct,{modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=d=>h.value=d),animated:""},{default:a(()=>[t(xe,{name:"facturas"},{default:a(()=>[t(dl)]),_:1}),t(xe,{name:"configuracion"},{default:a(()=>[t(Wa)]),_:1})]),_:1},8,["modelValue"])]),_:1})]))}};const vl={class:"q-gutter-y-md"},pl={__name:"IndexPage",setup(s){const h=S("resumen");return(l,u)=>(y(),re("div",vl,[t(be,null,{default:a(()=>[t(it,{modelValue:h.value,"onUpdate:modelValue":u[0]||(u[0]=d=>h.value=d),draggable:"false",dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:a(()=>[t(qe,{name:"resumen",label:"Resumen"}),t(qe,{name:"servicios",label:"Servicios"}),t(qe,{name:"facturacion/pagos",label:"Facturaci\xF3n/Pagos"})]),_:1},8,["modelValue"]),t(Ce),t(ct,{modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=d=>h.value=d),animated:""},{default:a(()=>[t(xe,{name:"resumen"},{default:a(()=>[t(Oa)]),_:1}),t(xe,{name:"servicios"},{default:a(()=>[h.value=="servicios"?(y(),I(Ka,{key:0})):X("",!0)]),_:1}),t(xe,{name:"facturacion/pagos"},{default:a(()=>[h.value=="facturacion/pagos"?(y(),I(ml,{key:0})):X("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]))}},fl={class:"q-ma-lg q-pt-md"},_l={class:"row q-col-gutter-md",style:{"justify-content":"center"}},gl={class:"text-h6 text-center",style:{position:"relative",top:"-8px",left:"17px"}},bl={class:"row q-col-gutter-md",style:{"justify-content":"center"}},hl={class:"col-xs-11 col-md-11 q-pt-xs"},Yl={__name:"EditCliente",setup(s){const{api:h,route:l,formCliente:u,formFacturacion:d}=ke(),{client_name:T,dia_vencimiento:N,mes_pago:E,servicios:R}=he(),D=async()=>{const{data:o}=await h.get("/pagos/find/"+R.value[0].servicio_id);o.length>0&&(E.value.dia_pago=o[0].dia_pago,o[0].estadoSRI!=="PAGADO"&&o[0].estadoSRI!=="AUTORIZADO"?E.value.estado="pendiente":E.value.estado="pagado"),E.value.meses_vencidos=o.reduce((i,p)=>i+(p.estadoSRI=="NO PAGADO"||p.estadoSRI=="PENDIENTE"),0),o.forEach((i,p)=>{let w=parseInt(i.servicio.factura_id.dia_gracia.split(" ")[0]);N.value=z.addToDate(i.dia_pago,{days:w+1}),p==0&&(E.value.dia_vencimiento=N.value)})};return(async()=>{R.value=[];const{data:o}=await h.get("/customers/find/"+l.params.client_id);T.value=o[0].nombres,u.value={...o[0]},o[0].planInternet.forEach(i=>{d.value={...i.factura_id},R.value.push({detalles:{...i,cliente:T.value},servicio_id:i.id,precio:i.precio,direccion:`${i.direccion==""?"- - - - -":i.direccion}`,fecha_instalacion:i.fecha_instalacion,ipv4:i.ipv4,nombre_plan:i.perfil_internet.nombre_plan,router:i.router_id.nombre,estado:`${i.isActive?"Activo":"Inactivo"}`})}),D()})(),(o,i)=>(y(),re(Se,null,[e("div",fl,[e("div",_l,[e("div",{class:V(["col-xs-12 q-pl-none",[o.$q.screen.width<1022?"q-pt-sm col-md-6":"col-md-6"]])},[t($t,{class:V(["row q-mr-xs",[o.$q.screen.width<1022?"justify-center q-pt-sm":"justify-start "]])},{default:a(()=>[t(Me,{label:"Inicio",icon:"home",to:"/"}),t(Me,{label:"Clientes",icon:"fa-solid fa-list",to:"/clientes"}),t(Me,{label:"Nuevo",icon:"add_circle"})]),_:1},8,["class"])],2),e("div",{class:V(["col-xs-12",[o.$q.screen.width<1022?"text-center q-pt-sm col-md-6 q-pl-none":"text-right col-md-5"]])},[e("label",gl,k(b(T)),1)],2)])]),e("div",bl,[e("div",hl,[t(be,{flat:"",class:"shadow_custom q-pt-none"},{default:a(()=>[t(pl,{edit:!0})]),_:1})])])],64))}};export{Yl as default};
