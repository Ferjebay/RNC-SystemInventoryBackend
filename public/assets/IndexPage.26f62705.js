import{Q as O,a as V,b as B,c as L}from"./QTable.df3e25c9.js";import{Q as H,a as J,b as E}from"./QPageSticky.1cdb0d3b.js";import{d as R,r as u,o as i,c as D,f as l,g as a,Q as q,h as c,e as m,i as k,O as x,C as Y,aM as j,af as C,ab as _,aP as F,aR as G,aj as N,ai as W,ac as v,ad as h}from"./index.becc66bd.js";import{C as $}from"./ClosePopup.796684c7.js";import{api as S}from"./axios.44f0b70d.js";import{u as Z,_ as K}from"./DetalleProducts.b49d58de.js";import{u as M}from"./useHelpers.62c49a13.js";import{d as X}from"./date.1c6cbe20.js";import{u as ee}from"./use-quasar.0f71ce4b.js";import{Q as P}from"./QDate.a9054f89.js";import{Q as T}from"./QPopupProxy.5d730869.js";import{u as U}from"./auth-user.dd663f53.js";import"./QList.66169e49.js";import"./QSelect.467cdfd1.js";import"./QChip.e97fbc5d.js";import"./QItemLabel.8aa7a3d0.js";import"./format.2bc25e5f.js";import"./QInnerLoading.497845f6.js";const ae={class:"col-md-9 col-sm-8 flex items-center"},le=m("label",null,"Filtrar Por:",-1),te={class:"row items-center justify-end"},oe=m("label",{class:"q-mx-md"},"HASTA:",-1),se={class:"row items-center justify-end"};R({__name:"FiltrarVentas",props:{formFiltrarVentas:{}},setup(A){const d=A;U(),u([]);const y=u(!1),{mostrarNotify:g}=M();console.log(d.formFiltrarVentas);const b=async()=>{if(d.formFiltrarVentas.desde!=""&&d.formFiltrarVentas.hasta==""||d.formFiltrarVentas.desde==""&&d.formFiltrarVentas.hasta!="")return g("warning","Completa los campos de fecha de busqueda");if(d.formFiltrarVentas.desde>d.formFiltrarVentas.hasta)return g("warning","Error en el rango de fecha de busqueda");y.value=!0;try{const{data:r}=await S.post("/ventas/consulta",d.formFiltrarVentas)}catch(r){console.log(r)}y.value=!1},w={days:"Domingo_Lunes_Martes_Mi\xE9rcoles_Jueves_Viernes_S\xE1bado".split("_"),daysShort:"Dom_Lun_Mar_Mi\xE9_Jue_Vie_S\xE1b".split("_"),months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:"Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_"),firstDayOfWeek:1,format24h:!0,pluralDay:"dias"};return(r,t)=>(i(),D("div",ae,[le,l(q,{class:"q-ml-md",style:{width:"20%"},filled:"",modelValue:r.formFiltrarVentas.desde,"onUpdate:modelValue":t[1]||(t[1]=n=>r.formFiltrarVentas.desde=n),dense:"",mask:"date",clearable:"","clear-icon":"close"},{append:a(()=>[l(k,{name:"event",class:"cursor-pointer"},{default:a(()=>[l(T,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[l(P,{modelValue:r.formFiltrarVentas.desde,"onUpdate:modelValue":t[0]||(t[0]=n=>r.formFiltrarVentas.desde=n),locale:w},{default:a(()=>[m("div",te,[x(l(c,{label:"Cerrar",color:"primary",flat:""},null,512),[[$]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),oe,l(q,{filled:"",style:{width:"20%"},modelValue:r.formFiltrarVentas.hasta,"onUpdate:modelValue":t[3]||(t[3]=n=>r.formFiltrarVentas.hasta=n),dense:"",mask:"date",clearable:"","clear-icon":"close"},{append:a(()=>[l(k,{name:"event",class:"cursor-pointer"},{default:a(()=>[l(T,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[l(P,{modelValue:r.formFiltrarVentas.hasta,"onUpdate:modelValue":t[2]||(t[2]=n=>r.formFiltrarVentas.hasta=n),locale:w},{default:a(()=>[m("div",se,[x(l(c,{label:"Cerrar",color:"primary",flat:""},null,512),[[$]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(c,{round:"",color:"black",icon:"search",loading:y.value,class:"q-ml-md",onClick:b},null,8,["loading"])]))}});const re={class:"q-ma-lg q-pt-md"},ne={class:"row q-col-gutter-lg"},ie={class:"col-12"},de={class:"full-width row flex-center text-lime-10 q-gutter-sm"},ue=m("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun resultado ",-1),De={__name:"IndexPage",setup(A){const d=[{name:"acciones",label:"acciones",align:"center"},{name:"sucursal",label:"Sucursal",align:"center"},{name:"num_comprobante",label:"Num. Comprobante",field:"numero_comprobante",align:"center"},{name:"usuario",label:"Usuario",align:"center"},{name:"cliente",label:"Cliente",align:"center"},{name:"f/h",label:"Fecha/Hora",align:"center",field:"created_at"},{name:"total",label:"Total",name:"total",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"}],y=u([]),g=u(!1);u({desde:"",hasta:"",pv_id:""});const b=u(""),w=u({});Z();const{mostrarNotify:r}=M(),t=ee();U();const n=u(!1),Q=async()=>{try{n.value=!0;const{data:s}=await S.get("/invoices");s.map(o=>o.created_at=X.formatDate(o.created_at,"DD/MM/YYYY HH:mm a")),y.value=s,n.value=!1}catch(s){console.log(s),n.value=!1}},z=s=>{t.dialog({title:"<center>\xBFEstas Seguro de anular esta compra?</center>",message:`<span><strong>Num Comprobante</strong>: ${s.num_comprobante}</span> <br>
                <span class='q-my-lg'><strong>Proveedor</strong>: ${s.proveedor}</span> <br>
                <span class='q-my-lg'><strong>Fecha/Hora</strong>: ${s.fecha}</span> <br>
                <span><strong>Total</strong>: $${s.total.toFixed(2)}</span> <br>`,html:!0,ok:{push:!0,label:"Anular",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{t.loading.show({message:"Cargando..."}),await S.put(`/compras/${s.id}`),r("positive","Factura Anulada exitosamente"),Q(),t.loading.hide()}catch(o){console.log(o)}})};Q(),Y(b,(s,o)=>{Q()});const p=u("list"),I=u({rowsPerPage:10});return(s,o)=>(i(),D(N,null,[m("div",re,[m("div",ne,[m("div",ie,[l(j,{flat:"",class:"shadow_custom"},{default:a(()=>[l(O,{"title-class":"text-grey-7 text-h6",title:"Listado de Ventas",rows:y.value,loading:n.value,"hide-header":p.value==="grid",columns:d,"row-key":"name",grid:p.value==="grid",filter:b.value,pagination:I.value},{header:a(e=>[l(J,{props:e,style:{height:"60px"}},{default:a(()=>[(i(!0),D(N,null,W(e.cols,f=>(i(),_(L,{key:f.name,props:e,class:"text-grey-7 text-weight-bold text-uppercase",style:{"font-size":"13px"}},{default:a(()=>[v(h(f.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"top-right":a(e=>[C(t).screen.xs?F("",!0):(i(),_(c,{key:0,onClick:o[0]||(o[0]=f=>s.$router.push("/ventas/add")),outline:"",color:"primary",label:"Agregar Venta",class:"q-mr-xs"})),l(q,{outlined:"",dense:"",debounce:"300",modelValue:b.value,"onUpdate:modelValue":o[1]||(o[1]=f=>b.value=f),placeholder:"Buscar..."},{append:a(()=>[l(k,{name:"search"})]),_:1},8,["modelValue"]),p.value==="list"?(i(),_(c,{key:1,flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen},{default:a(()=>[x((i(),_(E,{disable:C(t).platform.is.mobile},{default:a(()=>[v(h(e.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"),1)]),_:2},1032,["disable"])),[[$]])]),_:2},1032,["icon","onClick"])):F("",!0),e.inFullscreen?F("",!0):(i(),_(c,{key:2,flat:"",round:"",dense:"",icon:p.value==="grid"?"list":"grid_on",onClick:o[2]||(o[2]=f=>{p.value=p.value==="grid"?"list":"grid",s.separator=p.value==="grid"?"none":"horizontal"})},{default:a(()=>[x((i(),_(E,{disable:C(t).platform.is.mobile},{default:a(()=>[v(h(p.value==="grid"?"List":"Grid"),1)]),_:1},8,["disable"])),[[$]])]),_:1},8,["icon"]))]),"body-cell-total":a(e=>[l(V,{props:e},{default:a(()=>[v(" $"+h(e.row.total),1)]),_:2},1032,["props"])]),"body-cell-cliente":a(e=>[l(V,{props:e},{default:a(()=>[v(h(e.row.customer_id.nombres),1)]),_:2},1032,["props"])]),"body-cell-sucursal":a(e=>[l(V,{props:e},{default:a(()=>[v(h(e.row.sucursal_id.nombre),1)]),_:2},1032,["props"])]),"body-cell-usuario":a(e=>[l(V,{props:e},{default:a(()=>[v(h(e.row.user_id.fullName),1)]),_:2},1032,["props"])]),"body-cell-estado":a(e=>[l(V,{props:e},{default:a(()=>[l(B,{outline:"",class:"q-py-xs q-px-md",color:e.row.estadoSRI=="NO AUTORIZADO"||e.row.estadoSRI=="DEVUELTA"?"negative":"secondary",label:e.row.estadoSRI},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-acciones":a(e=>[l(V,{props:e},{default:a(()=>[l(c,{round:"",color:"blue-grey",icon:"visibility",size:"10px",class:"q-mr-sm",onClick:f=>(g.value=!0,w.value={...e.row})},null,8,["onClick"]),e.row.isActive?(i(),_(c,{key:0,round:"",color:"blue-grey",onClick:f=>z(e.row),icon:"close",size:"10px"},null,8,["onClick"])):F("",!0)]),_:2},1032,["props"])]),"no-data":a(({icon:e})=>[m("div",de,[l(k,{size:"2em",name:"sentiment_dissatisfied"}),ue,l(k,{size:"2em",name:b.value?"filter_b_and_w":e},null,8,["name"])])]),_:1},8,["rows","loading","hide-header","grid","filter","pagination"])]),_:1})])])]),C(t).screen.xs?(i(),_(H,{key:0,position:"bottom-right",offset:[18,18]},{default:a(()=>[l(c,{round:"",color:"secondary",size:"lg",icon:"add",onClick:o[3]||(o[3]=e=>s.$router.push("/ventas/add"))})]),_:1})):F("",!0),l(G,{modelValue:g.value,"onUpdate:modelValue":o[4]||(o[4]=e=>g.value=e)},{default:a(()=>[l(K,{detalleData:w.value},null,8,["detalleData"])]),_:1},8,["modelValue"])],64))}};export{De as default};
