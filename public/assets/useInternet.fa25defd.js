import{api as n}from"./axios.b7aae0cc.js";import{u as V}from"./useHelpers.36b2ef52.js";import{r as o}from"./index.e3943f75.js";const p=o(!1),_=o(""),l=o([]),e=o({id:"",nombre_plan:"",descripcion:"",precio_plan:0,impuesto:0,descarga_Mbps:0,subida_Mbps:0,limit_at:0,burst_limit:0,prioridad:"",address_list:"",router_id:""}),u=o({nombre_plan:{message:"",isValid:!0},descripcion:{message:"",isValid:!0},precio_plan:{message:"",isValid:!0},impuesto:{message:"",isValid:!0},descarga_Mbps:{message:"",isValid:!0},subida_Mbps:{message:"",isValid:!0},limit_at:{message:"",isValid:!0},burst_limit:{message:"",isValid:!0},prioridad:{message:"",isValid:!0},address_list:{message:"",isValid:!0},router_id:{message:"",isValid:!0}}),h=r=>{let i=0;i=e.value[r];const t=/^\d{0,9}(\.\d{1,2})?$/;setTimeout(function(){let d=0;if(d=e.value[r],!t.test(d.toString())){const m=parseFloat(i.toString().substring(0,i.toString().length-1));e.value[r]=m}},0)},x=r=>{const{mostrarNotify:i,claim:t,router:d,route:m}=V(),c=["nombre_plan","descripcion","precio_plan","descarga_Mbps","subida_Mbps","prioridad","address_list"],g=async()=>{l.value=[];const{data:s}=await n.get(`/router/find/${t.company.id}`);s.forEach(a=>{l.value.push({label:a.nombre,value:a.id})}),l.value.length>0&&(r||(e.value.router_id=l.value[0].value),_.value=l.value[0].value)},v=()=>{e.value={id:"",nombre_plan:"",descripcion:"",precio_plan:0,impuesto:0,descarga_Mbps:0,subida_Mbps:0,limit_at:0,burst_limit:0,prioridad:"",address_list:"",router_id:""}},b=()=>{c.push("router_id"),c.forEach(s=>{u.value[s].isValid=!0})},f=()=>{let s=!1;return c.forEach(a=>{(e.value[a].length==0||e.value[a]==0)&&(u.value[a].message="Debes completar este campo",u.value[a].isValid=!1,s=!0)}),!r&&e.value.router_id.length==0&&t.roles[0]=="Super-Administrador"&&(u.value.router_id.message="Debes elegir una empresa",u.value.router_id.isValid=!1,s=!0),s};return{api:n,claim:t,formInternet:e,loading:p,limpiarFormulario:v,listRouters:l,validaciones:u,cargarRouters:g,quitarErrores:b,route:m,selectedRouter:_,validDecimal:h,onSubmit:async s=>{if(!f())try{p.value=!0;let a={headers:{router_id:e.value.router_id,NotSetHeaderCompany:t.roles[0]=="Super-Administrador"}};s?await n.patch(`/internet/${e.value.id}`,e.value):await n.post("/internet",e.value,a),i("positive",`Router ${s?"editado":"agregado"} exitosamente`),p.value=!1,d.push({name:"internet.index"})}catch(a){p.value=!1,i("warning",a.response.data.message)}}}};export{x as u};
