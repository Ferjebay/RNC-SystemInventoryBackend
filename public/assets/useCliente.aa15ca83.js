import{u as A}from"./useHelpers.0233898e.js";import{a as f}from"./axios.d45fc5d6.js";import{d as j}from"./date.8fa43a55.js";import{r as t,B as T,v as G,bs as H}from"./index.af8b3988.js";const g=t(!1),h=t(1),y=t(!1),M=t(!1),S=t(!1);let z=t([]),J=t([]);const K=t([]),Q=t([]),U=t([]),W=t({dia_pago:"",estado:""});let X=t([]),Z=t([]);const s=t({nombres:"",tipo_documento:"",numero_documento:"",email:"",celular:"",direccion:""}),c=t({tipo:"",dia_pago:"",tipo_impuesto:"",tipo_comprobante:"",dia_gracia:"",aplicar_corte:"",recordatorio_pago:null}),r=t({router_id:"",direccion:"",coordenadas:"",perfil_internet:"",precio:0,fecha_instalacion:j.formatDate(Date.now(),"YYYY/MM/DD"),mac:"",red_id:"",ipv4:"",caja_id:"",puerto_id:""}),u=t({router_id:{message:"",isValid:!0},direccion:{message:"",isValid:!0},coordenadas:{message:"",isValid:!0},perfil_internet:{message:"",isValid:!0},precio:{message:"",isValid:!0},fecha_instalacion:{message:"",isValid:!0},mac:{message:"",isValid:!0},red_id:{message:"",isValid:!0},ipv4:{message:"",isValid:!0},caja_id:{message:"",isValid:!0},puerto_id:{message:"",isValid:!0}}),d=t({tipo:{message:"",isValid:!0},dia_pago:{message:"",isValid:!0},tipo_impuesto:{message:"",isValid:!0},tipo_comprobante:{message:"",isValid:!0},dia_gracia:{message:"",isValid:!0},aplicar_corte:{message:"",isValid:!0},recordatorio_pago:{message:"",isValid:!0}}),n=t({nombres:{message:"",isValid:!0},tipo_documento:{message:"",isValid:!0},numero_documento:{message:"",isValid:!0},email:{message:"",isValid:!0},celular:{message:"",isValid:!0},direccion:{message:"",isValid:!0},company_id:{message:"",isValid:!0}}),le=()=>{const{claim:x,router:F,mostrarNotify:_,confirmDelete:Y,isDeleted:R,route:C}=A(),V=["nombres","tipo_documento","numero_documento","email","celular","direccion"],b=["tipo","dia_pago","tipo_impuesto","dia_gracia","aplicar_corte","tipo_comprobante"],D=["perfil_internet","precio","red_id","ipv4"],N=()=>{s.value={nombres:"",tipo_documento:"",numero_documento:"",email:"",celular:"",direccion:""},c.value={tipo:"",dia_pago:"",tipo_impuesto:"",tipo_comprobante:"",dia_gracia:"",aplicar_corte:"",recordatorio_pago:null},r.value={router_id:"",direccion:"",coordenadas:"",perfil_internet:"",precio:0,fecha_instalacion:j.formatDate(Date.now(),"YYYY/MM/DD"),mac:"",red_id:"",ipv4:"",caja_id:"",puerto_id:""}},q=()=>{V.forEach(e=>{n.value[e].isValid=!0}),b.forEach(e=>{d.value[e].isValid=!0}),D.forEach(e=>{u.value[e].isValid=!0})},B=e=>{let a=0;a=r.value[e];const o=/^\d{0,9}(\.\d{1,2})?$/;setTimeout(function(){let i=0;if(i=r.value[e],!o.test(i.toString())){const m=parseFloat(a.toString().substring(0,a.toString().length-1));r.value[e]=m}},0),u.value.precio.isValid=!0},$=()=>{let e=!1;var a=/^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/;a.test(s.value.email)||(n.value.email.message="Ingresa un email valido",n.value.email.isValid=!1,e=!0),V.forEach(i=>{(s.value[i].length==0||s.value[i]==0)&&(n.value[i].message="Debes completar este campo",n.value[i].isValid=!1,e=!0)});let o;return s.value.tipo_documento==="04"&&(o=13),s.value.tipo_documento==="05"&&(o=10),s.value.tipo_documento==="06"&&(o=10),n.value.numero_documento.isValid&&s.value.numero_documento.length!=o&&(n.value.numero_documento.message=`Debes completar ${o} digitos`,n.value.numero_documento.isValid=!1,e=!0),e||(y.value=!0,h.value=2),e},k=()=>{let e=!1;return b.forEach(a=>{(c.value[a].length==0||c.value[a]==0)&&(d.value[a].message="Debes completar este campo",d.value[a].isValid=!1,e=!0)}),(c.value.recordatorio_pago==null||c.value.recordatorio_pago.length==0)&&(d.value.recordatorio_pago.message="Debes elegir al menos una opci\xF3n",d.value.recordatorio_pago.isValid=!1,e=!0),e||(M.value=!0,h.value=3),e},w=()=>{let e=!1;return r.value.router_id.length==0?(u.value.router_id.message="Debes elegir un router",u.value.router_id.isValid=!1,e=!0):(D.forEach(a=>{(r.value[a].length==0||r.value[a]==0)&&(u.value[a].message="Debes completar este campo",u.value[a].isValid=!1,e=!0)}),r.value.caja_id.length>0&&r.value.puerto_id.length==""&&(u.value.puerto_id.message="Elige una opci\xF3n",u.value.puerto_id.isValid=!1,e=!0)),e||(S.value=!0),e};return T(()=>{G(s.value,(e,a)=>{if(e.tipo_documento!==""&&e.tipo_documento!=="04"&&s.value.numero_documento.length>10){const o=e.numero_documento.length-10,i=e.numero_documento.substring(0,e.numero_documento.length-o);s.value.numero_documento=i}})}),{api:f,claim:x,mes_pago:W,formCliente:s,formFacturacion:c,loading:g,limpiarFormulario:N,groupedIpsByRed:e=>{const a={};return e.forEach(o=>{const i=o.substring(0,o.lastIndexOf("."));a.hasOwnProperty(i)||(a[i]=[]),a[i].push(o)}),a},obtenerListaSubred:e=>{const[a,o]=e.split("/"),i=a.split(".").map(Number),m=parseInt(o,10),L="1".repeat(m)+"0".repeat(32-m),I=[];for(let l=0;l<4;l++)I.push(parseInt(L.substr(l*8,8),2));const O=i.map((l,p)=>l&I[p]).join("."),E=[];for(let l=0;l<Math.pow(2,32-m);l++){const p=O.split(".").map((v,P)=>parseInt(v,10)+Math.floor(l/Math.pow(2,(3-P)*8))%256).join(".");p.split(".").every(v=>parseInt(v,10)<=255)&&E.push(p)}return E},listRedes:K,listRouter:z,listServicionsInternet:J,listCajasNap:X,listPuertosCajaNap:Z,validaciones:n,validacionesFacturacion:d,validarDatosPersonales:$,validarFormFact:k,validarFormInternet:w,validacionesInternet:u,validDecimal:B,mostrarNotify:_,quitarErrores:q,confirmDelete:Y,optionsListIps:U,listIps:Q,route:C,step:h,done1:y,done2:M,done3:S,formInternet:r,isDeleted:R,onSubmit:async e=>{w()||H.create({title:"\xBFDeseas agregar este cliente?",ok:{push:!0,color:"cyan-10",label:"Guardar"},cancel:{push:!0,color:"blue-grey-6",label:"Cancelar"}}).onOk(async()=>{try{g.value=!0,e?await f.patch("/customers/"+s.value.id,s.value):(r.value.red_id.includes("|")&&(r.value.red_id=r.value.red_id.split("|")[0]),await f.post("/customers",{cliente:s.value,facturacion:c.value,servicio:r.value})),_("positive",`Cliente ${e?"editado":"agregado"} exitosamente`),g.value=!1,F.push({name:"cliente.index"})}catch(a){_("warning",a.response.data.message),g.value=!1}})}}};export{le as u};
