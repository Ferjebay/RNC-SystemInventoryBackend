import{Q as $t,a as Pe}from"./QBreadcrumbs.1f56b687.js";import{m as St,b8 as At,J as Ht,L as Yt,br as Tt,r as H,n as h,b0 as Ot,D as se,p as d,aF as me,s as Ft,A as jt,bs as Pt,z as lt,h as $,d as It,u as Qt,x as Bt,o as I,c as fe,e as c,ai as A,f as v,g as y,Q as U,ah as _,aS as he,aj as N,bt as Ie,aT as ot,am as Et,bu as Ut,P as Qe,w as Nt,ae as ge,i as R,R as Rt,ad as Ve,b2 as zt,af as ke}from"./index.c45ffa3b.js";import{Q as nt,b as rt}from"./QItemLabel.76a85485.js";import{Q as st}from"./QSelect.07554658.js";import{u as Lt}from"./use-cache.b0833c75.js";import{u as Kt,a as Wt,b as Jt,g as z,Q as Gt}from"./QPopupProxy.89249985.js";import{t as ut,f as Xt,g as Zt,j as Be,_ as ea,d as it}from"./date.261422c5.js";import{p as _e}from"./format.2bc25e5f.js";import{Q as ta,a as ye}from"./QTable.804bbd40.js";import{Q as aa}from"./QBadge.95a1a88b.js";import{Q as la}from"./QForm.e38b3b76.js";import{C as oa}from"./ClosePopup.ab103b62.js";import{api as Ee}from"./axios.f92fb9a5.js";import{u as na}from"./useHelpers.eb8fd38c.js";import{u as ra,a as sa}from"./AddProveedor.d686fde8.js";import{u as ua,_ as ia}from"./SelectProduct.046138a1.js";import"./QChip.6b3c471d.js";import"./QList.85964241.js";import"./use-quasar.b32cdc4e.js";import"./QInnerLoading.bfbc07be.js";const J=20,da=["Calendar","Years","Months"],dt=l=>da.includes(l),Ue=l=>/^-?[\d]+\/[0-1]\d$/.test(l),re=" \u2014 ";function L(l){return l.year+"/"+_e(l.month)}var ca=St({name:"QDate",props:{...Kt,...At,...Ht,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Ue},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Ue},navigationMaxYearMonth:{type:String,validator:Ue},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:dt}},emits:[...Wt,"rangeStart","rangeEnd","navigation"],setup(l,{slots:Me,emit:w}){const{proxy:q}=jt(),{$q:j}=q,Q=Yt(l,j),{getCache:Y}=Lt(),{tabindex:C,headerClass:be,getLocale:G,getCurrentDate:pe}=Jt(l,j);let X;const B=Tt(l),K=Pt(B),ue=H(null),P=H(Je()),b=H(G()),Z=h(()=>Je()),O=h(()=>G()),S=h(()=>pe()),r=H(Ge(P.value,b.value)),V=H(l.defaultView),we=j.lang.rtl===!0?"right":"left",ee=H(we.value),te=H(we.value),ie=r.value.year,ae=H(ie-ie%J-(ie<0?J:0)),x=H(null),f=h(()=>{const e=l.landscape===!0?"landscape":"portrait";return`q-date q-date--${e} q-date--${e}-${l.minimal===!0?"minimal":"standard"}`+(Q.value===!0?" q-date--dark q-dark":"")+(l.bordered===!0?" q-date--bordered":"")+(l.square===!0?" q-date--square no-border-radius":"")+(l.flat===!0?" q-date--flat no-shadow":"")+(l.disable===!0?" disabled":l.readonly===!0?" q-date--readonly":"")}),u=h(()=>l.color||"primary"),s=h(()=>l.textColor||"white"),D=h(()=>l.emitImmediately===!0&&l.multiple!==!0&&l.range!==!0),$e=h(()=>Array.isArray(l.modelValue)===!0?l.modelValue:l.modelValue!==null&&l.modelValue!==void 0?[l.modelValue]:[]),F=h(()=>$e.value.filter(e=>typeof e=="string").map(e=>Ye(e,P.value,b.value)).filter(e=>e.dateHash!==null&&e.day!==null&&e.month!==null&&e.year!==null)),le=h(()=>{const e=t=>Ye(t,P.value,b.value);return $e.value.filter(t=>Ot(t)===!0&&t.from!==void 0&&t.to!==void 0).map(t=>({from:e(t.from),to:e(t.to)})).filter(t=>t.from.dateHash!==null&&t.to.dateHash!==null&&t.from.dateHash<t.to.dateHash)}),qe=h(()=>l.calendar!=="persian"?e=>new Date(e.year,e.month-1,e.day):e=>{const t=ut(e.year,e.month,e.day);return new Date(t.gy,t.gm-1,t.gd)}),Se=h(()=>l.calendar==="persian"?z:(e,t,a)=>Xt(new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond),t===void 0?P.value:t,a===void 0?b.value:a,e.year,e.timezoneOffset)),de=h(()=>F.value.length+le.value.reduce((e,t)=>e+1+Zt(qe.value(t.to),qe.value(t.from)),0)),Ne=h(()=>{if(l.title!==void 0&&l.title!==null&&l.title.length!==0)return l.title;if(x.value!==null){const a=x.value.init,n=qe.value(a);return b.value.daysShort[n.getDay()]+", "+b.value.monthsShort[a.month-1]+" "+a.day+re+"?"}if(de.value===0)return re;if(de.value>1)return`${de.value} ${b.value.pluralDay}`;const e=F.value[0],t=qe.value(e);return isNaN(t.valueOf())===!0?re:b.value.headerTitle!==void 0?b.value.headerTitle(t,e):b.value.daysShort[t.getDay()]+", "+b.value.monthsShort[e.month-1]+" "+e.day}),ct=h(()=>F.value.concat(le.value.map(t=>t.from)).sort((t,a)=>t.year-a.year||t.month-a.month)[0]),vt=h(()=>F.value.concat(le.value.map(t=>t.to)).sort((t,a)=>a.year-t.year||a.month-t.month)[0]),Re=h(()=>{if(l.subtitle!==void 0&&l.subtitle!==null&&l.subtitle.length!==0)return l.subtitle;if(de.value===0)return re;if(de.value>1){const e=ct.value,t=vt.value,a=b.value.monthsShort;return a[e.month-1]+(e.year!==t.year?" "+e.year+re+a[t.month-1]+" ":e.month!==t.month?re+a[t.month-1]:"")+" "+t.year}return F.value[0].year}),xe=h(()=>{const e=[j.iconSet.datetime.arrowLeft,j.iconSet.datetime.arrowRight];return j.lang.rtl===!0?e.reverse():e}),ze=h(()=>l.firstDayOfWeek!==void 0?Number(l.firstDayOfWeek):b.value.firstDayOfWeek),mt=h(()=>{const e=b.value.daysShort,t=ze.value;return t>0?e.slice(t,7).concat(e.slice(0,t)):e}),E=h(()=>{const e=r.value;return l.calendar!=="persian"?new Date(e.year,e.month,0).getDate():Be(e.year,e.month)}),ft=h(()=>typeof l.eventColor=="function"?l.eventColor:()=>l.eventColor),k=h(()=>{if(l.navigationMinYearMonth===void 0)return null;const e=l.navigationMinYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),M=h(()=>{if(l.navigationMaxYearMonth===void 0)return null;const e=l.navigationMaxYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),Ae=h(()=>{const e={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return k.value!==null&&k.value.year>=r.value.year&&(e.year.prev=!1,k.value.year===r.value.year&&k.value.month>=r.value.month&&(e.month.prev=!1)),M.value!==null&&M.value.year<=r.value.year&&(e.year.next=!1,M.value.year===r.value.year&&M.value.month<=r.value.month&&(e.month.next=!1)),e}),Ce=h(()=>{const e={};return F.value.forEach(t=>{const a=L(t);e[a]===void 0&&(e[a]=[]),e[a].push(t.day)}),e}),Le=h(()=>{const e={};return le.value.forEach(t=>{const a=L(t.from),n=L(t.to);if(e[a]===void 0&&(e[a]=[]),e[a].push({from:t.from.day,to:a===n?t.to.day:void 0,range:t}),a<n){let o;const{year:g,month:i}=t.from,m=i<12?{year:g,month:i+1}:{year:g+1,month:1};for(;(o=L(m))<=n;)e[o]===void 0&&(e[o]=[]),e[o].push({from:void 0,to:o===n?t.to.day:void 0,range:t}),m.month++,m.month>12&&(m.year++,m.month=1)}}),e}),ce=h(()=>{if(x.value===null)return;const{init:e,initHash:t,final:a,finalHash:n}=x.value,[o,g]=t<=n?[e,a]:[a,e],i=L(o),m=L(g);if(i!==T.value&&m!==T.value)return;const p={};return i===T.value?(p.from=o.day,p.includeFrom=!0):p.from=1,m===T.value?(p.to=g.day,p.includeTo=!0):p.to=E.value,p}),T=h(()=>L(r.value)),ht=h(()=>{const e={};if(l.options===void 0){for(let a=1;a<=E.value;a++)e[a]=!0;return e}const t=typeof l.options=="function"?l.options:a=>l.options.includes(a);for(let a=1;a<=E.value;a++){const n=T.value+"/"+_e(a);e[a]=t(n)}return e}),gt=h(()=>{const e={};if(l.events===void 0)for(let t=1;t<=E.value;t++)e[t]=!1;else{const t=typeof l.events=="function"?l.events:a=>l.events.includes(a);for(let a=1;a<=E.value;a++){const n=T.value+"/"+_e(a);e[a]=t(n)===!0&&ft.value(n)}}return e}),yt=h(()=>{let e,t;const{year:a,month:n}=r.value;if(l.calendar!=="persian")e=new Date(a,n-1,1),t=new Date(a,n-1,0).getDate();else{const o=ut(a,n,1);e=new Date(o.gy,o.gm-1,o.gd);let g=n-1,i=a;g===0&&(g=12,i--),t=Be(i,g)}return{days:e.getDay()-ze.value-1,endDay:t}}),Ke=h(()=>{const e=[],{days:t,endDay:a}=yt.value,n=t<0?t+7:t;if(n<6)for(let i=a-n;i<=a;i++)e.push({i,fill:!0});const o=e.length;for(let i=1;i<=E.value;i++){const m={i,event:gt.value[i],classes:[]};ht.value[i]===!0&&(m.in=!0,m.flat=!0),e.push(m)}if(Ce.value[T.value]!==void 0&&Ce.value[T.value].forEach(i=>{const m=o+i-1;Object.assign(e[m],{selected:!0,unelevated:!0,flat:!1,color:u.value,textColor:s.value})}),Le.value[T.value]!==void 0&&Le.value[T.value].forEach(i=>{if(i.from!==void 0){const m=o+i.from-1,p=o+(i.to||E.value)-1;for(let ve=m;ve<=p;ve++)Object.assign(e[ve],{range:i.range,unelevated:!0,color:u.value,textColor:s.value});Object.assign(e[m],{rangeFrom:!0,flat:!1}),i.to!==void 0&&Object.assign(e[p],{rangeTo:!0,flat:!1})}else if(i.to!==void 0){const m=o+i.to-1;for(let p=o;p<=m;p++)Object.assign(e[p],{range:i.range,unelevated:!0,color:u.value,textColor:s.value});Object.assign(e[m],{flat:!1,rangeTo:!0})}else{const m=o+E.value-1;for(let p=o;p<=m;p++)Object.assign(e[p],{range:i.range,unelevated:!0,color:u.value,textColor:s.value})}}),ce.value!==void 0){const i=o+ce.value.from-1,m=o+ce.value.to-1;for(let p=i;p<=m;p++)e[p].color=u.value,e[p].editRange=!0;ce.value.includeFrom===!0&&(e[i].editRangeFrom=!0),ce.value.includeTo===!0&&(e[m].editRangeTo=!0)}r.value.year===S.value.year&&r.value.month===S.value.month&&(e[o+S.value.day-1].today=!0);const g=e.length%7;if(g>0){const i=7-g;for(let m=1;m<=i;m++)e.push({i:m,fill:!0})}return e.forEach(i=>{let m="q-date__calendar-item ";i.fill===!0?m+="q-date__calendar-item--fill":(m+=`q-date__calendar-item--${i.in===!0?"in":"out"}`,i.range!==void 0&&(m+=` q-date__range${i.rangeTo===!0?"-to":i.rangeFrom===!0?"-from":""}`),i.editRange===!0&&(m+=` q-date__edit-range${i.editRangeFrom===!0?"-from":""}${i.editRangeTo===!0?"-to":""}`),(i.range!==void 0||i.editRange===!0)&&(m+=` text-${i.color}`)),i.classes=m}),e}),_t=h(()=>l.disable===!0?{"aria-disabled":"true"}:l.readonly===!0?{"aria-readonly":"true"}:{});se(()=>l.modelValue,e=>{if(X===e)X=0;else{const t=Ge(P.value,b.value);oe(t.year,t.month,t)}}),se(V,()=>{ue.value!==null&&q.$el.contains(document.activeElement)===!0&&ue.value.focus()}),se(()=>r.value.year+"|"+r.value.month,()=>{w("navigation",{year:r.value.year,month:r.value.month})}),se(Z,e=>{at(e,b.value,"mask"),P.value=e}),se(O,e=>{at(P.value,e,"locale"),b.value=e});function We(){const e=S.value,t=Ce.value[L(e)];(t===void 0||t.includes(e.day)===!1)&&Oe(e),He(e.year,e.month)}function bt(e){dt(e)===!0&&(V.value=e)}function pt(e,t){["month","year"].includes(e)&&(e==="month"?Ze:Te)(t===!0?-1:1)}function He(e,t){V.value="Calendar",oe(e,t)}function wt(e,t){if(l.range===!1||!e){x.value=null;return}const a=Object.assign({...r.value},e),n=t!==void 0?Object.assign({...r.value},t):a;x.value={init:a,initHash:z(a),final:n,finalHash:z(n)},He(a.year,a.month)}function Je(){return l.calendar==="persian"?"YYYY/MM/DD":l.mask}function Ye(e,t,a){return ea(e,t,a,l.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Ge(e,t){const a=Array.isArray(l.modelValue)===!0?l.modelValue:l.modelValue?[l.modelValue]:[];if(a.length===0)return Xe();const n=a[a.length-1],o=Ye(n.from!==void 0?n.from:n,e,t);return o.dateHash===null?Xe():o}function Xe(){let e,t;if(l.defaultYearMonth!==void 0){const a=l.defaultYearMonth.split("/");e=parseInt(a[0],10),t=parseInt(a[1],10)}else{const a=S.value!==void 0?S.value:pe();e=a.year,t=a.month}return{year:e,month:t,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:e+"/"+_e(t)+"/01"}}function Ze(e){let t=r.value.year,a=Number(r.value.month)+e;a===13?(a=1,t++):a===0&&(a=12,t--),oe(t,a),D.value===!0&&De("month")}function Te(e){const t=Number(r.value.year)+e;oe(t,r.value.month),D.value===!0&&De("year")}function qt(e){oe(e,r.value.month),V.value=l.defaultView==="Years"?"Months":"Calendar",D.value===!0&&De("year")}function xt(e){oe(r.value.year,e),V.value="Calendar",D.value===!0&&De("month")}function Ct(e,t){const a=Ce.value[t];(a!==void 0&&a.includes(e.day)===!0?Fe:Oe)(e)}function W(e){return{year:e.year,month:e.month,day:e.day}}function oe(e,t,a){if(k.value!==null&&e<=k.value.year&&(e=k.value.year,t<k.value.month&&(t=k.value.month)),M.value!==null&&e>=M.value.year&&(e=M.value.year,t>M.value.month&&(t=M.value.month)),a!==void 0){const{hour:o,minute:g,second:i,millisecond:m,timezoneOffset:p,timeHash:ve}=a;Object.assign(r.value,{hour:o,minute:g,second:i,millisecond:m,timezoneOffset:p,timeHash:ve})}const n=e+"/"+_e(t)+"/01";n!==r.value.dateHash&&(ee.value=r.value.dateHash<n==(j.lang.rtl!==!0)?"left":"right",e!==r.value.year&&(te.value=ee.value),lt(()=>{ae.value=e-e%J-(e<0?J:0),Object.assign(r.value,{year:e,month:t,day:1,dateHash:n})}))}function et(e,t,a){const n=e!==null&&e.length===1&&l.multiple===!1?e[0]:e;X=n;const{reason:o,details:g}=tt(t,a);w("update:modelValue",n,o,g)}function De(e){const t=F.value[0]!==void 0&&F.value[0].dateHash!==null?{...F.value[0]}:{...r.value};lt(()=>{t.year=r.value.year,t.month=r.value.month;const a=l.calendar!=="persian"?new Date(t.year,t.month,0).getDate():Be(t.year,t.month);t.day=Math.min(Math.max(1,t.day),a);const n=ne(t);X=n;const{details:o}=tt("",t);w("update:modelValue",n,e,o)})}function tt(e,t){return t.from!==void 0?{reason:`${e}-range`,details:{...W(t.target),from:W(t.from),to:W(t.to)}}:{reason:`${e}-day`,details:W(t)}}function ne(e,t,a){return e.from!==void 0?{from:Se.value(e.from,t,a),to:Se.value(e.to,t,a)}:Se.value(e,t,a)}function Oe(e){let t;if(l.multiple===!0)if(e.from!==void 0){const a=z(e.from),n=z(e.to),o=F.value.filter(i=>i.dateHash<a||i.dateHash>n),g=le.value.filter(({from:i,to:m})=>m.dateHash<a||i.dateHash>n);t=o.concat(g).concat(e).map(i=>ne(i))}else{const a=$e.value.slice();a.push(ne(e)),t=a}else t=ne(e);et(t,"add",e)}function Fe(e){if(l.noUnset===!0)return;let t=null;if(l.multiple===!0&&Array.isArray(l.modelValue)===!0){const a=ne(e);e.from!==void 0?t=l.modelValue.filter(n=>n.from!==void 0?n.from!==a.from&&n.to!==a.to:!0):t=l.modelValue.filter(n=>n!==a),t.length===0&&(t=null)}et(t,"remove",e)}function at(e,t,a){const n=F.value.concat(le.value).map(o=>ne(o,e,t)).filter(o=>o.from!==void 0?o.from.dateHash!==null&&o.to.dateHash!==null:o.dateHash!==null);w("update:modelValue",(l.multiple===!0?n:n[0])||null,a)}function Dt(){if(l.minimal!==!0)return d("div",{class:"q-date__header "+be.value},[d("div",{class:"relative-position"},[d(me,{name:"q-transition--fade"},()=>d("div",{key:"h-yr-"+Re.value,class:"q-date__header-subtitle q-date__header-link "+(V.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:C.value,...Y("vY",{onClick(){V.value="Years"},onKeyup(e){e.keyCode===13&&(V.value="Years")}})},[Re.value]))]),d("div",{class:"q-date__header-title relative-position flex no-wrap"},[d("div",{class:"relative-position col"},[d(me,{name:"q-transition--fade"},()=>d("div",{key:"h-sub"+Ne.value,class:"q-date__header-title-label q-date__header-link "+(V.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:C.value,...Y("vC",{onClick(){V.value="Calendar"},onKeyup(e){e.keyCode===13&&(V.value="Calendar")}})},[Ne.value]))]),l.todayBtn===!0?d($,{class:"q-date__header-today self-start",icon:j.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:C.value,onClick:We}):null])])}function je({label:e,type:t,key:a,dir:n,goTo:o,boundaries:g,cls:i}){return[d("div",{class:"row items-center q-date__arrow"},[d($,{round:!0,dense:!0,size:"sm",flat:!0,icon:xe.value[0],tabindex:C.value,disable:g.prev===!1,...Y("go-#"+t,{onClick(){o(-1)}})})]),d("div",{class:"relative-position overflow-hidden flex flex-center"+i},[d(me,{name:"q-transition--jump-"+n},()=>d("div",{key:a},[d($,{flat:!0,dense:!0,noCaps:!0,label:e,tabindex:C.value,...Y("view#"+t,{onClick:()=>{V.value=t}})})]))]),d("div",{class:"row items-center q-date__arrow"},[d($,{round:!0,dense:!0,size:"sm",flat:!0,icon:xe.value[1],tabindex:C.value,disable:g.next===!1,...Y("go+#"+t,{onClick(){o(1)}})})])]}const Vt={Calendar:()=>[d("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[d("div",{class:"q-date__navigation row items-center no-wrap"},je({label:b.value.months[r.value.month-1],type:"Months",key:r.value.month,dir:ee.value,goTo:Ze,boundaries:Ae.value.month,cls:" col"}).concat(je({label:r.value.year,type:"Years",key:r.value.year,dir:te.value,goTo:Te,boundaries:Ae.value.year,cls:""}))),d("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},mt.value.map(e=>d("div",{class:"q-date__calendar-item"},[d("div",e)]))),d("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[d(me,{name:"q-transition--slide-"+ee.value},()=>d("div",{key:T.value,class:"q-date__calendar-days fit"},Ke.value.map(e=>d("div",{class:e.classes},[e.in===!0?d($,{class:e.today===!0?"q-date__today":"",dense:!0,flat:e.flat,unelevated:e.unelevated,color:e.color,textColor:e.textColor,label:e.i,tabindex:C.value,...Y("day#"+e.i,{onClick:()=>{kt(e.i)},onMouseover:()=>{Mt(e.i)}})},e.event!==!1?()=>d("div",{class:"q-date__event bg-"+e.event}):null):d("div",""+e.i)]))))])])],Months(){const e=r.value.year===S.value.year,t=n=>k.value!==null&&r.value.year===k.value.year&&k.value.month>n||M.value!==null&&r.value.year===M.value.year&&M.value.month<n,a=b.value.monthsShort.map((n,o)=>{const g=r.value.month===o+1;return d("div",{class:"q-date__months-item flex flex-center"},[d($,{class:e===!0&&S.value.month===o+1?"q-date__today":null,flat:g!==!0,label:n,unelevated:g,color:g===!0?u.value:null,textColor:g===!0?s.value:null,tabindex:C.value,disable:t(o+1),...Y("month#"+o,{onClick:()=>{xt(o+1)}})})])});return l.yearsInMonthView===!0&&a.unshift(d("div",{class:"row no-wrap full-width"},[je({label:r.value.year,type:"Years",key:r.value.year,dir:te.value,goTo:Te,boundaries:Ae.value.year,cls:" col"})])),d("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},a)},Years(){const e=ae.value,t=e+J,a=[],n=o=>k.value!==null&&k.value.year>o||M.value!==null&&M.value.year<o;for(let o=e;o<=t;o++){const g=r.value.year===o;a.push(d("div",{class:"q-date__years-item flex flex-center"},[d($,{key:"yr"+o,class:S.value.year===o?"q-date__today":null,flat:!g,label:o,dense:!0,unelevated:g,color:g===!0?u.value:null,textColor:g===!0?s.value:null,tabindex:C.value,disable:n(o),...Y("yr#"+o,{onClick:()=>{qt(o)}})})]))}return d("div",{class:"q-date__view q-date__years flex flex-center"},[d("div",{class:"col-auto"},[d($,{round:!0,dense:!0,flat:!0,icon:xe.value[0],tabindex:C.value,disable:n(e),...Y("y-",{onClick:()=>{ae.value-=J}})})]),d("div",{class:"q-date__years-content col self-stretch row items-center"},a),d("div",{class:"col-auto"},[d($,{round:!0,dense:!0,flat:!0,icon:xe.value[1],tabindex:C.value,disable:n(t),...Y("y+",{onClick:()=>{ae.value+=J}})})])])}};function kt(e){const t={...r.value,day:e};if(l.range===!1){Ct(t,T.value);return}if(x.value===null){const a=Ke.value.find(o=>o.fill!==!0&&o.i===e);if(l.noUnset!==!0&&a.range!==void 0){Fe({target:t,from:a.range.from,to:a.range.to});return}if(a.selected===!0){Fe(t);return}const n=z(t);x.value={init:t,initHash:n,final:t,finalHash:n},w("rangeStart",W(t))}else{const a=x.value.initHash,n=z(t),o=a<=n?{from:x.value.init,to:t}:{from:t,to:x.value.init};x.value=null,Oe(a===n?t:{target:t,...o}),w("rangeEnd",{from:W(o.from),to:W(o.to)})}}function Mt(e){if(x.value!==null){const t={...r.value,day:e};Object.assign(x.value,{final:t,finalHash:z(t)})}}return Object.assign(q,{setToday:We,setView:bt,offsetCalendar:pt,setCalendarTo:He,setEditingRange:wt}),()=>{const e=[d("div",{class:"q-date__content col relative-position"},[d(me,{name:"q-transition--fade"},Vt[V.value])])],t=Ft(Me.default);return t!==void 0&&e.push(d("div",{class:"q-date__actions"},t)),l.name!==void 0&&l.disable!==!0&&K(e,"push"),d("div",{class:f.value,..._t.value},[Dt(),d("div",{ref:ue,class:"q-date__main col column",tabindex:-1},e)])}}});const va={class:"q-ma-lg q-pt-md q-mb-none",style:{"margin-bottom":"10px"}},ma={class:"row q-col-gutter-lg"},fa=c("label",{class:"text-h6 text-center"},"Nueva Compra",-1),ha=[fa],ga={class:"row q-pt-none q-mx-lg q-col-gutter-md"},ya={class:"col-xs-12 col-md-5 q-mt-lg q-pl-none"},_a=c("label",null,"Seleccionar Proveedor: ",-1),ba=c("label",null,"Numero de Comprobante: ",-1),pa=c("label",null,"Fecha de compra: ",-1),wa={class:"row items-center justify-end"},qa=c("label",null,"Seleccionar Sucursal: ",-1),xa={key:1,class:"col-xs-12 col-md-5 q-pl-none"},Ca=c("label",null,"Filtrar por codigo de barra o nombre del producto:",-1),Da=c("label",null,"Descripci\xF3n: ",-1),Va={key:2,class:"col-xs-12 col-md-5 q-pl-none"},ka=c("label",null,"Filtrar por codigo de barra o nombre del producto:",-1),Ma={class:"col-xs-12 col-md-5"},$a=c("label",null,"Filtrar por codigo de barra o nombre del producto: ",-1),Sa={class:"col-12"},Aa={class:"full-width row flex-center text-lime-10 q-gutter-sm"},Ha=c("span",{class:"text-subtitle1"}," Agrega alg\xFAn producto ",-1),Ya={class:"col-12",style:{display:"flex","justify-content":"end"}},Ta={class:"text-right"},Oa=c("td",null,[c("b",null,"SUBTOTAL:")],-1),Fa={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},ja={class:"text-right"},Pa=c("td",null,[c("b",null,"IVA(12%):")],-1),Ia={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Qa={class:"text-right"},Ba=c("td",null,[c("b",null,"TOTAL DESCUENTO:")],-1),Ea={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Ua={class:"text-right"},Na=c("td",null,[c("b",null,"TOTAL DE COMPRA:")],-1),Ra={style:{width:"50px"}},vl=It({__name:"AddCompra",setup(l){const{agregarAndValidarStock:Me,claim:w,filterByCodBarra:q,columns:j,rows:Q,filterArticulo:Y,modalSelectProducto:C,getSubtotalByProduct:be,loadingState:G,listProductos:pe,quitarArticulo:X,sucursal_selected:B,valorFactura:K}=ua();let{actualizarLista:ue}=ra(),P=[];const b=H([]),Z=H(!1),{mostrarNotify:O}=na(),S=H([]),r=H({proveedor_id:"",numero_comprobante:"",descripcion:"",inputDate:it.formatDate(Date.now(),"YYYY/MM/DD")}),V=Qt(),we=f=>{Me(f,"compras"),C.value=!1},ee=async f=>{S.value=[];const{data:u}=await Ee.get(`/sucursal/find/${f}/company`);u.forEach(s=>{S.value.push({label:s.nombre,value:s.id})})};se(ue,(f,u)=>{f&&te()});const te=async()=>{Z.value=!1;try{const{data:f}=await Ee.get("/providers/true");b.value=[],f.forEach(u=>{b.value.push({label:u.razon_social,value:u.id,num_doc:u.numero_documento})}),P=b.value}catch(f){console.log(f)}},ie=async()=>{let f=!1;if(r.value.proveedor_id=="")return O("warning","Debes elegir algun proveedor");if(r.value.numero_comprobante=="")return O("warning","Por favor ingresa el numero de comprobante");if(r.value.descripcion=="")return O("warning","Por favor ingresa una descripci\xF3n");if((w.roles[0]=="Super-Administrador"||w.roles[0]=="Administrador")&&B.value=="")return O("warning","Debes seleccionar una sucursal");if(Q.value.length==0)return O("warning","Debes agregar algun producto..");Q.value.forEach((u,s)=>{u.cantidad<=0&&(O("warning",`Agrega una cantidad cantidad al producto: ${u.nombre} de la fila: ${s+1}`),f=!0)}),!f&&(r.value.products=Q.value,r.value={...r.value,...K.value,fecha_compra:it.formatDate(r.value.inputDate,"DD/MM/YYYY"),user_id:w.id},Ut.create({title:"\xBFDeseas agregar esta compra?",ok:{push:!0,color:"cyan-10",label:"Agregar"},cancel:{push:!0,color:"blue-grey-6",label:"Cancelar"}}).onOk(async()=>{try{Qe.show({message:"Cargando..."});let u={headers:{sucursal_id:B.value}};await Ee.post("/buys",r.value,u),Qe.hide(),O("positive","Compra realizada exitosamente"),V.push("/compras")}catch(u){O("warning",u.response.data.message[0]),Qe.hide()}}))};(w.roles[0]=="Super-Administrador"||w.roles[0]=="Administrador")&&ee(w.company.id),te();const ae=(f="",u)=>{if(f==="")return u(()=>{b.value=P});u(()=>{const s=f.toLowerCase();b.value=b.value.filter(D=>D.num_doc.indexOf(s)>-1||D.label.toLowerCase().indexOf(s)>-1)})},x=()=>{if((w.roles[0]=="Super-Administrador"||w.roles[0]=="Administrador")&&B.value.length==0)return O("warning","Elige una sucursal primeramente");Y("compras")};return Bt(()=>{Q.value=[]}),(f,u)=>(I(),fe(Et,null,[c("div",va,[c("div",ma,[c("div",{class:A(["col-xs-12 col-md-6",[f.$q.screen.width<1022?"q-pt-sm":""]])},[v($t,{class:A(["row q-mr-xs",[f.$q.screen.width<1022?"justify-center q-pt-sm":"justify-start "]])},{default:y(()=>[v(Pe,{label:"Inicio",icon:"home",to:"/"}),v(Pe,{label:"Compras",icon:"shopping_cart",to:"/compras"}),v(Pe,{label:"Agregar Compra",icon:"add_circle"})]),_:1},8,["class"])],2),c("div",{class:A(["col-xs-12 col-md-6",[f.$q.screen.width<1022?"text-center q-pt-sm":"text-right"]])},ha,2)])]),c("div",ga,[c("div",ya,[_a,v(st,{color:"orange",filled:"",modelValue:r.value.proveedor_id,"onUpdate:modelValue":u[1]||(u[1]=s=>r.value.proveedor_id=s),dense:"",options:b.value,"emit-value":"","map-options":"",onFilter:ae,"use-input":"","input-debounce":"0"},{append:y(()=>[v($,{round:"",dense:"",flat:"",icon:"person_add",onClick:u[0]||(u[0]=Nt(s=>Z.value=!0,["stop","prevent"]))})]),"no-option":y(()=>[v(nt,null,{default:y(()=>[v(rt,{class:"text-grey"},{default:y(()=>[ge(" No hay resultados ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),c("div",{class:A(["col-xs-12 col-md-3",f.$q.screen.width<=1023?"q-pl-none":"q-mt-lg"])},[ba,v(U,{modelValue:r.value.numero_comprobante,"onUpdate:modelValue":u[2]||(u[2]=s=>r.value.numero_comprobante=s),"input-style":{textAlign:"center",fontSize:"16px"},filled:"",mask:"###-###-#########","fill-mask":"",dense:"",required:""},null,8,["modelValue"])],2),c("div",{class:A(["col-xs-12 col-md-4",f.$q.screen.width<=1023?"q-pl-none":"q-mt-lg"])},[pa,v(U,{filled:"",dense:"",modelValue:r.value.inputDate,"onUpdate:modelValue":u[4]||(u[4]=s=>r.value.inputDate=s),"input-style":{textAlign:"center"},mask:"date",rules:["date"]},{append:y(()=>[v(R,{name:"event",class:"cursor-pointer"},{default:y(()=>[v(Gt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:y(()=>[v(ca,{modelValue:r.value.inputDate,"onUpdate:modelValue":u[3]||(u[3]=s=>r.value.inputDate=s)},{default:y(()=>[c("div",wa,[Rt(v($,{label:"Close",color:"primary",flat:""},null,512),[[oa]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],2),_(w).roles[0]=="Super-Administrador"||_(w).roles[0]=="Administrador"?(I(),fe("div",{key:0,class:A(["col-xs-12 col-md-5 q-ml-none q-pl-none",f.$q.screen.width>=1023||"q-pt-none"])},[qa,v(st,{filled:"",modelValue:_(B),"onUpdate:modelValue":[u[5]||(u[5]=s=>he(B)?B.value=s:null),u[6]||(u[6]=s=>Q.value=[])],options:S.value,"emit-value":"","map-options":"",dense:""},{"no-option":y(()=>[v(nt,null,{default:y(()=>[v(rt,{class:"text-grey"},{default:y(()=>[ge(" No se encontro sucursal ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"])],2)):N("",!0),_(w).roles[0]!=="Super-Administrador"&&_(w).roles[0]!=="Administrador"&&f.$q.screen.width>=1023?(I(),fe("div",xa,[Ca,v(U,{outlined:"","bottom-slots":"",loading:_(G),dense:"",modelValue:_(q),"onUpdate:modelValue":u[8]||(u[8]=s=>he(q)?q.value=s:null),modelModifiers:{trim:!0},onKeyup:Ie(x,["enter"])},{append:y(()=>[_(q)!==""?(I(),Ve(R,{key:0,name:"close",onClick:u[7]||(u[7]=s=>q.value=""),class:"cursor-pointer"})):N("",!0),v(R,{name:"search"})]),_:1},8,["loading","modelValue","onKeyup"])])):N("",!0),c("div",{class:A(["col-xs-12 col-sm-12 col-md-7",f.$q.screen.width<=1023?"q-pl-none q-pt-sm":"q-pt-md"])},[Da,v(U,{modelValue:r.value.descripcion,"onUpdate:modelValue":u[9]||(u[9]=s=>r.value.descripcion=s),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])],2),_(w).roles[0]=="Super-Administrador"||_(w).roles[0]=="Administrador"?(I(),fe("div",Va,[ka,v(U,{outlined:"","bottom-slots":"",loading:_(G),dense:"",modelValue:_(q),"onUpdate:modelValue":u[11]||(u[11]=s=>he(q)?q.value=s:null),modelModifiers:{trim:!0},onKeyup:Ie(x,["enter"])},{append:y(()=>[_(q)!==""?(I(),Ve(R,{key:0,name:"close",onClick:u[10]||(u[10]=s=>q.value=""),class:"cursor-pointer"})):N("",!0),v(R,{name:"search"})]),_:1},8,["loading","modelValue","onKeyup"])])):N("",!0)]),_(w).roles[0]!=="Super-Administrador"&&_(w).roles[0]!=="Administrador"&&f.$q.screen.width<=1023?(I(),fe("div",{key:0,class:A(["row q-pt-lg q-mx-lg",[f.$q.screen.width<=1023?"justify-center":"justify-left q-ml-md"]])},[c("div",Ma,[$a,v(U,{outlined:"","bottom-slots":"",loading:_(G),dense:"",modelValue:_(q),"onUpdate:modelValue":u[13]||(u[13]=s=>he(q)?q.value=s:null),modelModifiers:{trim:!0},onKeyup:Ie(x,["enter"])},{append:y(()=>[_(q)!==""?(I(),Ve(R,{key:0,name:"close",onClick:u[12]||(u[12]=s=>q.value=""),class:"cursor-pointer"})):N("",!0),v(R,{name:"search"})]),_:1},8,["loading","modelValue","onKeyup"])])],2)):N("",!0),v(la,{onSubmit:ie},{default:y(()=>[c("div",{class:A(["row q-mx-lg justify-center",f.$q.screen.xs?"q-mt-lg":"q-mt-md"])},[c("div",Sa,[v(ta,{rows:_(Q),columns:_(j),"row-key":"name","hide-pagination":!0,"rows-per-page-options":[50],class:A([f.$q.dark.isActive?"":"my-sticky-header-table3"])},{"no-data":y(({})=>[c("div",Aa,[Ha,v(R,{size:"2em",name:"playlist_add"})])]),"body-cell-cantidad":y(s=>[v(ye,{props:s},{default:y(()=>[v(U,{"input-class":"resaltarTextoInput",dense:"",required:"",onChange:D=>_(be)(s.row),min:"0",type:"number",style:{width:"100px"},modelValue:s.row.cantidad,"onUpdate:modelValue":D=>s.row.cantidad=D,modelModifiers:{trim:!0}},null,8,["onChange","modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-iva":y(s=>[v(ye,{props:s},{default:y(()=>[v(zt,{modelValue:s.row.aplicaIva,"onUpdate:modelValue":D=>s.row.aplicaIva=D},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-descuento":y(s=>[v(ye,{props:s},{default:y(()=>[v(U,{"input-class":"resaltarTextoInput",dense:"",required:"",min:"0",onChange:D=>_(be)(s.row),type:"number",style:{width:"100px"},modelValue:s.row.descuento,"onUpdate:modelValue":D=>s.row.descuento=D,modelModifiers:{trim:!0}},null,8,["onChange","modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-pvm":y(s=>[v(ye,{props:s},{default:y(()=>[ge(" $"+ke(s.row.precio_compra),1)]),_:2},1032,["props"])]),"body-cell-acciones":y(s=>[v(ye,{props:s},{default:y(()=>[v($,{round:"",color:"deep-orange",onClick:D=>_(X)(s.row.id),icon:"close",size:"8px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","class"])]),c("div",Ya,[c("table",{class:A([f.$q.screen.xs?"q-pt-sm":"linearTablaDetalle"])},[c("tr",Ta,[Oa,c("td",Fa," $"+ke(_(K).subtotal),1)]),c("tr",ja,[Pa,c("td",Ia," $"+ke(_(K).iva),1)]),c("tr",Qa,[Ba,c("td",Ea," $"+ke(_(K).descuento),1)]),c("tr",Ua,[Na,c("td",Ra,[v(aa,{outline:"",class:"text-subtitle1 text-weight-bold",color:"secondary",label:`$${_(K).total}`},null,8,["label"])])])],2)]),c("div",{class:A(["col-12 flex q-mt-md q-pb-md",[f.$q.screen.width<600?"justify-center":"justify-between"]])},[f.$q.screen.width>600?(I(),Ve($,{key:0,icon:"arrow_back",onClick:u[14]||(u[14]=s=>f.$router.push("/compras")),outline:"",rounded:"",class:"q-mr-lg",color:f.$q.dark.isActive?"blue-grey-2":"blue-grey-10"},{default:y(()=>[ge(" \xA0 Regresar ")]),_:1},8,["color"])):N("",!0),v($,{type:"submit",icon:"save",outline:"",rounded:"",class:A(f.$q.screen.width<600?"q-px-xl":"q-px-lg"),style:{color:"#696cff"}},{default:y(()=>[ge(" \xA0 Guardar ")]),_:1},8,["class"])],2)],2)]),_:1}),v(ot,{modelValue:Z.value,"onUpdate:modelValue":u[15]||(u[15]=s=>Z.value=s)},{default:y(()=>[v(sa)]),_:1},8,["modelValue"]),v(ot,{modelValue:_(C),"onUpdate:modelValue":u[16]||(u[16]=s=>he(C)?C.value=s:null)},{default:y(()=>[v(ia,{listProductos:_(pe),onAgregarProduct:we},null,8,["listProductos"])]),_:1},8,["modelValue"])],64))}});export{vl as default};
