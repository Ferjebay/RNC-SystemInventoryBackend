import{Q as wt,a as Fe}from"./QBreadcrumbs.10e17445.js";import{k as $t,t as Ne,r as D,n as G,x as st,C as qt,bI as nt,O as ae,a8 as _e,p as X,ap as Xe,ao as xt,b9 as Ct,i as oe,N as kt,z as Qe,b5 as Vt,aJ as It,m as Se,ax as Oe,X as et,v as Ae,a2 as Pt,L as At,M as Dt,s as it,I as Tt,J as St,$ as Rt,o as h,a9 as A,g as a,e,ae as V,f as t,Q as ee,ad as b,ab as k,h as L,aa as x,c as ne,af as J,aU as be,aV as ge,ah as Ce,ba as Ue,aj as De,bB as Le,a7 as Et,bs as Mt,bJ as Ft,bK as Nt,w as Ot,ai as Ut,aK as Qt,bb as tt}from"./index.cfa4c6fc.js";import{u as ke}from"./useCliente.cf3cfd12.js";import{u as Lt,a as jt,b as Bt,c as Yt,e as he,d as zt,_ as Gt}from"./ServicioInternet.5b2151ca.js";import{Q as Kt}from"./QResizeObserver.a2cfa294.js";import{r as Wt,Q as Te}from"./QSelect.37bb8027.js";import{Q as re}from"./QBadge.204bbd27.js";import{Q as Ve}from"./QForm.aeee0fbe.js";import{d as z}from"./date.6fd6b604.js";import{Q as Y}from"./QTd.7d7cc3df.js";import{a as pe,Q as at}from"./QTooltip.b2ba8d35.js";import{Q as je}from"./QTable.185450c5.js";import{C as $e}from"./ClosePopup.4d8fbb44.js";import{a as me,Q as se,d as ie}from"./format.b474c67d.js";import{Q as Ht}from"./QList.95983c7d.js";import{u as Zt}from"./useImpresion.4d2c76f5.js";import{Q as ot}from"./QDate.5bf9fd9f.js";import{Q as lt}from"./QPopupProxy.cc84b20f.js";import{M as Jt}from"./index.2065a85c.js";import"./useHelpers.79731713.js";import"./use-quasar.87a49eb3.js";import"./axios.b700cc31.js";import"./touch.3df10340.js";import"./ModalMapBox.410ee7bd.js";import"./QBtnGroup.7ca136d3.js";let Xt=0;const ea=["click","keydown"],ta={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${Xt++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function aa(l,y,u,v){const c=$t(nt,Ne);if(c===Ne)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Ne;const{proxy:E}=Qe(),N=D(null),S=D(null),M=D(null),T=G(()=>l.disable===!0||l.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},l.ripple===!0?{}:l.ripple)),O=G(()=>c.currentModel.value===l.name),o=G(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(O.value===!0?" q-tab--active"+(c.tabProps.value.activeClass?" "+c.tabProps.value.activeClass:"")+(c.tabProps.value.activeColor?` text-${c.tabProps.value.activeColor}`:"")+(c.tabProps.value.activeBgColor?` bg-${c.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(l.icon&&l.label&&c.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(l.noCaps===!0||c.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(l.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(v!==void 0?v.linkClass.value:"")),i=G(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(c.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(l.contentClass!==void 0?` ${l.contentClass}`:"")),f=G(()=>l.disable===!0||c.hasFocus.value===!0||O.value===!1&&c.hasActiveTab.value===!0?-1:l.tabindex||0);function $(r,n){if(n!==!0&&N.value!==null&&N.value.focus(),l.disable===!0){v!==void 0&&v.hasRouterLink.value===!0&&Xe(r);return}if(v===void 0){c.updateModel({name:l.name}),u("click",r);return}if(v.hasRouterLink.value===!0){const m=(s={})=>{let _;const R=s.to===void 0||Vt(s.to,l.to)===!0?c.avoidRouteWatcher=It():null;return v.navigateToRouterLink(r,{...s,returnRouterError:!0}).catch(Q=>{_=Q}).then(Q=>{if(R===c.avoidRouteWatcher&&(c.avoidRouteWatcher=!1,_===void 0&&(Q===void 0||Q.message.startsWith("Avoided redundant navigation")===!0)&&c.updateModel({name:l.name})),s.returnRouterError===!0)return _!==void 0?Promise.reject(_):Q})};u("click",r,m),r.defaultPrevented!==!0&&m();return}u("click",r)}function U(r){xt(r,[13,32])?$(r,!0):Ct(r)!==!0&&r.keyCode>=35&&r.keyCode<=40&&r.altKey!==!0&&r.metaKey!==!0&&c.onKbdNavigate(r.keyCode,E.$el)===!0&&Xe(r),u("keydown",r)}function H(){const r=c.tabProps.value.narrowIndicator,n=[],m=X("div",{ref:M,class:["q-tab__indicator",c.tabProps.value.indicatorClass]});l.icon!==void 0&&n.push(X(oe,{class:"q-tab__icon",name:l.icon})),l.label!==void 0&&n.push(X("div",{class:"q-tab__label"},l.label)),l.alert!==!1&&n.push(l.alertIcon!==void 0?X(oe,{class:"q-tab__alert-icon",color:l.alert!==!0?l.alert:void 0,name:l.alertIcon}):X("div",{class:"q-tab__alert"+(l.alert!==!0?` text-${l.alert}`:"")})),r===!0&&n.push(m);const s=[X("div",{class:"q-focus-helper",tabindex:-1,ref:N}),X("div",{class:i.value},kt(y.default,n))];return r===!1&&s.push(m),s}const te={name:G(()=>l.name),rootRef:S,tabIndicatorRef:M,routeData:v};st(()=>{c.unregisterTab(te)}),qt(()=>{c.registerTab(te)});function I(r,n){const m={ref:S,class:o.value,tabindex:f.value,role:"tab","aria-selected":O.value===!0?"true":"false","aria-disabled":l.disable===!0?"true":void 0,onClick:$,onKeydown:U,...n};return ae(X(r,m,H()),[[_e,T.value]])}return{renderTab:I,$tabs:c}}var qe=Se({name:"QTab",props:ta,emits:ea,setup(l,{slots:y,emit:u}){const{renderTab:v}=aa(l,y,u);return()=>v("div")}});function oa(l,y,u){const v=u===!0?["left","right"]:["top","bottom"];return`absolute-${y===!0?v[0]:v[1]}${l?` text-${l}`:""}`}const la=["left","center","right","justify"];var rt=Se({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:l=>la.includes(l)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(l,{slots:y,emit:u}){const{proxy:v}=Qe(),{$q:c}=v,{registerTick:E}=Oe(),{registerTick:N}=Oe(),{registerTick:S}=Oe(),{registerTimeout:M,removeTimeout:T}=et(),{registerTimeout:O,removeTimeout:o}=et(),i=D(null),f=D(null),$=D(l.modelValue),U=D(!1),H=D(!0),te=D(!1),I=D(!1),r=[],n=D(0),m=D(!1);let s=null,_=null,R;const Q=G(()=>({activeClass:l.activeClass,activeColor:l.activeColor,activeBgColor:l.activeBgColor,indicatorClass:oa(l.indicatorColor,l.switchIndicator,l.vertical),narrowIndicator:l.narrowIndicator,inlineLabel:l.inlineLabel,noCaps:l.noCaps})),w=G(()=>{const d=n.value,g=$.value;for(let q=0;q<d;q++)if(r[q].name.value===g)return!0;return!1}),C=G(()=>`q-tabs__content--align-${U.value===!0?"left":I.value===!0?"justify":l.align}`),p=G(()=>`q-tabs row no-wrap items-center q-tabs--${U.value===!0?"":"not-"}scrollable q-tabs--${l.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${l.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${l.mobileArrows===!0?"":"out"}-arrows`+(l.dense===!0?" q-tabs--dense":"")+(l.shrink===!0?" col-shrink":"")+(l.stretch===!0?" self-stretch":"")),K=G(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+C.value+(l.contentClass!==void 0?` ${l.contentClass}`:"")),W=G(()=>l.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),le=G(()=>l.vertical!==!0&&c.lang.rtl===!0),we=G(()=>Wt===!1&&le.value===!0);Ae(le,fe),Ae(()=>l.modelValue,d=>{Re({name:d,setCurrent:!0,skipEmit:!0})}),Ae(()=>l.outsideArrows,Ie);function Re({name:d,setCurrent:g,skipEmit:q}){$.value!==d&&(q!==!0&&l["onUpdate:modelValue"]!==void 0&&u("update:modelValue",d),(g===!0||l["onUpdate:modelValue"]===void 0)&&(ut($.value,d),$.value=d))}function Ie(){E(()=>{Be({width:i.value.offsetWidth,height:i.value.offsetHeight})})}function Be(d){if(W.value===void 0||f.value===null)return;const g=d[W.value.container],q=Math.min(f.value[W.value.scroll],Array.prototype.reduce.call(f.value.children,(B,F)=>B+(F[W.value.content]||0),0)),j=g>0&&q>g;U.value=j,j===!0&&N(fe),I.value=g<parseInt(l.breakpoint,10)}function ut(d,g){const q=d!=null&&d!==""?r.find(B=>B.name.value===d):null,j=g!=null&&g!==""?r.find(B=>B.name.value===g):null;if(q&&j){const B=q.tabIndicatorRef.value,F=j.tabIndicatorRef.value;s!==null&&(clearTimeout(s),s=null),B.style.transition="none",B.style.transform="none",F.style.transition="none",F.style.transform="none";const P=B.getBoundingClientRect(),Z=F.getBoundingClientRect();F.style.transform=l.vertical===!0?`translate3d(0,${P.top-Z.top}px,0) scale3d(1,${Z.height?P.height/Z.height:1},1)`:`translate3d(${P.left-Z.left}px,0,0) scale3d(${Z.width?P.width/Z.width:1},1,1)`,S(()=>{s=setTimeout(()=>{s=null,F.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",F.style.transform="none"},70)})}j&&U.value===!0&&ve(j.rootRef.value)}function ve(d){const{left:g,width:q,top:j,height:B}=f.value.getBoundingClientRect(),F=d.getBoundingClientRect();let P=l.vertical===!0?F.top-j:F.left-g;if(P<0){f.value[l.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(P),fe();return}P+=l.vertical===!0?F.height-B:F.width-q,P>0&&(f.value[l.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(P),fe())}function fe(){const d=f.value;if(d===null)return;const g=d.getBoundingClientRect(),q=l.vertical===!0?d.scrollTop:Math.abs(d.scrollLeft);le.value===!0?(H.value=Math.ceil(q+g.width)<d.scrollWidth-1,te.value=q>0):(H.value=q>0,te.value=l.vertical===!0?Math.ceil(q+g.height)<d.scrollHeight:Math.ceil(q+g.width)<d.scrollWidth)}function Ye(d){_!==null&&clearInterval(_),_=setInterval(()=>{vt(d)===!0&&ue()},5)}function ze(){Ye(we.value===!0?Number.MAX_SAFE_INTEGER:0)}function Ge(){Ye(we.value===!0?0:Number.MAX_SAFE_INTEGER)}function ue(){_!==null&&(clearInterval(_),_=null)}function dt(d,g){const q=Array.prototype.filter.call(f.value.children,Z=>Z===g||Z.matches&&Z.matches(".q-tab.q-focusable")===!0),j=q.length;if(j===0)return;if(d===36)return ve(q[0]),q[0].focus(),!0;if(d===35)return ve(q[j-1]),q[j-1].focus(),!0;const B=d===(l.vertical===!0?38:37),F=d===(l.vertical===!0?40:39),P=B===!0?-1:F===!0?1:void 0;if(P!==void 0){const Z=le.value===!0?-1:1,ce=q.indexOf(g)+P*Z;return ce>=0&&ce<j&&(ve(q[ce]),q[ce].focus({preventScroll:!0})),!0}}const mt=G(()=>we.value===!0?{get:d=>Math.abs(d.scrollLeft),set:(d,g)=>{d.scrollLeft=-g}}:l.vertical===!0?{get:d=>d.scrollTop,set:(d,g)=>{d.scrollTop=g}}:{get:d=>d.scrollLeft,set:(d,g)=>{d.scrollLeft=g}});function vt(d){const g=f.value,{get:q,set:j}=mt.value;let B=!1,F=q(g);const P=d<F?-1:1;return F+=P*5,F<0?(B=!0,F=0):(P===-1&&F<=d||P===1&&F>=d)&&(B=!0,F=d),j(g,F),fe(),B}function Ke(d,g){for(const q in d)if(d[q]!==g[q])return!1;return!0}function ft(){let d=null,g={matchedLen:0,queryDiff:9999,hrefLen:0};const q=r.filter(P=>P.routeData!==void 0&&P.routeData.hasRouterLink.value===!0),{hash:j,query:B}=v.$route,F=Object.keys(B).length;for(const P of q){const Z=P.routeData.exact.value===!0;if(P.routeData[Z===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:ce,query:Ee,matched:ht,href:yt}=P.routeData.resolvedLink.value,Me=Object.keys(Ee).length;if(Z===!0){if(ce!==j||Me!==F||Ke(B,Ee)===!1)continue;d=P.name.value;break}if(ce!==""&&ce!==j||Me!==0&&Ke(Ee,B)===!1)continue;const de={matchedLen:ht.length,queryDiff:F-Me,hrefLen:yt.length-ce.length};if(de.matchedLen>g.matchedLen){d=P.name.value,g=de;continue}else if(de.matchedLen!==g.matchedLen)continue;if(de.queryDiff<g.queryDiff)d=P.name.value,g=de;else if(de.queryDiff!==g.queryDiff)continue;de.hrefLen>g.hrefLen&&(d=P.name.value,g=de)}d===null&&r.some(P=>P.routeData===void 0&&P.name.value===$.value)===!0||Re({name:d,setCurrent:!0})}function _t(d){if(T(),m.value!==!0&&i.value!==null&&d.target&&typeof d.target.closest=="function"){const g=d.target.closest(".q-tab");g&&i.value.contains(g)===!0&&(m.value=!0,U.value===!0&&ve(g))}}function pt(){M(()=>{m.value=!1},30)}function Pe(){He.avoidRouteWatcher===!1?O(ft):o()}function We(){if(R===void 0){const d=Ae(()=>v.$route.fullPath,Pe);R=()=>{d(),R=void 0}}}function gt(d){r.push(d),n.value++,Ie(),d.routeData===void 0||v.$route===void 0?O(()=>{if(U.value===!0){const g=$.value,q=g!=null&&g!==""?r.find(j=>j.name.value===g):null;q&&ve(q.rootRef.value)}}):(We(),d.routeData.hasRouterLink.value===!0&&Pe())}function bt(d){r.splice(r.indexOf(d),1),n.value--,Ie(),R!==void 0&&d.routeData!==void 0&&(r.every(g=>g.routeData===void 0)===!0&&R(),Pe())}const He={currentModel:$,tabProps:Q,hasFocus:m,hasActiveTab:w,registerTab:gt,unregisterTab:bt,verifyRouteModel:Pe,updateModel:Re,onKbdNavigate:dt,avoidRouteWatcher:!1};Pt(nt,He);function Ze(){s!==null&&clearTimeout(s),ue(),R!==void 0&&R()}let Je;return st(Ze),At(()=>{Je=R!==void 0,Ze()}),Dt(()=>{Je===!0&&We(),Ie()}),()=>X("div",{ref:i,class:p.value,role:"tablist",onFocusin:_t,onFocusout:pt},[X(Kt,{onResize:Be}),X("div",{ref:f,class:K.value,onScroll:fe},it(y.default)),X(oe,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(H.value===!0?"":" q-tabs__arrow--faded"),name:l.leftIcon||c.iconSet.tabs[l.vertical===!0?"up":"left"],onMousedownPassive:ze,onTouchstartPassive:ze,onMouseupPassive:ue,onMouseleavePassive:ue,onTouchendPassive:ue}),X(oe,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(te.value===!0?"":" q-tabs__arrow--faded"),name:l.rightIcon||c.iconSet.tabs[l.vertical===!0?"down":"right"],onMousedownPassive:Ge,onTouchstartPassive:Ge,onMouseupPassive:ue,onMouseleavePassive:ue,onTouchendPassive:ue})])}}),xe=Se({name:"QTabPanel",props:Lt,setup(l,{slots:y}){return()=>X("div",{class:"q-tab-panel",role:"tabpanel"},it(y.default))}}),ct=Se({name:"QTabPanels",props:{...jt,...Tt},emits:Bt,setup(l,{slots:y}){const u=Qe(),v=St(l,u.proxy.$q),{updatePanelsList:c,getPanelContent:E,panelDirectives:N}=Yt(),S=G(()=>"q-tab-panels q-panel-parent"+(v.value===!0?" q-tab-panels--dark q-dark":""));return()=>(c(y),Rt("div",{class:S.value},E(),"pan",l.swipeable,()=>N.value))}});const sa={class:"my-card"},na={class:"q-pt-none"},ia={class:"row q-pt-sm"},ra={class:"col-xs-12 col-md-7"},ca={class:"row"},ua=e("div",{class:"col-11 flex justify-start items-center"},[e("label",{class:"text-h6 text-weight-medium"}," >> Datos del Cliente:")],-1),da={class:"col-xs-12 col-md-6 col-sm-6"},ma={class:"col-xs-12 col-md-6 col-sm-6"},va={class:"col-xs-12 col-md-6 col-sm-6"},fa={class:"col-xs-12 col-md-6 col-sm-6"},_a={class:"col-xs-12 col-md-6 col-sm-6"},pa={class:"col-xs-12 col-md-6 col-sm-6"},ga={class:"col-xs-11 col-md-5"},ba={class:"row q-col-gutter-sm q-col-gutter-y-md"},ha=e("label",{class:"text-h6 text-weight-medium"}," >> Resumen Notificaciones:",-1),ya=[ha],wa={class:"col-xs-12 col-md-6"},$a={style:{display:"flex"}},qa={style:{width:"30%"},class:"q-mr-xs q-ml-md"},xa={style:{width:"70%","text-align":"left"}},Ca=e("br",null,null,-1),ka=e("div",null,"D\xEDa de pago",-1),Va={class:"col-xs-12 col-md-6"},Ia={style:{display:"flex"}},Pa={style:{width:"30%"},class:"q-mr-xs q-ml-md"},Aa={style:{width:"70%","text-align":"left"}},Da=e("br",null,null,-1),Ta=e("div",null,"Crear Factura",-1),Sa={class:"col-xs-12 col-md-6"},Ra={style:{display:"flex"}},Ea={style:{width:"30%"},class:"q-mr-xs q-ml-md"},Ma={style:{width:"70%","text-align":"left"}},Fa=e("br",null,null,-1),Na=e("div",null,"D\xEDa de corte",-1),Oa={class:"row justify-center q-mt-md"},Ua={__name:"ResumenPage",setup(l){const{api:y,mostrarNotify:u,formCliente:v,validaciones:c,validarDatosPersonales:E}=ke(),{dia_pago:N,dia_corte:S,dia_crear_factura:M}=he(),T=D(!1),O=async()=>{if(!E())try{T.value=!0;const{planInternet:i,created_at:f,updated_at:$,...U}=v.value,{data:H}=await y.put(`/customers/actualizarDatosPersonales/${v.value.id}`,U);v.value={...H.cliente[0]},u("positive",H.msg),T.value=!1}catch(i){T.value=!1,u("warning",i.response.data.message)}};return(o,i)=>(h(),A(Ve,{onSubmit:O},{default:a(()=>[e("div",sa,[e("div",na,[e("div",ia,[e("div",ra,[e("div",ca,[ua,e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Cliente: ",2)],2),e("div",da,[t(ee,{modelValue:b(v).nombres,"onUpdate:modelValue":[i[0]||(i[0]=f=>b(v).nombres=f),i[1]||(i[1]=f=>(b(v).nombres=b(v).nombres.toUpperCase(),b(c).nombres.isValid=!0))],modelModifiers:{trim:!0},error:!b(c).nombres.isValid,"input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(c).nombres.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Email: ",2)],2),e("div",ma,[t(ee,{modelValue:b(v).email,"onUpdate:modelValue":i[2]||(i[2]=f=>b(v).email=f),modelModifiers:{trim:!0},error:!b(c).email.isValid,"input-class":"resaltarTextoInput",onKeyup:i[3]||(i[3]=f=>b(c).email.isValid=!0),dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(c).email.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Celular: ",2)],2),e("div",va,[t(ee,{type:o.$q.platform.is.mobile?"number":"text",modelValue:b(v).celular,"onUpdate:modelValue":i[4]||(i[4]=f=>b(v).celular=f),modelModifiers:{trim:!0},counter:"",maxlength:"10","input-class":"resaltarTextoInput",error:!b(c).celular.isValid,onKeyup:i[5]||(i[5]=f=>(b(c).celular.isValid=!0,b(v).celular=b(v).celular.replace(/\D/g,""))),dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(c).celular.message),3)]),_:1},8,["type","modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Direcci\xF3n: ",2)],2),e("div",fa,[t(ee,{modelValue:b(v).direccion,"onUpdate:modelValue":i[6]||(i[6]=f=>b(v).direccion=f),error:!b(c).direccion.isValid,"input-class":"resaltarTextoInput",onKeyup:i[7]||(i[7]=f=>b(c).direccion.isValid=!0),dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(c).direccion.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," Tipo de Documento: ",2)],2),e("div",_a,[t(Te,{dense:"",modelValue:b(v).tipo_documento,"onUpdate:modelValue":[i[8]||(i[8]=f=>b(v).tipo_documento=f),i[9]||(i[9]=f=>b(c).tipo_documento.isValid=!0)],modelModifiers:{trim:!0},outlined:"",error:!b(c).tipo_documento.isValid,"emit-value":"","map-options":"",options:[{label:"RUC",value:"04"},{label:"Cedula",value:"05"},{label:"Pasaporte",value:"06"}]},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(c).tipo_documento.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:V(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:V(o.$q.screen.width<1022||"q-pr-md")}," N. Identificaci\xF3n: ",2)],2),e("div",pa,[t(ee,{type:o.$q.platform.is.mobile?"number":"text",modelValue:b(v).numero_documento,"onUpdate:modelValue":i[10]||(i[10]=f=>b(v).numero_documento=f),readonly:b(v).tipo_documento==="","input-class":"resaltarTextoInput",counter:"",maxlength:b(v).tipo_documento==="04"?13:10,error:!b(c).numero_documento.isValid,onKeyup:i[11]||(i[11]=f=>(b(c).numero_documento.isValid=!0,b(v).numero_documento=b(v).numero_documento.replace(/\D/g,""))),dense:"",outlined:""},{error:a(()=>[e("label",{class:V(o.$q.dark.isActive?"text-red-4":"text-negative")},k(b(c).numero_documento.message),3)]),_:1},8,["type","modelValue","readonly","maxlength","error"])])])]),e("div",ga,[e("div",ba,[e("div",{class:V(["col-11 flex justify-start items-center",[o.$q.screen.xs?"q-my-md":""]])},ya,2),e("div",wa,[e("div",null,[t(re,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:o.$q.dark.isActive?"indigo-6":"indigo-8",filled:""},{default:a(()=>[e("div",$a,[e("div",qa,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",xa,[e("div",null,k(b(N)),1),Ca,ka])])]),_:1},8,["color"])])]),e("div",Va,[e("div",null,[t(re,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:(o.$q.dark.isActive,"orange-9"),filled:""},{default:a(()=>[e("div",Ia,[e("div",Pa,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",Aa,[e("div",null,k(b(z).formatDate(b(M),"DD/MM/YYYY"))+" 12:00 AM",1),Da,Ta])])]),_:1},8,["color"])])]),e("div",Sa,[e("div",null,[t(re,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:o.$q.dark.isActive?"red-7":"red-9",filled:""},{default:a(()=>[e("div",Ra,[e("div",Ea,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",Ma,[e("div",null,k(b(S)),1),Fa,Na])])]),_:1},8,["color"])])])])])])]),e("div",Oa,[e("div",{class:V(["q-pb-md",[o.$q.screen.width>600||" q-ml-lg"]])},[t(L,{type:"submit",icon:"save",loading:T.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Guardar Cambios ")]),_:1},8,["loading"])],2)])])]),_:1}))}};const Qa={class:"my-card"},La={class:"q-pt-none"},ja={class:"row q-pt-sm"},Ba={class:"col-12"},Ya={class:"row"},za=e("label",{class:"text-h6 text-weight-medium"}," >> Servicios de Internet:",-1),Ga={class:"text-h6 text-weight-medium"},Ka={class:"col-12 q-mt-md"},Wa={class:"text-h6 text-center"},Ha={__name:"ServiciosPage",setup(l){const y=[{name:"cont",label:"#",align:"center"},{name:"nombre_plan",align:"center",label:"Plan",field:"nombre_plan"},{name:"precio",label:"Costo",field:"precio",align:"center"},{name:"ipv4",label:"IP",field:"ipv4",align:"center"},{name:"router",label:"Router",field:"router",align:"center"},{name:"fecha_instalacion",label:"Instalado",field:"fecha_instalacion",align:"center"},{name:"direccion",label:"Direcci\xF3n",field:"direccion",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}],{api:u,client_name:v,route:c,servicios:E,mostrarNotify:N}=he();ke();const S=D([]),M=D(!1),T=D(null);S.value=E.value;const O=async()=>{M.value=!1,T.value=null,E.value=[];const{data:i}=await u.get("/customers/find/"+c.params.client_id);i[0].planInternet.forEach(f=>{E.value.push({detalles:{...f,cliente:v.value},servicio_id:f.id,precio:f.precio,direccion:`${f.direccion==""?"- - - - -":f.direccion}`,fecha_instalacion:f.fecha_instalacion,ipv4:f.ipv4,nombre_plan:f.perfil_internet.nombre_plan,router:f.router_id.nombre,estado:`${f.isActive?"Activo":"Inactivo"}`})}),S.value=E.value},o=async(i,f)=>{Le.create({title:`<div class="text-center">
              <i class="fa-regular fa-circle-question"></i>
                ${f=="activar"?"Activar Servicio":"Suspender Servicio"}
            </div>`,message:`<div class="text-center">                  
                  \xBFEstas seguro que deseas ${f=="activar"?"activar":"suspender"} el servicio al cliente?
              </div>
              <div class="text-center">                  
                ${i.detalles.cliente}
              </div>`,html:!0,ok:{push:!0,label:`Si, ${f=="activar"?"Activar":"Suspender"}`,color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{const{data:$}=await u.put(`/customers/activeOrSuspendService/${i.detalles.id}`,{router:i.detalles.router_id,address_list:i.detalles.perfil_internet.address_list,ipv4:i.detalles.ipv4,estado:f});N("positive",`El cliente fue ${f=="activar"?" activado":"suspendido"}`),O()}catch($){N("negative",$.response.data.message)}})};return(i,f)=>(h(),ne(De,null,[t(Ve,{onSubmit:f[0]||(f[0]=()=>{})},{default:a(()=>[e("div",Qa,[e("div",La,[e("div",ja,[e("div",Ba,[e("div",Ya,[e("div",{class:V(["col-12 flex items-center",i.$q.screen.xs?"justify-center":"justify-between"])},[za,e("label",Ga,[t(L,{outline:"",color:"primary",label:"Agregar Servicio",class:V(["q-mr-xs",!i.$q.screen.xs||"q-mt-sm"])},null,8,["class"])])],2),e("div",Ka,[t(je,{rows:S.value,columns:y,class:V([i.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50],"row-key":"name"},{"body-cell-cont":a($=>[t(Y,{props:$},{default:a(()=>[x(k($.rowIndex+1),1)]),_:2},1032,["props"])]),"body-cell-estado":a($=>[t(Y,{props:$},{default:a(()=>[$.row.estado=="Activo"?(h(),A(re,{key:0,outline:"",color:"positive",label:"Activo",class:"q-pa-sm"})):(h(),A(re,{key:1,outline:"",color:"red",label:"Inactivo",class:"q-pa-sm"}))]),_:2},1032,["props"])]),"body-cell-acciones":a($=>[t(Y,{props:$},{default:a(()=>[$.row.estado!=="Inactivo"?(h(),A(L,{key:0,round:"",color:"blue-grey",onClick:U=>(T.value={...$.row.detalles,estado:$.row.estado},M.value=!0),icon:"edit",class:"q-mr-sm",size:"10px"},null,8,["onClick"])):J("",!0),$.row.estado!=="Inactivo"?(h(),A(L,{key:1,round:"",color:"blue-grey",onClick:U=>o($.row,"inactivar"),icon:"power_settings_new",class:"q-mr-sm",size:"10px"},{default:a(()=>[t(pe,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Suspender ")]),_:1})]),_:2},1032,["onClick"])):(h(),A(L,{key:2,round:"",color:"blue-grey",onClick:U=>o($.row,"activar"),icon:"check_circle",class:"q-mr-sm",size:"10px"},{default:a(()=>[t(pe,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Activar ")]),_:1})]),_:2},1032,["onClick"]))]),_:2},1032,["props"])]),_:1},8,["rows","class"])])])])])])])]),_:1}),t(Ue,{modelValue:M.value,"onUpdate:modelValue":f[1]||(f[1]=$=>M.value=$)},{default:a(()=>[t(be,{style:{width:"900px","max-width":"80vw"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",Wa,[x(" Editar Servicio "),ae(t(L,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[$e]])])]),_:1}),t(Ce,{class:"q-mb-md",inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(zt,{servicio:T.value,edit:!0,onActualizarDatos:O},null,8,["servicio"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Za={__name:"ConfiguracionPage",setup(l){return(y,u)=>(h(),A(Gt,{edit:!0}))}};const ye=l=>(Ft("data-v-ab9c3458"),l=l(),Nt(),l),Ja={class:"text-h6 text-center"},Xa={class:"row q-pt-lg q-gutter-lg justify-center"},eo={class:"col-12"},to=ye(()=>e("label",null,"Forma de pago:",-1)),ao={class:"col-12 q-mt-sm"},oo=ye(()=>e("label",null,"N\xBA transacci\xF3n:",-1)),lo={key:0,class:"col-12 q-mt-sm"},so=ye(()=>e("label",null,"Pagar Importe Total:",-1)),no={class:"col-12 q-mt-sm"},io={key:1,class:"col-12 q-mt-sm"},ro=ye(()=>e("label",null,"Monto Pendiente:",-1)),co={key:2,class:"col-12 q-mt-sm"},uo=ye(()=>e("label",null,"Sucursal a Facturar:",-1)),mo={class:"col-12 q-mt-none"},vo=ye(()=>e("label",null,"Notas:",-1)),fo={class:"col-xs-9 col-sm-12 q-mt-lg q-mb-md flex justify-center"},_o={__name:"ModalPago",props:["servicio","nuevoPago"],emits:["actualizarDatos"],setup(l,{emit:y}){const u=l,v=["forma_pago","montoPendiente","montoCancelar"],{api:c,claim:E,mostrarNotify:N,route:S}=ke(),{showModalPago:M}=he(),T=D([]),O=D(!1),o=D({forma_pago:"",n_transaccion:"",importe_total:!0,sucursal_id:"",montoCancelar:"",montoPendiente:"",detalle:""}),i=D({forma_pago:{message:"",isValid:!0},montoPendiente:{message:"",isValid:!0},montoCancelar:{message:"",isValid:!0},sucursal_id:{message:"",isValid:!0}});if(u.nuevoPago)if(u.servicio.pagos.length==0)o.value.montoPendiente=u.servicio.precio,o.value.montoCancelar=u.servicio.precio;else{let I=0;u.servicio.pagos.forEach(n=>{I+=parseFloat(n.valor)});const r=parseFloat(u.servicio.precio)-I;o.value.montoPendiente=r.toString(),o.value.montoCancelar=r.toString()}else o.value={...u.servicio.pago,montoCancelar:parseFloat(u.servicio.pago.valor).toFixed(2)};const f=I=>{let r=0;r=o.value[I];const n=/^\d{0,9}(\.\d{1,2})?$/;setTimeout(function(){let m=0;if(m=o.value[I],!n.test(m.toString())){const s=parseFloat(r.toString().substring(0,r.toString().length-1));o.value[I]=s}},0)},$=()=>{let I=!1;return u.nuevoPago&&(v.forEach(r=>{(o.value[r].length==0||o.value[r]==0)&&(i.value[r].message="Debes completar este campo",i.value[r].isValid=!1,I=!0)}),(E.roles[0]=="SUPER-ADMINISTRADOR"||E.roles[0]=="ADMINISTRADOR")&&o.value.sucursal_id==""&&u.servicio.tipo_comprobante!="Recibo"&&parseFloat(o.value.montoCancelar)>=parseFloat(o.value.montoPendiente)&&(i.value.sucursal_id.message="Debes seleccionar una sucursal",i.value.sucursal_id.isValid=!1,I=!0)),I},U=["Efectivo Oficina/Sucursal","Dep\xF3sito Bancario","Transferencia Bancaria","Facilito","Punto Agil"],H=async()=>{if($())return;const I=Date.now(),r=z.formatDate(I,"DD/MM/YYYY"),n=z.formatDate(I,"HH:mma"),m=parseFloat(o.value.montoPendiente)-parseFloat(o.value.montoCancelar);let s=0;u.nuevoPago&&u.servicio.pagos.forEach(w=>{s+=parseFloat(w.valor)});let _;if(u.nuevoPago)_=u.servicio.pagos,_.unshift({valor:o.value.montoCancelar,monto_pendiente:m.toString(),totalAbonado:(s+parseFloat(o.value.montoCancelar)).toString(),fecha_abono:r,hora_abono:n,detalle:o.value.detalle,n_transaccion:o.value.n_transaccion,forma_pago:o.value.forma_pago});else{const w=u.servicio.pagos.pagos.findIndex(C=>u.servicio.pago.hora_abono==C.hora_abono&&u.servicio.pago.valor==C.valor);u.servicio.pagos.pagos[w]={...o.value}}let R,Q;u.nuevoPago?(R={pagos:_,estadoSRI:m<=0?"PAGADO":"PENDIENTE"},Q=u.servicio.pago_id):(R={pagos:u.servicio.pagos.pagos},Q=u.servicio.pagos.pago_id);try{let w={headers:{"sucursal-id":o.value.sucursal_id}};O.value=!0;const{data:C}=await c.patch(`/pagos/${Q}`,R,w);if(m<=0&&u.servicio.tipo_comprobante!="Recibo"&&u.nuevoPago){let p={customer_id:S.params.client_id,tipo:"EMISION",subtotal:parseFloat(u.servicio.precio),iva:parseFloat(u.servicio.iva),descuento:0,total:parseFloat(u.servicio.precio),entity:"Pagos",pago_id:u.servicio.pago_id,user_id:E.id,products:[{aplicaIva:u.servicio.iva>0,cantidad:1,pvp:u.servicio.precio,descuento:0,nombre:"SERVICIO DE INTERNET",codigoBarra:u.servicio.pago_id.split("-")[0]}]};await c.post("/CE/facturas/generarFacturaElectronica",p,w)}O.value=!1,N("positive",C.msg),M.value=!1,y("actualizarDatos")}catch(w){console.log(w)}},te=async I=>{T.value=[];const{data:r}=await c.get(`/sucursal/find/${I}/company`);r.forEach(n=>{T.value.push({label:n.nombre,value:n.id})}),T.value.length==1&&(o.value.sucursal_id=T.value[0].value)};return(E.roles[0]=="SUPER-ADMINISTRADOR"||E.roles[0]=="ADMINISTRADOR")&&te(E.company.id),(I,r)=>(h(),A(be,{style:{width:"450px !important","max-width":"fit-content"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",Ja,[x(k(u.nuevoPago?"Agregar Pago:":"Editar Pago")+" ",1),ae(t(L,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[$e]])])]),_:1}),t(Ce,{inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(Ve,{onSubmit:H},{default:a(()=>[e("div",Xa,[e("div",eo,[to,t(Te,{color:"orange","transition-show":"scale","transition-hide":"scale","onUpdate:modelValue":[r[0]||(r[0]=n=>i.value.forma_pago.isValid=!0),r[1]||(r[1]=n=>o.value.forma_pago=n)],error:!i.value.forma_pago.isValid,outlined:"",modelValue:o.value.forma_pago,dense:"",options:U},{error:a(()=>[e("label",{class:V(I.$q.dark.isActive?"text-red-4":"text-negative")},k(i.value.forma_pago.message),3)]),_:1},8,["error","modelValue"])]),e("div",ao,[oo,t(ee,{modelValue:o.value.n_transaccion,"onUpdate:modelValue":r[2]||(r[2]=n=>o.value.n_transaccion=n),dense:"",outlined:""},null,8,["modelValue"])]),u.nuevoPago?(h(),ne("div",lo,[so,t(Mt,{color:"green","onUpdate:modelValue":[r[3]||(r[3]=n=>o.value.montoCancelar=o.value.montoPendiente),r[4]||(r[4]=n=>o.value.importe_total=n)],size:"lg",modelValue:o.value.importe_total},null,8,["modelValue"])])):J("",!0),e("div",no,[e("label",null,k(u.nuevoPago?"Monto a Cancelar:":"Monto Cancelado"),1),t(ee,{modelValue:o.value.montoCancelar,"onUpdate:modelValue":[r[5]||(r[5]=n=>o.value.montoCancelar=n),r[6]||(r[6]=n=>(f("montoCancelar"),i.value.montoCancelar.isValid=!0))],modelModifiers:{trim:!0},readonly:o.value.importe_total||!u.nuevoPago,"input-style":"padding-right: 27px;",type:"number",step:"0.01",error:!i.value.montoCancelar.isValid,"input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:V(I.$q.dark.isActive?"text-red-4":"text-negative")},k(i.value.montoCancelar.message),3)]),prepend:a(()=>[t(oe,{name:"attach_money"})]),_:1},8,["modelValue","readonly","error"])]),u.nuevoPago?(h(),ne("div",io,[ro,t(ee,{modelValue:o.value.montoPendiente,"onUpdate:modelValue":[r[7]||(r[7]=n=>o.value.montoPendiente=n),r[8]||(r[8]=n=>(f("montoPendiente"),i.value.montoPendiente.isValid=!0))],modelModifiers:{trim:!0},disable:"",type:"number",step:"0.01",error:!i.value.montoPendiente.isValid,"input-style":"padding-right: 27px;","input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:V(I.$q.dark.isActive?"text-red-4":"text-negative")},k(i.value.montoCancelar.message),3)]),prepend:a(()=>[t(oe,{name:"attach_money"})]),_:1},8,["modelValue","error"])])):J("",!0),u.servicio.tipo_comprobante!="Recibo"&&u.nuevoPago&&parseFloat(o.value.montoCancelar)>=parseFloat(o.value.montoPendiente)?(h(),ne("div",co,[uo,T.value.length>1?(h(),A(Te,{key:0,modelValue:o.value.sucursal_id,"onUpdate:modelValue":[r[9]||(r[9]=n=>o.value.sucursal_id=n),r[10]||(r[10]=n=>i.value.sucursal_id.isValid=!0)],error:!i.value.sucursal_id.isValid,outlined:"",options:T.value,"emit-value":"","map-options":"",dense:""},{error:a(()=>[e("label",{class:V(I.$q.dark.isActive?"text-red-4":"text-negative")},k(i.value.sucursal_id.message),3)]),"no-option":a(()=>[t(me,null,{default:a(()=>[t(se,{class:"text-grey"},{default:a(()=>[x(" No se encontro sucursal ")]),_:1})]),_:1})]),_:1},8,["modelValue","error","options"])):J("",!0)])):J("",!0),e("div",mo,[vo,t(ee,{modelValue:o.value.detalle,"onUpdate:modelValue":r[11]||(r[11]=n=>o.value.detalle=n),modelModifiers:{trim:!0},outlined:"",rows:"2",type:"textarea"},null,8,["modelValue"])]),e("div",fo,[t(L,{type:"submit",icon:"save",loading:O.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Guardar ")]),_:1},8,["loading"])])])]),_:1})]),_:1})]),_:1}))}};var po=Et(_o,[["__scopeId","data-v-ab9c3458"]]);const go={class:"text-h6 text-center"},bo={class:"row q-col-gutter-lg q-mt-md justify-center"},ho={class:"col-xs-12 col-md-9"},yo={class:"row q-col-gutter-lg"},wo={class:"col-xs-12 col-sm-6 q-pt-sm"},$o=e("label",{class:"q-mr-md row items-center"},"Vencimiento:",-1),qo={class:"row items-center justify-end"},xo={class:"col-xs-12 col-sm-6 q-pt-sm"},Co=e("label",{class:"q-mr-md row items-center"},"Fecha:",-1),ko={class:"row items-center justify-end"},Vo={class:"col-12"},Io={class:"full-width row flex-center text-lime-10 q-gutter-sm"},Po=e("span",{class:"text-subtitle1"}," Agrega alg\xFAn Producto ",-1),Ao={class:"q-my-none"},Do={key:0,class:"col-xs-12 col-sm-5 q-mt-sm"},To=e("label",null,"Sucursal a Facturar:",-1),So={class:"col-xs-12 col-sm-7",style:{display:"flex","justify-content":"end"}},Ro={class:"text-right"},Eo=e("td",null,[e("b",null,"TOTAL BRUTO:")],-1),Mo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Fo={class:"text-right"},No=e("td",null,[e("b",null,"DESCUENTOS:")],-1),Oo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Uo={class:"text-right"},Qo=e("td",null,[e("b",null,"SUBTOTAL:")],-1),Lo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},jo={class:"text-right"},Bo=e("td",null,[e("b",null,"IVA(12%):")],-1),Yo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},zo={class:"text-right"},Go=e("td",null,[e("b",null,"TOTAL:")],-1),Ko={style:{width:"50px"}},Wo={class:"col-xs-9 col-sm-12 q-pt-none q-mb-md flex justify-center"},Ho={__name:"ModalNuevaFactura",setup(l){const{api:y,claim:u,pagos:v,mostrarNotify:c,route:E,showModalNuevaFactura:N}=he(),S=D([{name:"acciones",label:"Quitar",align:"left"},{label:"Producto/Servicio",align:"left",field:"producto",name:"producto"},{name:"cantidad",label:"Cantidad",align:"left"},{name:"iva",label:"IVA(%)",align:"center"},{name:"descuento",label:"Descuento %",align:"left",field:"descuento"},{name:"v_total",label:"Total",align:"center",field:"v_total"}]),M=D([]),T=D([]),O=D(!1),o=D({fechaVencimiento:"",fecha:"",sucursal_id:""}),{vencimiento:i,servicio:{perfil_internet:{nombre_plan:f,descarga_Mbps:$,subida_Mbps:U,impuesto:H},factura_id:{tipo_comprobante:te},precio:I}}=v.value[0],r=i.split("/"),n=`${r[2]}-${r[1]}-${r[0]}`;o.value.fechaVencimiento=z.addToDate(n,{months:1,day:1});const m=z.addToDate(n,{months:2,day:1});o.value.fechaVencimiento=z.formatDate(o.value.fechaVencimiento,"YYYY/MM/DD"),o.value.fecha=z.formatDate(Date.now(),"YYYY/MM/DD");const s=`
Servicio de Internet Banda ancha
facturaci\xF3n del ${z.formatDate(o.value.fechaVencimiento,"DD/MM/YYYY")} al ${z.formatDate(m,"DD/MM/YYYY")}
Fecha de Suspensi\xF3n : ${z.formatDate(o.value.fechaVencimiento,"DD/MM/YYYY")}
Plan de Internet : ${f}
Descarga : ${$} Mbps
Subida : ${U} Mbps`;M.value.unshift({tipo:"servicio",producto:s,cantidad:1,iva:H,descuento:0,precio:I,v_total:parseFloat(I)-H*parseFloat(I)/100});const _=G(()=>{let w=0,C=0,p=0,K=0;return M.value.forEach(W=>{W.descuento>0&&(p+=parseFloat(W.v_total)*parseFloat(W.descuento)/100),W.iva&&(C+=(parseFloat(W.v_total)-parseFloat(W.v_total)*parseFloat(W.descuento)/100)*(parseInt(W.iva)/100)),w+=parseFloat(W.v_total)}),K=w+C-p,{subtotal:parseFloat((Math.floor(w*100)/100).toString()),iva:parseFloat((Math.floor(C*100)/100).toString()),descuento:parseFloat((Math.floor(p*100)/100).toString()),total:parseFloat((Math.floor(K*100)/100).toString())}}),R=async w=>{T.value=[];const{data:C}=await y.get(`/sucursal/find/${w}/company`);C.forEach((p,K)=>{T.value.push({label:p.nombre,value:p.id}),K+1==C.length&&T.value.length>0&&(o.value.sucursal_id=T.value[0].value)})};u.roles[0]=="SUPER-ADMINISTRADOR"||u.roles[0]=="ADMINISTRADOR"?R(u.company.id):o.value.sucursal_id=u.sucursales[0];const Q=async()=>{Le.create({title:"\xBFDeseas agregar esta factura?",ok:{push:!0,color:"cyan-10",label:"Agregar"},cancel:{push:!0,color:"blue-grey-6",label:"Cancelar"}}).onOk(async()=>{try{let w={headers:{"sucursal-id":o.value.sucursal_id}};O.value=!0;const C={estadoSRI:"PAGADO",pagos:[{detalle:"",fecha_abono:z.formatDate(o.value.fecha,"DD/MM/YYYY"),forma_pago:"Efectivo",hora_abono:z.formatDate(Date.now(),"HH:mma"),monto_pendiente:"0",n_transaccion:"",totalAbonado:`${_.value.total}`,valor:`${_.value.total}`}]},{data:p}=await y.post("/pagos/create",{servicio:v.value[0].servicio.id,...C,dia_pago:z.formatDate(o.value.fechaVencimiento,"YYYY-MM-DD")},w);if(te!="Recibo"){let K=[];M.value.forEach((le,we)=>{K.push({aplicaIva:le.iva>0,cantidad:le.cantidad,pvp:le.v_total,descuento:le.descuento,nombre:le.tipo=="servicio"?"SERVICIO DE INTERNET":le.producto,codigoBarra:p.id.split("-")[0]+`${we}`})});let W={customer_id:E.params.client_id,tipo:"EMISION",subtotal:_.value.subtotal,iva:_.value.iva,descuento:_.value.descuento,total:_.value.total,entity:"Pagos",pago_id:p.id,user_id:u.id,products:K};await y.post("/CE/facturas/generarFacturaElectronica",W,w)}O.value=!1,N.value=!1,c("positive","Factura Generado"),emit("actualizarDatos")}catch(w){c("negative","Algo salio mal"),console.log(w)}})};return(w,C)=>(h(),A(be,{style:{width:"1000px","max-width":"80vw"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",go,[x(" Nueva Factura Servicio "),ae(t(L,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[$e]])])]),_:1}),t(Ce,{inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(Ve,{onSubmit:Ot(Q,["prevent"])},{default:a(()=>[e("div",bo,[e("div",ho,[e("div",yo,[e("div",wo,[$o,t(ee,{dense:"",filled:"",modelValue:o.value.fechaVencimiento,"onUpdate:modelValue":C[1]||(C[1]=p=>o.value.fechaVencimiento=p),mask:"date",rules:["date"]},{append:a(()=>[t(oe,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(lt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(ot,{modelValue:o.value.fechaVencimiento,"onUpdate:modelValue":C[0]||(C[0]=p=>o.value.fechaVencimiento=p)},{default:a(()=>[e("div",qo,[ae(t(L,{label:"Close",color:"primary",flat:""},null,512),[[$e]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",xo,[Co,t(ee,{dense:"",filled:"",modelValue:o.value.fecha,"onUpdate:modelValue":C[3]||(C[3]=p=>o.value.fecha=p),mask:"date",rules:["date"],hint:"ejfiojwef","hide-hint":""},{append:a(()=>[t(oe,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(lt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(ot,{modelValue:o.value.fecha,"onUpdate:modelValue":C[2]||(C[2]=p=>o.value.fecha=p)},{default:a(()=>[e("div",ko,[ae(t(L,{label:"Close",color:"primary",flat:""},null,512),[[$e]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),e("div",Vo,[t(je,{rows:M.value,columns:S.value,"row-key":"name",class:V([w.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50]},{"no-data":a(({})=>[e("div",Io,[Po,t(oe,{size:"2em",name:"playlist_add"})])]),"body-cell-producto":a(p=>[t(Y,{props:p},{default:a(()=>[e("pre",Ao,"                      "+k(p.row.producto)+`
                    `,1)]),_:2},1032,["props"])]),"body-cell-cantidad":a(p=>[t(Y,{props:p},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",readonly:p.row.tipo=="servicio",min:"0",max:p.row.stock,type:"number",style:{width:"100px"},modelValue:p.row.cantidad,"onUpdate:modelValue":K=>p.row.cantidad=K,modelModifiers:{trim:!0}},null,8,["readonly","max","modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-descuento":a(p=>[t(Y,{props:p},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",min:"0",max:"100",type:"number",style:{width:"100px"},modelValue:p.row.descuento,"onUpdate:modelValue":K=>p.row.descuento=K},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-iva":a(p=>[t(Y,{props:p},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",min:"0",max:"100",type:"number",style:{width:"100px"},modelValue:p.row.iva,"onUpdate:modelValue":K=>p.row.iva=K,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-v_total":a(p=>[t(Y,{props:p},{default:a(()=>[x(" $"+k(p.row.v_total),1)]),_:2},1032,["props"])]),"body-cell-acciones":a(p=>[t(Y,{props:p},{default:a(()=>[t(L,{round:"",color:"deep-orange",disable:p.row.tipo=="servicio",onClick:K=>w.quitarArticulo(p.row.id),icon:"close",size:"8px"},null,8,["disable","onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","class"])]),b(u).roles[0]=="SUPER-ADMINISTRADOR"||b(u).roles[0]=="ADMINISTRADOR"?(h(),ne("div",Do,[To,T.value.length>1?(h(),A(Te,{key:0,modelValue:o.value.sucursal_id,"onUpdate:modelValue":C[4]||(C[4]=p=>o.value.sucursal_id=p),outlined:"",options:T.value,"emit-value":"","map-options":"",dense:""},{"no-option":a(()=>[t(me,null,{default:a(()=>[t(se,{class:"text-grey"},{default:a(()=>[x(" No se encontro sucursales ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"])):J("",!0)])):J("",!0),e("div",So,[e("table",{class:V([w.$q.screen.xs?"":"linearTablaDetalle"])},[e("tr",Ro,[Eo,e("td",Mo," $"+k(_.value.subtotal),1)]),e("tr",Fo,[No,e("td",Oo," $"+k(_.value.descuento),1)]),e("tr",Uo,[Qo,e("td",Lo," $"+k(_.value.subtotal-_.value.descuento),1)]),e("tr",jo,[Bo,e("td",Yo," $"+k(_.value.iva),1)]),e("tr",zo,[Go,e("td",Ko,[t(re,{outline:"",class:"text-subtitle1 text-weight-bold",color:"secondary",label:`$${_.value.total}`},null,8,["label"])])])],2)]),e("div",Wo,[t(L,{type:"submit",icon:"save",loading:O.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Crear Factura ")]),_:1},8,["loading"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}))}};const Zo={class:"my-card"},Jo={class:"q-pt-none"},Xo={class:"row"},el={class:"col-12"},tl={class:"row"},al={class:"col-12 text-right"},ol={class:"col-12 q-mt-md"},ll=e("br",null,null,-1),sl=e("br",null,null,-1),nl=e("br",null,null,-1),il=e("br",null,null,-1),rl={class:"row q-col-gutter-sm"},cl=e("div",{class:"full-width row flex-center text-lime-10 q-gutter-sm"},[e("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun registros ")],-1),ul={__name:"IndexFacturas",setup(l){const y=D([{name:"x",align:"center",label:" ",field:"x"},{name:"n_comprobantes",align:"center",label:"N. Comprobante",field:"n_comprobantes"},{name:"emitido",label:"Emitido",field:"emitido",align:"center"},{name:"vencimiento",label:"Vencimiento",field:"vencimiento",align:"center"},{name:"precio",label:"Total",field:"precio",align:"center"},{name:"iva",label:"Impuesto",field:"iva",align:"center"},{name:"pagado",label:"Pagado",field:"pagado",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}]),u=D(!0),v=D({}),{api:c,servicios:E,pagos:N,showModalPago:S,showModalNuevaFactura:M,dia_vencimiento:T}=he(),{claim:O,route:o}=ke();let i;const f=()=>{const n=new Jt("https://facturacion.rednuevaconexion.net/socket.io/socket.io.js",{extraHeaders:{autentication:O.id}});i==null||i.removeAllListeners(),i=n.socket("/"),i.on("updateStateInvoice",()=>{N.value=[],U()})},$=async()=>{const{data:n}=await c.get("/customers/find/"+o.params.client_id);return n},U=async()=>{try{N.value=[];const{data:n}=await c.get("/pagos/find/"+E.value[0].servicio_id);n.length>0&&n[0].servicio.factura_id.tipo_comprobante=="Recibo"&&(y.value[1].label="Tipo Comprobante"),n.forEach(m=>{var C;let s;m.servicio.factura_id.tipo_impuesto=="Impuestos incluido"?s=`${Math.floor(parseFloat(m.servicio.precio)*.12*100)/100}`:s=0;let _=0;m.pagos.forEach(p=>{_+=parseFloat(p.valor)});const R=(C=m.estadoSRI)==null?void 0:C.trim();let Q=parseInt(m.servicio.factura_id.dia_gracia.split(" ")[0]);const w=z.addToDate(m.dia_pago,{days:Q+1});N.value.push({ambiente:m.sucursal_id?m.sucursal_id.ambiente:"",clave_acceso:m.clave_acceso,company_name:m.servicio.router_id.company_id.nombre_comercial,num_comprobante:m.num_comprobante,sucursal_id:m.sucursal_id!==null?m.sucursal_id.id:null,pago_id:m.id,ruc:m.servicio.perfil_internet.router_id.company_id.ruc,direccion:m.sucursal_id!==null?m.sucursal_id.direccion:null,emitido:z.formatDate(m.created_at,"DD/MM/YYYY"),vencimiento:z.formatDate(w,"DD/MM/YYYY"),precio:`${m.servicio.precio}`,tipo_comprobante:m.servicio.factura_id.tipo_comprobante,iva:s,pagos:m.pagos,pagado:_,servicio:m.servicio,estado:R,cancelado:_>=parseFloat(m.servicio.precio),expand:!1,loading:!1})})}catch(n){console.log(n)}},H=async(n,m)=>{N.value[m].loading=!0;let s={headers:{"sucursal-id":n.sucursal_id}},_={ambiente:n.ambiente,clave_acceso:n.clave_acceso,company_name:n.company_name,sucursal_id:n.sucursal_id,customer_id:o.params.client_id,num_comprobante:n.num_comprobante,tipo:"EMISION",subtotal:parseFloat(n.precio),iva:parseFloat(n.iva),descuento:0,total:parseFloat(n.precio),entity:"Pagos",pago_id:n.pago_id,user_id:O.id,products:[{aplicaIva:n.iva>0,cantidad:1,pvp:n.precio,descuento:0,nombre:"SERVICIO DE INTERNET",codigoBarra:n.pago_id.split("-")[0]}]};n.estado.trim()=="ERROR ENVIO RECEPCION"&&await c.post("/CE/facturas/recepcionComprobantesOffline",_,s),n.estado.trim()=="RECIBIDA"&&await c.post("/CE/facturas/autorizacionComprobantesOffline",_,s),N.value[m].loading=!1},te=async(n,m,s=null)=>{s&&(n.company_name=s.company_name,n.ruc=s.ruc,n.direccion=s.direccion);const _=await $(),R={cliente:_[0].nombres,tipoDoc:_[0].tipo_documento,num_doc:_[0].numero_documento,email:_[0].email},{imprimirAbono:Q,imprimirFactura:w}=Zt();let C="";m=="Recibo"?C=Q(n,R,O.fullName,m):C=w(n,R,O.fullName,m);var p=window.open("","_blank");p.document.write(C),p.print(),p.close()},I=(n,m,s,_)=>{Le.create({title:"\xBFEstas seguro de eliminar este abono?",message:`<span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Fecha abonado:
                  </strong>
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${n.fecha_abono} ${n.hora_abono}
                  </label>
                </span>
                <span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Forma de pago:
                  </strong>
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${n.forma_pago}
                  </label>
                </span>
                <span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Valor Abonado:
                  </strong>
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    $${parseFloat(n.valor).toFixed(2)}
                  </label>
                </span>`,html:!0,ok:{push:!0,label:"Eliminar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{const R=[...m];let Q=0;R.reverse().map((w,C)=>{n.hora_abono==w.hora_abono&&n.valor==w.valor?w.delete=!0:(w.totalAbonado=(parseFloat(w.valor)+Q).toString(),w.monto_pendiente=(parseFloat(s)-parseFloat(w.totalAbonado)).toString(),Q+=parseFloat(w.totalAbonado))}),setTimeout(async()=>{const w=R.filter(C=>C.delete!==!0);await c.patch(`/pagos/${_}`,{pagos:w}),U()},1e3)}catch(R){mostrarNotify("negative",R.response.data.message)}})},r=async n=>{await c.post(`/CE/facturas/getRide/${n}`,{},{responseType:"blob"}).then(m=>{var s=new Blob([m.data],{type:"application/pdf"}),_=URL.createObjectURL(s);window.open(_)}).catch(m=>{m.response.status==422&&this.$setLaravelErrors(m.response.data.errors)})};return U(),f(),(n,m)=>(h(),ne(De,null,[t(Ve,{onSubmit:m[1]||(m[1]=()=>{})},{default:a(()=>[e("div",Zo,[e("div",Jo,[e("div",Xo,[e("div",el,[e("div",tl,[e("div",al,[t(L,{onClick:m[0]||(m[0]=s=>M.value=!0),outline:"",color:"primary",label:"Factura de Servicio",class:V(["q-mr-xs",!n.$q.screen.xs||"q-mt-sm"])},null,8,["class"])]),e("div",ol,[t(je,{rows:b(N),columns:y.value,class:V([n.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50],"row-key":"name"},{body:a(s=>[t(at,{props:s},{default:a(()=>[s.row.estado!="NO PAGADO"?(h(),A(Y,{key:0,"auto-width":""},{default:a(()=>[t(L,{size:"sm",color:"accent",round:"",dense:"",onClick:_=>s.row.expand=!s.row.expand,icon:s.row.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024)):(h(),A(Y,{key:1,"auto-width":""})),t(Y,{key:"n_comprobantes",props:s},{default:a(()=>[x(k(s.row.tipo_comprobante=="Recibo"?"Recibo":s.row.num_comprobante==""||s.row.num_comprobante==null?"- - - - - -":s.row.num_comprobante),1)]),_:2},1032,["props"]),t(Y,{key:"emitido",props:s},{default:a(()=>[x(k(s.row.emitido),1)]),_:2},1032,["props"]),t(Y,{key:"vencimiento",props:s},{default:a(()=>[x(k(s.row.vencimiento),1)]),_:2},1032,["props"]),t(Y,{key:"precio",props:s},{default:a(()=>[x(" $"+k(s.row.precio),1)]),_:2},1032,["props"]),t(Y,{key:"iva",props:s},{default:a(()=>[x(" $"+k(s.row.iva),1)]),_:2},1032,["props"]),t(Y,{key:"pagado",props:s},{default:a(()=>[x(" $"+k(s.row.pagado),1)]),_:2},1032,["props"]),t(Y,{key:"estado",props:s},{default:a(()=>[s.row.estado=="AUTORIZADO"?(h(),A(re,{key:0,outline:"",class:"q-py-xs q-px-md",color:"secondary"},{default:a(()=>[x(" PAGADO "),ll,x(" Y "),sl,x(" AUTORIZADO ")]),_:1})):s.row.estado=="NO PAGADO"||s.row.estado=="PENDIENTE"?(h(),A(re,{key:1,outline:"",class:"q-py-xs q-px-md",color:n.$q.dark.isActive?"blue-grey-3":"blue-grey-7",label:s.row.estado},null,8,["color","label"])):s.row.estado=="PAGADO"?(h(),A(re,{key:2,outline:"",class:"q-py-xs q-px-md",color:"secondary",label:s.row.estado},null,8,["label"])):(h(),A(re,{key:3,outline:"",class:"q-py-xs q-px-md",color:n.$q.dark.isActive?"warning":"orange-10"},{default:a(()=>[x(" PAGADO "),nl,x(" - "),il,x(" "+k(s.row.estado),1)]),_:2},1032,["color"]))]),_:2},1032,["props"]),t(Y,{key:"acciones",props:s},{default:a(()=>[s.row.cancelado?J("",!0):(h(),A(L,{key:0,round:"",color:"blue-grey",onClick:_=>(S.value=!0,v.value=s.row),icon:"done",size:"10px",class:"q-mr-sm"},{default:a(()=>[t(pe,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Agregar Pago ")]),_:1})]),_:2},1032,["onClick"])),s.row.estado=="ERROR ENVIO RECEPCION"||s.row.estado=="ERROR ENVIO RECEPCION - ANULACION"||s.row.estado=="RECIBIDA"?(h(),A(L,{key:1,round:"",color:"blue-grey",icon:"fa-solid fa-retweet",loading:s.row.loading,onClick:_=>H(s.row,s.rowIndex),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(pe,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Emitir Factura Electr\xF3nica ")]),_:1})]),_:2},1032,["loading","onClick"])):J("",!0),s.row.estado=="AUTORIZADO"?(h(),A(L,{key:2,round:"",color:"blue-grey",icon:"print",onClick:_=>te(s.row,"factura"),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(pe,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Imprimir comprobante ")]),_:1})]),_:2},1032,["onClick"])):J("",!0),s.row.estado=="AUTORIZADO"?(h(),A(L,{key:3,round:"",color:"blue-grey",icon:"fa-solid fa-file-pdf",onClick:_=>r(s.row.clave_acceso),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(pe,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Descargar PDF ")]),_:1})]),_:2},1032,["onClick"])):J("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"]),ae(t(at,{props:s},{default:a(()=>[t(Y,{colspan:"100%"},{default:a(()=>[e("div",rl,[(h(!0),ne(De,null,Ut(s.row.pagos,(_,R)=>(h(),ne("div",{key:R,class:"col-4"},[t(Ht,{bordered:"",padding:"",dense:""},{default:a(()=>[t(ie,{header:"",class:"text-center"},{default:a(()=>[x(" Fecha Abonado: "+k(_.fecha_abono)+" "+k(_.hora_abono),1)]),_:2},1024),ae((h(),A(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ie,null,{default:a(()=>[x("Forma de Pago:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ie,null,{default:a(()=>[x(k(_.forma_pago),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[_e]]),ae((h(),A(me,{tag:"label",class:""},{default:a(()=>[t(se,null,{default:a(()=>[t(ie,null,{default:a(()=>[x("Valor Abonado:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ie,null,{default:a(()=>[x("$"+k(_.valor),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[_e]]),ae((h(),A(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ie,null,{default:a(()=>[x("N\xBA transacci\xF3n:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ie,null,{default:a(()=>[x(k(_.n_transaccion),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[_e]]),ae((h(),A(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ie,null,{default:a(()=>[x("Detalle:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ie,null,{default:a(()=>[x(k(_.detalle==""?"Sin detalles":_.detalle),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[_e]]),ae((h(),A(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ie,{class:"text-center"},{default:a(()=>[s.row.estado=="PENDIENTE"?(h(),A(L,{key:0,square:"",onClick:Q=>(S.value=!0,v.value={pagos:s.row,pago:_},u.value=!1),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md q-mr-md",outline:"",rounded:"",dense:"","icon-right":"edit"},null,8,["onClick","color"])):J("",!0),t(L,{square:"",onClick:Q=>te(_,"Recibo",s.row),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md",outline:"",rounded:"",dense:"","icon-right":"print"},null,8,["onClick","color"]),s.row.estado=="PENDIENTE"?(h(),A(L,{key:1,square:"",onClick:Q=>I(_,s.row.pagos,s.row.precio,s.row.pago_id),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md q-ml-md",outline:"",rounded:"",dense:"","icon-right":"delete"},null,8,["onClick","color"])):J("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[_e]])]),_:2},1024)]))),128))])]),_:2},1024)]),_:2},1032,["props"]),[[Qt,s.row.expand]])]),"no-data":a(({icon:s})=>[cl]),_:1},8,["rows","columns","class"])])])])])])])]),_:1}),t(Ue,{modelValue:b(S),"onUpdate:modelValue":m[2]||(m[2]=s=>tt(S)?S.value=s:null)},{default:a(()=>[t(po,{servicio:v.value,nuevoPago:u.value,onActualizarDatos:U},null,8,["servicio","nuevoPago"])]),_:1},8,["modelValue"]),t(Ue,{modelValue:b(M),"onUpdate:modelValue":m[3]||(m[3]=s=>tt(M)?M.value=s:null)},{default:a(()=>[t(Ho,{onActualizarDatos:U})]),_:1},8,["modelValue"])],64))}},dl={class:"q-gutter-y-md"},ml={__name:"FacturacionPagos",setup(l){const y=D("facturas");return(u,v)=>(h(),ne("div",dl,[t(be,null,{default:a(()=>[t(rt,{modelValue:y.value,"onUpdate:modelValue":v[0]||(v[0]=c=>y.value=c),draggable:"false",dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":""},{default:a(()=>[t(qe,{name:"facturas",label:"Facturas"}),t(qe,{name:"configuracion",label:"Configuraci\xF3n"})]),_:1},8,["modelValue"]),t(Ce),t(ct,{modelValue:y.value,"onUpdate:modelValue":v[1]||(v[1]=c=>y.value=c),animated:""},{default:a(()=>[t(xe,{name:"facturas"},{default:a(()=>[t(ul)]),_:1}),t(xe,{name:"configuracion"},{default:a(()=>[t(Za)]),_:1})]),_:1},8,["modelValue"])]),_:1})]))}};const vl={class:"q-gutter-y-md"},fl={__name:"IndexPage",setup(l){const y=D("resumen");return(u,v)=>(h(),ne("div",vl,[t(be,null,{default:a(()=>[t(rt,{modelValue:y.value,"onUpdate:modelValue":v[0]||(v[0]=c=>y.value=c),draggable:"false",dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:a(()=>[t(qe,{name:"resumen",label:"Resumen"}),t(qe,{name:"servicios",label:"Servicios"}),t(qe,{name:"facturacion/pagos",label:"Facturaci\xF3n/Pagos"})]),_:1},8,["modelValue"]),t(Ce),t(ct,{modelValue:y.value,"onUpdate:modelValue":v[1]||(v[1]=c=>y.value=c),animated:""},{default:a(()=>[t(xe,{name:"resumen"},{default:a(()=>[t(Ua)]),_:1}),t(xe,{name:"servicios"},{default:a(()=>[y.value=="servicios"?(h(),A(Ha,{key:0})):J("",!0)]),_:1}),t(xe,{name:"facturacion/pagos"},{default:a(()=>[y.value=="facturacion/pagos"?(h(),A(ml,{key:0})):J("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]))}},_l={class:"q-ma-lg q-pt-md"},pl={class:"row q-col-gutter-md",style:{"justify-content":"center"}},gl={class:"text-h6 text-center",style:{position:"relative",top:"-8px",left:"17px"}},bl={class:"row q-col-gutter-md",style:{"justify-content":"center"}},hl={class:"col-xs-11 col-md-11 q-pt-xs"},Yl={__name:"EditCliente",setup(l){const{api:y,route:u,formCliente:v,formFacturacion:c}=ke(),{client_name:E,dia_vencimiento:N,mes_pago:S,servicios:M}=he(),T=async()=>{const{data:o}=await y.get("/pagos/find/"+M.value[0].servicio_id);o.length>0&&(S.value.dia_pago=o[0].dia_pago,o[0].estadoSRI!=="PAGADO"&&o[0].estadoSRI!=="AUTORIZADO"?S.value.estado="pendiente":S.value.estado="pagado"),S.value.meses_vencidos=o.reduce((i,f)=>i+(f.estadoSRI=="NO PAGADO"||f.estadoSRI=="PENDIENTE"),0),o.forEach((i,f)=>{let $=parseInt(i.servicio.factura_id.dia_gracia.split(" ")[0]);N.value=z.addToDate(i.dia_pago,{days:$+1}),f==0&&(S.value.dia_vencimiento=N.value)})};return(async()=>{M.value=[];const{data:o}=await y.get("/customers/find/"+u.params.client_id);E.value=o[0].nombres,v.value={...o[0]},o[0].planInternet.forEach(i=>{c.value={...i.factura_id},M.value.push({detalles:{...i,cliente:E.value},servicio_id:i.id,precio:i.precio,direccion:`${i.direccion==""?"- - - - -":i.direccion}`,fecha_instalacion:i.fecha_instalacion,ipv4:i.ipv4,nombre_plan:i.perfil_internet.nombre_plan,router:i.router_id.nombre,estado:`${i.isActive?"Activo":"Inactivo"}`})}),T()})(),(o,i)=>(h(),ne(De,null,[e("div",_l,[e("div",pl,[e("div",{class:V(["col-xs-12 q-pl-none",[o.$q.screen.width<1022?"q-pt-sm col-md-6":"col-md-6"]])},[t(wt,{class:V(["row q-mr-xs",[o.$q.screen.width<1022?"justify-center q-pt-sm":"justify-start "]])},{default:a(()=>[t(Fe,{label:"Inicio",icon:"home",to:"/"}),t(Fe,{label:"Clientes",icon:"fa-solid fa-list",to:"/clientes"}),t(Fe,{label:"Nuevo",icon:"add_circle"})]),_:1},8,["class"])],2),e("div",{class:V(["col-xs-12",[o.$q.screen.width<1022?"text-center q-pt-sm col-md-6 q-pl-none":"text-right col-md-5"]])},[e("label",gl,k(b(E)),1)],2)])]),e("div",bl,[e("div",hl,[t(be,{flat:"",class:"shadow_custom q-pt-none"},{default:a(()=>[t(fl,{edit:!0})]),_:1})])])],64))}};export{Yl as default};
