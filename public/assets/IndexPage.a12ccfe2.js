import{r as v,o as r,a9 as c,g as o,f as t,aV as ae,e as n,aa as h,O as U,h as E,ah as ye,i as V,af as g,ae as N,ab as k,c as Q,ad as d,Q as W,aU as ce,v as oe,C as Re,ba as te,aj as se,ai as we,bc as X}from"./index.cfa4c6fc.js";import{Q as ne}from"./QDate.5bf9fd9f.js";import{Q as re}from"./QPopupProxy.cc84b20f.js";import{Q as ie,d as ue,a as de}from"./format.b474c67d.js";import{Q as Ie}from"./QList.95983c7d.js";import{Q as he}from"./QBtnDropdown.858016d9.js";import{Q as Ce}from"./QInnerLoading.7cb768b5.js";import{Q as Oe,a as Ee}from"./QTable.185450c5.js";import{Q as ke,a as $}from"./QTooltip.b2ba8d35.js";import{Q as K}from"./QSelect.37bb8027.js";import{Q as z}from"./QTd.7d7cc3df.js";import{Q as H}from"./QBadge.204bbd27.js";import{Q as xe}from"./QPageSticky.8b57ef5f.js";import{C as F}from"./ClosePopup.4d8fbb44.js";import{M as Ae}from"./index.2065a85c.js";import{u as Ne}from"./useRolPermisos.2d333bf7.js";import{u as me}from"./useHelpers.79731713.js";import{d as Se}from"./date.6fd6b604.js";import{a as Ve}from"./use-quasar.87a49eb3.js";import{E as De}from"./exceljs.min.80d1da29.js";import{_ as qe}from"./DetalleProducts.aedae83d.js";import{u as Te}from"./useImpresion.4d2c76f5.js";import{e as $e}from"./vue3-q-tel-input.esm.09c93f9f.js";import"./QBtnGroup.7ca136d3.js";import"./axios.b700cc31.js";const Ue=()=>({generarExcel:x=>{let C=x.map(i=>[i.created_at.split(" ")[0],i.numero_comprobante,i.clave_acceso,i.customer_id.nombres,i.customer_id.numero_documento,i.subtotal,i.iva,i.total,i.estadoSRI]);C=C.filter(i=>i[8]=="AUTORIZADO");const _=new De.Workbook,O=_.addWorksheet("Hoja1");O.columns=[{header:"Fecha",key:"Fecha",width:15,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"# Documento",key:"Documento",width:22,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"CA/NA",key:"CA",width:53,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Persona",key:"Persona",width:45,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Identificaci\xF3n",key:"Identificaci\xF3n",width:18,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Subtotal",key:"Subtotal",width:14,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"IVA",key:"IVA",width:10,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Total",key:"Total",width:14,style:{font:{bold:!0},alignment:{horizontal:"center"}}}],C.forEach((i,y)=>{Object.assign(O.getCell(`A${y+2}`),{value:i[0],font:{bold:!1}}),Object.assign(O.getCell(`B${y+2}`),{value:i[1],font:{bold:!1}}),Object.assign(O.getCell(`C${y+2}`),{value:i[2],font:{bold:!1}}),Object.assign(O.getCell(`D${y+2}`),{value:i[3],font:{bold:!1}}),Object.assign(O.getCell(`E${y+2}`),{value:i[4],font:{bold:!1}}),Object.assign(O.getCell(`F${y+2}`),{value:i[5],font:{bold:!1}}),Object.assign(O.getCell(`G${y+2}`),{value:i[6],font:{bold:!1}}),Object.assign(O.getCell(`H${y+2}`),{value:i[7],font:{bold:!1}})}),_.xlsx.writeBuffer().then(i=>{const y=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),R=URL.createObjectURL(y),s=document.createElement("a");s.href=R,s.download="archivo.xlsx",document.body.appendChild(s),s.click(),document.body.removeChild(s)})}});const Fe={class:"text-h6 text-center"},Qe={class:"row flex flex-center"},Pe={class:"col-xs-11 col-sm-9 text-center q-mt-md q-mb-lg"},Le=n("label",null,"Enviar por:",-1),Me={key:0,class:"col-xs-11 col-sm-9 text-center q-mb-md"},ze=n("label",null,"Celular del cliente:",-1),je={key:1,class:"col-xs-11 col-sm-9 text-center"},Be=n("label",null,"Email del cliente:",-1),Ze={class:"col-xs-9 col-md-12 flex justify-center q-ml-none"},He={__name:"ModalReenviarComproantes",props:["detalleFactura"],emits:["closeModal"],setup(G,{emit:x}){const C=G,{api:_,mostrarNotify:O,claim:i}=me(),y=v(!1),R=v(!1),s=v({tipo_envio:"",telefono:"",email:""});s.value.telefono=C.detalleFactura.customer_id.celular,s.value.email=C.detalleFactura.customer_id.email;const j=()=>{y.value=!1;const f=/^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/;let u=[];return s.value.tipo_envio=="whatsapp"&&u.push("telefono"),s.value.tipo_envio=="email"&&u.push("email"),s.value.tipo_envio=="ambas"&&(u=["telefono","email"]),s.value.tipo_envio==""&&(u=["tipo_envio"]),s.value.email.length>5&&!f.test(s.value.email)&&(p.value.email.message="Ingresa un email valido",p.value.email.isValid=!1,y.value=!0),u.forEach(w=>{s.value[w].length==0&&(p.value[w].message="Debes completar este campo",p.value[w].isValid=!1,y.value=!0)}),y.value};function Z(f){return f.startsWith("593")?f:(f=f.replace(/\s/g,"").replace(/-/g,""),f.startsWith("0")?"593"+f.substring(1):"593"+f)}const p=v({telefono:{message:"",isValid:!0},tipo_envio:{message:"",isValid:!0},email:{message:"",isValid:!0}}),B=async()=>{const{data:f}=await _.get(`/companies/find/${i.company.id}`);if(!j()&&!((s.value.tipo_envio=="whatsapp"||s.value.tipo_envio=="ambas")&&!p.value.telefono.isValid))try{R.value=!0,await _.post("/CE/facturas/reenviar-comprobantes",{...s.value,factura:C.detalleFactura,number:s.value.telefono,telefono:Z(f[0].telefono)}),O("positive","Comprobantes enviados"),x("closeModal"),R.value=!1}catch(u){R.value=!1,O("warning",u.response.data.message),x("closeModal")}},J=f=>{p.value.telefono.isValid=!f};return(f,u)=>(r(),c(ce,{style:{width:"400px","max-width":"80vw"}},{default:o(()=>[t(ae,null,{default:o(()=>[n("div",Fe,[h(" Enviar Comprobantes "),U(t(E,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[F]])])]),_:1}),t(ye,{inset:""}),t(ae,{class:"q-pt-none"},{default:o(()=>[n("div",Qe,[n("div",Pe,[Le,t(K,{filled:"",dense:"",modelValue:s.value.tipo_envio,"onUpdate:modelValue":u[0]||(u[0]=w=>s.value.tipo_envio=w),error:!p.value.tipo_envio.isValid,"emit-value":"","map-options":"",options:[{label:"WhatsApp",value:"whatsapp"},{label:"Email",value:"email"},{label:"Ambas",value:"ambas"}]},{append:o(()=>[s.value.tipo_envio.length!=0&&s.value.tipo_envio=="whatsapp"?(r(),c(V,{key:0,name:"fa-brands fa-whatsapp",color:"teal-7"})):g("",!0),s.value.tipo_envio.length!=0&&s.value.tipo_envio=="email"?(r(),c(V,{key:1,name:"mail",color:"indigo-5"})):g("",!0),s.value.tipo_envio.length!=0&&s.value.tipo_envio=="ambas"?(r(),c(V,{key:2,name:"fa-solid fa-list-check",color:"deep-orange-4"})):g("",!0)]),error:o(()=>[n("label",{class:N(f.$q.dark.isActive?"text-red-4":"text-negative")},k(p.value.tipo_envio.message),3)]),_:1},8,["modelValue","error"])]),s.value.tipo_envio=="whatsapp"||s.value.tipo_envio=="ambas"?(r(),Q("div",Me,[ze,t(d($e),{"default-country":"EC","search-text":"Buscar pais...","onUpdate:modelValue":u[1]||(u[1]=w=>p.value.telefono.isValid=!0),onError:J,error:!p.value.telefono.isValid,filled:"",dense:"",tel:s.value.telefono,"onUpdate:tel":u[2]||(u[2]=w=>s.value.telefono=w)},{error:o(()=>[n("label",{class:N(f.$q.dark.isActive?"text-red-4":"text-negative")},k(p.value.telefono.message),3)]),_:1},8,["error","tel"])])):g("",!0),s.value.tipo_envio=="email"||s.value.tipo_envio=="ambas"?(r(),Q("div",je,[Be,t(W,{type:"email",modelValue:s.value.email,"onUpdate:modelValue":[u[3]||(u[3]=w=>s.value.email=w),u[4]||(u[4]=w=>p.value.email.isValid=!0)],"input-class":"resaltarTextoInput",error:!p.value.email.isValid,"lazy-rules":"",dense:"",filled:""},{error:o(()=>[n("label",{class:N(f.$q.dark.isActive?"text-red-4":"text-negative")},k(p.value.email.message),3)]),_:1},8,["modelValue","error"])])):g("",!0),n("div",Ze,[t(E,{label:"Enviar",onClick:B,loading:R.value,class:"q-px-xl q-mt-md q-mb-md",outline:"",rounded:"",style:{color:"#696cff"}},null,8,["loading"])])])]),_:1})]),_:1}))}};const We={class:"q-mx-lg q-pt-md"},Ge={class:"row q-col-gutter-lg"},Je={style:{display:"flex"}},Ye={class:"col-xs-12 col-sm-3"},Xe={class:"q-mr-sm row q-pt-sm justify-center"},Ke={class:"col-xs-10 col-sm-4"},el={class:"row items-center justify-end"},ll={class:"col-xs-12 col-sm-1 flex flex-center"},al={class:"col-xs-10 col-sm-4"},ol={class:"row items-center justify-end"},tl={key:0,class:"flex flex-center"},sl={class:"col-12 q-pt-none"},nl={key:0,class:"text-center row justify-center",style:{width:"100%"}},rl=n("label",{class:"q-mb-sm text-grey-7 text-h6"}," Listado de Comprobantes ",-1),il=[rl],ul=n("label",{class:"q-mr-sm row items-center"},[n("span",null,"Tipo: ")],-1),dl=n("label",{class:"q-mr-sm row items-center"},[n("span",null,"Por Sucursal: ")],-1),cl=n("div",{class:"full-width row flex-center text-lime-10 q-gutter-sm"},[n("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun resultado ")],-1),Ul={__name:"IndexPage",setup(G){let x;const{api:C,claim:_,route:O}=me(),i=()=>{const l=new Ae("https://facturacion.rednuevaconexion.net/socket.io/socket.io.js",{extraHeaders:{autentication:_.id}});x==null||x.removeAllListeners(),x=l.socket("/"),x.on("updateStateInvoice",async()=>{await A()})},y=[{name:"acciones",label:"acciones",align:"center"},{name:"sucursal",label:"Sucursal",align:"center"},{name:"num_comprobante",label:"Num. Comprobante",field:"numero_comprobante",align:"center"},{name:"usuario",label:"Usuario",align:"center"},{name:"cliente",label:"Cliente",align:"center"},{name:"f/h",label:"Fecha/Hora",align:"center",field:"created_at"},{name:"total",label:"Total",name:"total",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"}],R=v(""),s=v(""),j=v([]),Z=v(),p=v(!1),B=v(!1),{generarExcel:J}=Ue(),f=async(l,a)=>{l.company_name=l.sucursal_id.company_id.nombre_comercial,l.ruc=l.sucursal_id.company_id.ruc,l.direccion=l.sucursal_id.direccion;const e={cliente:l.customer_id.nombres,tipoDoc:l.customer_id.tipo_documento,num_doc:l.customer_id.numero_documento,email:l.customer_id.email};l.forma_pago=="01"&&(l.forma_pago="SIN UTILIZACION DEL SISTEMA FINANCIERO"),l.forma_pago=="15"&&(l.forma_pago="COMPENSACI\xD3N DE DEUDAS"),l.forma_pago=="16"&&(l.forma_pago="TARJETA DE D\xC9BITO"),l.forma_pago=="17"&&(l.forma_pago="DINERO ELECTR\xD3NICO"),l.forma_pago=="18"&&(l.forma_pago="TARJETA PREPAGO"),l.forma_pago=="19"&&(l.forma_pago="TARJETA DE CR\xC9DITO"),l.forma_pago=="20"&&(l.forma_pago="OTROS CON UTILIZACI\xD3N DEL SISTEMA FINANCIERO"),l.forma_pago=="21"&&(l.forma_pago="ENDOSO DE T\xCDTULOS");const{imprimirFactura:m}=Te();let I=m(l,e,_.fullName,a);var M=window.open("","_blank");M.document.write(I),M.print(),M.close()},u=v("FACTURAS"),w=v(""),ee=v({}),P=v([]),L=v([]),le=v({}),{validarPermisos:Y}=Ne(),b=Ve(),D=v(!1);oe(u,(l,a)=>{A()});const pe=()=>{const{tipo:l,fecha:a}=O.params;l!=""&&(u.value=l),a!=""&&(R.value=a.split(" - ")[0].replace(/-/g,"/"),s.value=a.split(" - ")[1].replace(/-/g,"/"))},A=async(l=1,a=10)=>{try{D.value=!0;let e={tipo:u.value,"company-id":_.company.id,"sucursal-id":L.value,desde:R.value,hasta:s.value};const{data:m}=await C.get("/invoices",{params:{page:l,limit:a,busqueda:w.value},headers:e});q.value.rowsNumber=m.meta.totalItems,m.items.map(I=>{I.created_at=Se.formatDate(I.created_at,"DD/MM/YYYY HH:mm a"),I.loading=!1}),j.value=m.items,D.value=!1}catch(e){console.log(e),D.value=!1}};async function fe(l){const{page:a,rowsPerPage:e,sortBy:m,descending:I}=l.pagination;D.value=!0,await A(a,e),q.value.page=a,q.value.rowsPerPage=e,q.value.sortBy=m,q.value.descending=I,D.value=!1}const ve=async()=>{const{data:l}=await C.post("/invoices/download-comprobantes",{sucursal_id:L.value,desde:R.value,hasta:s.value},{responseType:"arraybuffer"}),a=new Blob([l],{type:"application/zip"}),e=document.createElement("a");e.href=window.URL.createObjectURL(a),e.download="facturas.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)},ge=l=>{b.dialog({title:"<center>\xBFEstas seguro de anular esta factura?</center>",message:`<span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Num Comprobante:
                  </strong>
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${l.numero_comprobante}
                  </label>
                </span>
              <span class='q-my-xs' style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Cliente:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  ${l.customer_id.nombres}
                </label>
              </span>
              <span class='q-my-xs' style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Fecha/Hora:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  ${l.created_at}
                </label>
              </span>
              <span style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Total:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  $${l.total}
                </label>
              </span>`,html:!0,ok:{push:!0,label:"Anular",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{l.loading=!0,await C.post("/CE/facturas/anularFactura",{factura:{...l,entity:"Ventas",tipo_comprobante:"nota_credito"}}),l.loading=!1}catch(a){console.log(a)}})};oe(L,(l,a)=>{A()});const be=async l=>{D.value=!0,P.value=[];const{data:a}=await C.get(`/sucursal/find/${l}/company`);(_.roles[0]=="SUPER-ADMINISTRADOR"||_.roles[0]=="ADMINISTRADOR")&&P.value.unshift({label:"TODOS",value:null}),a.forEach(e=>{P.value.push({label:e.nombre,value:e.id})}),P.value.length!=0&&(L.value=P.value[0].value)},_e=async l=>{l.loading=!0;let a="",e="";l.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION"||l.estadoSRI.trim()=="ANULACION - RECIBIDA"?(a="factura",e=l.clave_acceso):(a="nota_credito",e=l.clave_acceso_nota_credito);const m=l.invoiceToProduct.map(T=>({aplicaIva:T.product_id.aplicaIva,cantidad:T.cantidad,pvp:parseFloat(T.v_total)/T.cantidad,descuento:T.product_id.descuento,nombre:T.product_id.nombre,codigoBarra:T.product_id.codigoBarra}));let I={headers:{"sucursal-id":l.sucursal_id.id}},M={ambiente:l.sucursal_id.ambiente,clave_acceso:e,company_name:_.company.nombre_comercial,sucursal_id:l.sucursal_id.id,customer_id:l.customer_id.id,descripcion:l.descripcion,num_comprobante:l.numero_comprobante,tipo:"EMISION",subtotal:parseFloat(l.subtotal),iva:parseFloat(l.iva),descuento:parseFloat(l.descuento),total:parseFloat(l.total),entity:"Ventas",tipo_comprobante:a,pago_id:l.id,user_id:l.user_id.id,porcentaje_iva:l.porcentaje_iva,forma_pago:l.forma_pago,products:m};(l.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||l.estadoSRI.trim()=="ERROR ENVIO RECEPCION - ANULACION")&&await C.post("/CE/facturas/recepcionComprobantesOffline",M,I),(l.estadoSRI.trim()=="RECIBIDA"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION - ANULACION")&&await C.post("/CE/facturas/autorizacionComprobantesOffline",M,I)};i(),pe();const S=v("list"),q=v({sortBy:"desc",descending:!1,page:1,rowsPerPage:10,rowsNumber:15});return Re(async()=>{(_.roles[0]=="SUPER-ADMINISTRADOR"||_.roles[0]=="ADMINISTRADOR")&&await be(_.company.id),Z.value.requestServerInteraction()}),(l,a)=>(r(),Q(se,null,[n("div",We,[n("div",Ge,[n("div",Je,[n("div",{style:{display:"flex"},class:N([d(b).screen.xs?"q-mb-md q-mt-none q-pt-xs":"q-ml-lg q-pl-none q-my-md"])},[n("div",{class:N(["row",[d(b).screen.xs?"flex-center":""]])},[n("div",Ye,[n("label",Xe,[n("span",{class:N([d(b).screen.xs?"text-weight-bold":""])}," Filtrar por fecha: ",2)])]),n("div",Ke,[t(W,{outlined:"",dense:"",modelValue:R.value,"onUpdate:modelValue":a[3]||(a[3]=e=>R.value=e),mask:"date"},{append:o(()=>[R.value!==""?(r(),c(V,{key:0,name:"close",onClick:a[0]||(a[0]=e=>(R.value="",A(l.page=1,l.limit=10))),class:"cursor-pointer"})):g("",!0),t(V,{name:"event",class:"cursor-pointer"},{default:o(()=>[t(re,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[t(ne,{modelValue:R.value,"onUpdate:modelValue":[a[1]||(a[1]=e=>R.value=e),a[2]||(a[2]=e=>A(l.page=1,l.limit=10))]},{default:o(()=>[n("div",el,[U(t(E,{label:"Close",color:"primary",flat:""},null,512),[[F]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",ll,[n("label",{class:N(["q-mx-md",[d(b).screen.xs?"text-weight-medium":""]])}," Hasta ",2)]),n("div",al,[t(W,{outlined:"",dense:"",modelValue:s.value,"onUpdate:modelValue":a[8]||(a[8]=e=>s.value=e),mask:"date"},{append:o(()=>[s.value!==""?(r(),c(V,{key:0,name:"close",onClick:a[4]||(a[4]=e=>(s.value="",A(l.page=1,l.limit=10))),class:"cursor-pointer"})):g("",!0),t(V,{name:"event",class:"cursor-pointer"},{default:o(()=>[t(re,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[t(ne,{modelValue:s.value,"onUpdate:modelValue":[a[6]||(a[6]=e=>s.value=e),a[7]||(a[7]=e=>A(l.page=1,l.limit=10))]},{default:o(()=>[n("div",ol,[U(t(E,{onClick:a[5]||(a[5]=e=>A(l.page=1,l.limit=10)),label:"Close",color:"primary",flat:""},null,512),[[F]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])],2)],2),d(b).screen.width>=935?(r(),Q("div",tl,[t(he,{class:"q-ml-md",label:"Descargar Documento",outline:"",color:"primary",icon:"download"},{default:o(()=>[t(Ie,null,{default:o(()=>[U((r(),c(de,{clickable:"",onClick:ve},{default:o(()=>[t(ie,null,{default:o(()=>[t(ue,null,{default:o(()=>[h("Descargar Facturas")]),_:1})]),_:1})]),_:1})),[[F]]),U((r(),c(de,{onClick:a[9]||(a[9]=e=>d(J)(j.value)),clickable:""},{default:o(()=>[t(ie,null,{default:o(()=>[t(ue,null,{default:o(()=>[h("Descargar EXCEL")]),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),_:1})])):g("",!0)]),n("div",sl,[t(ce,{flat:"",class:"shadow_custom"},{default:o(()=>[t(Oe,{"title-class":"text-grey-7 text-h6","hide-header":S.value==="grid",loading:D.value,columns:y,"row-key":"name",grid:S.value==="grid",rows:j.value,filter:w.value,pagination:q.value,"onUpdate:pagination":a[15]||(a[15]=e=>q.value=e),"rows-per-page-options":[10,15,20,0],ref_key:"tableRef",ref:Z,"binary-state-sort":"",onRequest:fe},{loading:o(()=>[t(Ce,{showing:"",color:"primary"})]),header:o(e=>[t(ke,{props:e,style:{height:"60px"}},{default:o(()=>[(r(!0),Q(se,null,we(e.cols,m=>(r(),c(Ee,{key:m.name,props:e,class:"text-grey-7 text-weight-bold text-uppercase",style:{"font-size":"13px"}},{default:o(()=>[h(k(m.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"top-left":o(e=>[d(b).screen.xs?(r(),Q("div",nl,il)):g("",!0),n("div",{style:X([{display:"flex"},!d(b).screen.xs||"width: 100%;justify-content: center;position: relative;right: 8px;"]),class:N([d(b).screen.xs?"q-mb-md":""])},[ul,t(K,{outlined:"",dense:"",modelValue:u.value,"onUpdate:modelValue":a[10]||(a[10]=m=>u.value=m),"emit-value":"","map-options":"",options:[{label:"Todos",value:"FACTURAS"},{label:"Facturas Anuladas",value:"ANULADO"},{label:"Facturas Autorizadas",value:"AUTORIZADO"}]},null,8,["modelValue"])],6),d(_).roles[0]=="SUPER-ADMINISTRADOR"||d(_).roles[0]=="ADMINISTRADOR"?(r(),Q("div",{key:1,style:X([!d(b).screen.xs||"width: 100%;justify-content: center;",{display:"flex"}]),class:N([d(b).screen.xs?"q-mb-md":"q-ml-lg"])},[dl,t(K,{outlined:"",dense:"",modelValue:L.value,"onUpdate:modelValue":a[11]||(a[11]=m=>L.value=m),"emit-value":"","map-options":"",options:P.value},null,8,["modelValue","options"])],6)):g("",!0)]),"top-right":o(e=>[d(b).screen.width>=1023&&d(Y)("crear.venta")?(r(),c(E,{key:0,onClick:a[12]||(a[12]=m=>l.$router.push("/ventas/add")),outline:"",color:"primary",label:"Agregar Factura",class:"q-mr-xs"})):g("",!0),t(W,{style:X(d(b).screen.width>700||"width: 70%"),outlined:"",dense:"",debounce:"800",modelValue:w.value,"onUpdate:modelValue":a[13]||(a[13]=m=>w.value=m),modelModifiers:{trim:!0},placeholder:"Buscar..."},{append:o(()=>[t(V,{name:"search"})]),_:1},8,["style","modelValue"]),S.value==="list"?(r(),c(E,{key:1,flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen},{default:o(()=>[U((r(),c($,{disable:d(b).platform.is.mobile},{default:o(()=>[h(k(e.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"),1)]),_:2},1032,["disable"])),[[F]])]),_:2},1032,["icon","onClick"])):g("",!0),e.inFullscreen?g("",!0):(r(),c(E,{key:2,flat:"",round:"",dense:"",icon:S.value==="grid"?"list":"grid_on",onClick:a[14]||(a[14]=m=>{S.value=S.value==="grid"?"list":"grid",l.separator=S.value==="grid"?"none":"horizontal"})},{default:o(()=>[U((r(),c($,{disable:d(b).platform.is.mobile},{default:o(()=>[h(k(S.value==="grid"?"List":"Grid"),1)]),_:1},8,["disable"])),[[F]])]),_:1},8,["icon"]))]),"body-cell-total":o(e=>[t(z,{props:e},{default:o(()=>[h(" $"+k(e.row.total),1)]),_:2},1032,["props"])]),"body-cell-cliente":o(e=>[t(z,{props:e},{default:o(()=>[h(k(e.row.customer_id.nombres),1)]),_:2},1032,["props"])]),"body-cell-sucursal":o(e=>[t(z,{props:e},{default:o(()=>[h(k(e.row.sucursal_id.nombre),1)]),_:2},1032,["props"])]),"body-cell-usuario":o(e=>[t(z,{props:e},{default:o(()=>[h(k(e.row.user_id.fullName.toUpperCase()),1)]),_:2},1032,["props"])]),"body-cell-estado":o(e=>[t(z,{props:e},{default:o(()=>[e.row.estadoSRI=="NO AUTORIZADO"||e.row.estadoSRI.trim()=="DEVUELTA"?(r(),c(H,{key:0,outline:"",class:"q-py-xs q-px-md",color:d(b).dark.isActive?"warning":"orange-10",label:e.row.estadoSRI},{default:o(()=>[t($,{anchor:"center left",self:"center right",offset:[10,10],class:"blue-grey-9 text-subtitle2"},{default:o(()=>[h(k(e.row.respuestaSRI),1)]),_:2},1024)]),_:2},1032,["color","label"])):e.row.estadoSRI=="AUTORIZADO"?(r(),c(H,{key:1,outline:"",class:"q-py-xs q-px-md",color:"secondary",label:e.row.estadoSRI},null,8,["label"])):e.row.estadoSRI=="ANULADO"?(r(),c(H,{key:2,outline:"",class:"q-py-xs q-px-md",color:"red-4",label:e.row.estadoSRI},null,8,["label"])):(r(),c(H,{key:3,outline:"",class:"q-py-xs q-px-md",color:d(b).dark.isActive?"blue-grey-3":"blue-grey-7",label:e.row.estadoSRI},{default:o(()=>[t($,{anchor:"center left",self:"center right",offset:[10,10],class:"blue-grey-9 text-subtitle2"},{default:o(()=>[h(k(e.row.respuestaSRI),1)]),_:2},1024)]),_:2},1032,["color","label"]))]),_:2},1032,["props"])]),"body-cell-acciones":o(e=>[t(z,{props:e},{default:o(()=>{var m;return[e.row.estadoSRI.trim()==="ERROR ENVIO RECEPCION"||e.row.estadoSRI.trim()==="ERROR ENVIO RECEPCION - ANULACION"||e.row.estadoSRI.trim()==="ERROR ENVIO AUTORIZACION"||e.row.estadoSRI.trim()==="ERROR ENVIO AUTORIZACION - ANULACION"?(r(),c(E,{key:0,round:"",color:"deep-orange-8",icon:"fa-solid fa-retweet",loading:e.row.loading,onClick:I=>_e(e.row),size:"10px",class:"q-mr-sm"},{default:o(()=>[t($,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:o(()=>[h(" Reenviar Factura Electr\xF3nica ")]),_:1})]),_:2},1032,["loading","onClick"])):g("",!0),e.row.estadoSRI.trim()!=="PROFORMA"?(r(),c(E,{key:1,round:"",color:"blue-grey",icon:"print",onClick:I=>f(e.row,"factura"),size:"10px",class:"q-mr-sm"},{default:o(()=>[t($,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:o(()=>[h(" Imprimir comprobante ")]),_:1})]),_:2},1032,["onClick"])):g("",!0),t(E,{round:"",color:"blue-grey",icon:"visibility",size:"10px",class:"q-mr-sm",onClick:I=>(B.value=!0,ee.value={...e.row})},null,8,["onClick"]),e.row.estadoSRI=="PROFORMA"||e.row.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||e.row.estadoSRI.trim()=="ERROR ENVIO RECEPCION - ANULACION"||e.row.estadoSRI.trim()=="PENDIENTE"?(r(),c(E,{key:2,onClick:I=>l.$router.push(`ventas/add/${e.row.id}`),round:"",color:"blue-grey",icon:"description",size:"10px",class:"q-mr-sm"},null,8,["onClick"])):g("",!0),e.row.customer_id.nombres!=="CONSUMIDOR FINAL"&&(e.row.estadoSRI=="AUTORIZADO"||((m=e.row.respuestaSRI)==null?void 0:m.includes("ERROR SECUENCIAL REGISTRADO")))&&d(Y)("anular.venta")?(r(),c(E,{key:3,round:"",color:"blue-grey",class:"q-mr-sm",onClick:I=>ge(e.row),loading:e.row.loading,icon:"close",size:"10px"},null,8,["onClick","loading"])):g("",!0),e.row.estadoSRI=="AUTORIZADO"||e.row.estadoSRI=="PROFORMA"?(r(),c(E,{key:4,round:"",color:"blue-grey",onClick:I=>(p.value=!0,le.value=e.row),icon:"forward_to_inbox",size:"11px"},{default:o(()=>[t($,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:o(()=>[h(" Enviar comprobante por email ")]),_:1})]),_:2},1032,["onClick"])):g("",!0)]}),_:2},1032,["props"])]),"no-data":o(({icon:e})=>[cl]),_:1},8,["hide-header","loading","grid","rows","filter","pagination"])]),_:1})])])]),d(b).screen.width<=1023&&d(Y)("crear.venta")?(r(),c(xe,{key:0,position:"bottom-right",offset:[18,18]},{default:o(()=>[t(E,{round:"",color:"secondary",size:"lg",icon:"add",onClick:a[16]||(a[16]=e=>l.$router.push("/ventas/add"))})]),_:1})):g("",!0),t(te,{modelValue:B.value,"onUpdate:modelValue":a[17]||(a[17]=e=>B.value=e)},{default:o(()=>[t(qe,{detalleData:ee.value},null,8,["detalleData"])]),_:1},8,["modelValue"]),t(te,{modelValue:p.value,"onUpdate:modelValue":a[19]||(a[19]=e=>p.value=e)},{default:o(()=>[t(He,{onCloseModal:a[18]||(a[18]=e=>p.value=!1),detalleFactura:le.value},null,8,["detalleFactura"])]),_:1},8,["modelValue"])],64))}};export{Ul as default};
