import{d as pe,r as c,o as i,c as S,f as o,g as a,Q as L,h as _,e as r,i as V,O as F,a9 as d,aV as oe,aa as h,ah as fe,af as f,ae as k,ab as x,ad as n,aU as re,v as W,ba as te,aj as se,ai as ve,bc as K}from"./index.b06266f8.js";import{Q as H}from"./QDate.a89f6deb.js";import{Q as Y}from"./QPopupProxy.ccb7c6f3.js";import{Q as _e}from"./QInnerLoading.30729cec.js";import{Q as ge,a as be}from"./QTable.df421c74.js";import{Q as ye,a as q}from"./QTooltip.91751e8e.js";import{Q as X}from"./QSelect.13f7c12a.js";import{Q}from"./QTd.f67bd005.js";import{Q as B}from"./QBadge.a4a1953d.js";import{Q as we}from"./QPageSticky.c268877c.js";import{C as D}from"./ClosePopup.7ee02aea.js";import{M as Re}from"./index.2065a85c.js";import{u as Ie}from"./useRolPermisos.535e99b6.js";import{u as ee}from"./useHelpers.0f2d5882.js";import{d as he}from"./date.ffd63b3d.js";import{u as xe,a as Ce}from"./use-quasar.cc618dc1.js";import{_ as Ee}from"./DetalleProducts.2937c37a.js";import{a as Oe}from"./axios.6714b63a.js";import{u as Ve}from"./useImpresion.4d2c76f5.js";import{e as Ae}from"./vue3-q-tel-input.esm.16945598.js";import"./format.96727fdf.js";import"./QList.07058183.js";import"./QBtnDropdown.36059d03.js";import"./QBtnGroup.05e672fa.js";const ke={class:"col-md-9 col-sm-8 flex items-center"},Ne=r("label",null,"Filtrar Por:",-1),Se={class:"row items-center justify-end"},qe=r("label",{class:"q-mx-md"},"HASTA:",-1),Fe={class:"row items-center justify-end"};pe({__name:"FiltrarVentas",props:{formFiltrarVentas:{}},setup(Z){const g=Z;xe(),c([]);const R=c(!1),{mostrarNotify:I}=ee();console.log(g.formFiltrarVentas);const T=async()=>{if(g.formFiltrarVentas.desde!=""&&g.formFiltrarVentas.hasta==""||g.formFiltrarVentas.desde==""&&g.formFiltrarVentas.hasta!="")return I("warning","Completa los campos de fecha de busqueda");if(g.formFiltrarVentas.desde>g.formFiltrarVentas.hasta)return I("warning","Error en el rango de fecha de busqueda");R.value=!0;try{const{data:v}=await Oe.post("/ventas/consulta",g.formFiltrarVentas)}catch(v){console.log(v)}R.value=!1},A={days:"Domingo_Lunes_Martes_Mi\xE9rcoles_Jueves_Viernes_S\xE1bado".split("_"),daysShort:"Dom_Lun_Mar_Mi\xE9_Jue_Vie_S\xE1b".split("_"),months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:"Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_"),firstDayOfWeek:1,format24h:!0,pluralDay:"dias"};return(v,s)=>(i(),S("div",ke,[Ne,o(L,{class:"q-ml-md",style:{width:"20%"},filled:"",modelValue:v.formFiltrarVentas.desde,"onUpdate:modelValue":s[1]||(s[1]=m=>v.formFiltrarVentas.desde=m),dense:"",mask:"date",clearable:"","clear-icon":"close"},{append:a(()=>[o(V,{name:"event",class:"cursor-pointer"},{default:a(()=>[o(Y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[o(H,{modelValue:v.formFiltrarVentas.desde,"onUpdate:modelValue":s[0]||(s[0]=m=>v.formFiltrarVentas.desde=m),locale:A},{default:a(()=>[r("div",Se,[F(o(_,{label:"Cerrar",color:"primary",flat:""},null,512),[[D]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),qe,o(L,{filled:"",style:{width:"20%"},modelValue:v.formFiltrarVentas.hasta,"onUpdate:modelValue":s[3]||(s[3]=m=>v.formFiltrarVentas.hasta=m),dense:"",mask:"date",clearable:"","clear-icon":"close"},{append:a(()=>[o(V,{name:"event",class:"cursor-pointer"},{default:a(()=>[o(Y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[o(H,{modelValue:v.formFiltrarVentas.hasta,"onUpdate:modelValue":s[2]||(s[2]=m=>v.formFiltrarVentas.hasta=m),locale:A},{default:a(()=>[r("div",Fe,[F(o(_,{label:"Cerrar",color:"primary",flat:""},null,512),[[D]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(_,{round:"",color:"black",icon:"search",loading:R.value,class:"q-ml-md",onClick:T},null,8,["loading"])]))}});const De={class:"text-h6 text-center"},Te={class:"row flex flex-center"},Ue={class:"col-xs-11 col-sm-9 text-center q-mt-md q-mb-lg"},$e=r("label",null,"Enviar por:",-1),Me={key:0,class:"col-xs-11 col-sm-9 text-center q-mb-md"},Pe=r("label",null,"Celular del cliente:",-1),Qe={key:1,class:"col-xs-11 col-sm-9 text-center"},Le=r("label",null,"Email del cliente:",-1),ze={class:"col-xs-9 col-md-12 flex justify-center q-ml-none"},je={__name:"ModalReenviarComproantes",props:["detalleFactura"],emits:["closeModal"],setup(Z,{emit:g}){const R=Z,{api:I,mostrarNotify:T}=ee(),A=c(!1),v=c(!1),s=c({tipo_envio:"",telefono:"",email:""});s.value.telefono=R.detalleFactura.customer_id.celular,s.value.email=R.detalleFactura.customer_id.email;const m=()=>{A.value=!1;const C=/^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/;let u=[];return s.value.tipo_envio=="whatsapp"&&u.push("telefono"),s.value.tipo_envio=="email"&&u.push("email"),s.value.tipo_envio=="ambas"&&(u=["telefono","email"]),s.value.tipo_envio==""&&(u=["tipo_envio"]),s.value.email.length>5&&!C.test(s.value.email)&&(b.value.email.message="Ingresa un email valido",b.value.email.isValid=!1,A.value=!0),u.forEach(w=>{s.value[w].length==0&&(b.value[w].message="Debes completar este campo",b.value[w].isValid=!1,A.value=!0)}),A.value},b=c({telefono:{message:"",isValid:!0},tipo_envio:{message:"",isValid:!0},email:{message:"",isValid:!0}}),U=async()=>{if(!m()&&!((s.value.tipo_envio=="whatsapp"||s.value.tipo_envio=="ambas")&&!b.value.telefono.isValid))try{v.value=!0,await I.post("/CE/facturas/reenviar-comprobantes",{...s.value,factura:R.detalleFactura}),T("positive","Comprobantes enviados"),g("closeModal"),v.value=!1}catch(C){v.value=!1,T("warning",C.response.data.message),g("closeModal")}},z=C=>{b.value.telefono.isValid=!C};return(C,u)=>(i(),d(re,{style:{width:"400px","max-width":"80vw"}},{default:a(()=>[o(oe,null,{default:a(()=>[r("div",De,[h(" Enviar Comprobantes "),F(o(_,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[D]])])]),_:1}),o(fe,{inset:""}),o(oe,{class:"q-pt-none"},{default:a(()=>[r("div",Te,[r("div",Ue,[$e,o(X,{filled:"",dense:"",modelValue:s.value.tipo_envio,"onUpdate:modelValue":u[0]||(u[0]=w=>s.value.tipo_envio=w),error:!b.value.tipo_envio.isValid,"emit-value":"","map-options":"",options:[{label:"WhatsApp",value:"whatsapp"},{label:"Email",value:"email"},{label:"Ambas",value:"ambas"}]},{append:a(()=>[s.value.tipo_envio.length!=0&&s.value.tipo_envio=="whatsapp"?(i(),d(V,{key:0,name:"fa-brands fa-whatsapp",color:"teal-7"})):f("",!0),s.value.tipo_envio.length!=0&&s.value.tipo_envio=="email"?(i(),d(V,{key:1,name:"mail",color:"indigo-5"})):f("",!0),s.value.tipo_envio.length!=0&&s.value.tipo_envio=="ambas"?(i(),d(V,{key:2,name:"fa-solid fa-list-check",color:"deep-orange-4"})):f("",!0)]),error:a(()=>[r("label",{class:k(C.$q.dark.isActive?"text-red-4":"text-negative")},x(b.value.tipo_envio.message),3)]),_:1},8,["modelValue","error"])]),s.value.tipo_envio=="whatsapp"||s.value.tipo_envio=="ambas"?(i(),S("div",Me,[Pe,o(n(Ae),{"default-country":"EC","search-text":"Buscar pais...","onUpdate:modelValue":u[1]||(u[1]=w=>b.value.telefono.isValid=!0),onError:z,error:!b.value.telefono.isValid,filled:"",dense:"",tel:s.value.telefono,"onUpdate:tel":u[2]||(u[2]=w=>s.value.telefono=w)},{error:a(()=>[r("label",{class:k(C.$q.dark.isActive?"text-red-4":"text-negative")},x(b.value.telefono.message),3)]),_:1},8,["error","tel"])])):f("",!0),s.value.tipo_envio=="email"||s.value.tipo_envio=="ambas"?(i(),S("div",Qe,[Le,o(L,{type:"email",modelValue:s.value.email,"onUpdate:modelValue":[u[3]||(u[3]=w=>s.value.email=w),u[4]||(u[4]=w=>b.value.email.isValid=!0)],"input-class":"resaltarTextoInput",error:!b.value.email.isValid,"lazy-rules":"",dense:"",filled:""},{error:a(()=>[r("label",{class:k(C.$q.dark.isActive?"text-red-4":"text-negative")},x(b.value.email.message),3)]),_:1},8,["modelValue","error"])])):f("",!0),r("div",ze,[o(_,{label:"Enviar",onClick:U,loading:v.value,class:"q-px-xl q-mt-md q-mb-md",outline:"",rounded:"",style:{color:"#696cff"}},null,8,["loading"])])])]),_:1})]),_:1}))}};const Be={class:"q-mx-lg q-pt-md"},Ze={class:"row q-col-gutter-lg"},Je={style:{display:"flex"}},He={class:"col-xs-12 col-sm-3"},Ye={class:"q-mr-sm row q-pt-sm justify-center"},Ge={class:"col-xs-10 col-sm-4"},We={class:"row items-center justify-end"},Ke={class:"col-xs-12 col-sm-1 flex flex-center"},Xe={class:"col-xs-10 col-sm-4"},el={class:"row items-center justify-end"},ll={key:0,class:"flex flex-center"},al={class:"col-12 q-pt-none"},ol={key:0,class:"text-center row justify-center",style:{width:"100%"}},tl=r("label",{class:"q-mb-sm text-grey-7 text-h6"}," Listado de Comprobantes ",-1),sl=[tl],rl=r("label",{class:"q-mr-sm row items-center"},[r("span",null,"Tipo: ")],-1),il=r("label",{class:"q-mr-sm row items-center"},[r("span",null,"Por Sucursal: ")],-1),nl=r("div",{class:"full-width row flex-center text-lime-10 q-gutter-sm"},[r("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun resultado ")],-1),ql={__name:"IndexPage",setup(Z){let g;const{api:R,claim:I,route:T}=ee(),A=l=>{const t=new Re("http://205.235.6.149:3000/socket.io/socket.io.js",{extraHeaders:{autentication:I.id}});g==null||g.removeAllListeners(),g=t.socket("/"),g.on("updateStateInvoice",async()=>{await E()})},v=[{name:"acciones",label:"acciones",align:"center"},{name:"sucursal",label:"Sucursal",align:"center"},{name:"num_comprobante",label:"Num. Comprobante",field:"numero_comprobante",align:"center"},{name:"usuario",label:"Usuario",align:"center"},{name:"cliente",label:"Cliente",align:"center"},{name:"f/h",label:"Fecha/Hora",align:"center",field:"created_at"},{name:"total",label:"Total",name:"total",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"}],s=c(""),m=c(""),b=c([]),U=c(!1),z=c(!1);c({desde:"",hasta:"",pv_id:""});const C=async(l,t)=>{l.company_name=l.sucursal_id.company_id.nombre_comercial,l.ruc=l.sucursal_id.company_id.ruc,l.direccion=l.sucursal_id.direccion;const e={cliente:l.customer_id.nombres,tipoDoc:l.customer_id.tipo_documento,num_doc:l.customer_id.numero_documento,email:l.customer_id.email};l.forma_pago=="01"&&(l.forma_pago="SIN UTILIZACION DEL SISTEMA FINANCIERO"),l.forma_pago=="15"&&(l.forma_pago="COMPENSACI\xD3N DE DEUDAS"),l.forma_pago=="16"&&(l.forma_pago="TARJETA DE D\xC9BITO"),l.forma_pago=="17"&&(l.forma_pago="DINERO ELECTR\xD3NICO"),l.forma_pago=="18"&&(l.forma_pago="TARJETA PREPAGO"),l.forma_pago=="19"&&(l.forma_pago="TARJETA DE CR\xC9DITO"),l.forma_pago=="20"&&(l.forma_pago="OTROS CON UTILIZACI\xD3N DEL SISTEMA FINANCIERO"),l.forma_pago=="21"&&(l.forma_pago="ENDOSO DE T\xCDTULOS");const{imprimirFactura:y}=Ve();let O=y(l,e,I.fullName,t);var M=window.open("","_blank");M.document.write(O),M.print(),M.close()},u=c("Todos"),w=c(""),le=c({}),j=c([]),$=c([]),ae=c({}),{validarPermisos:G}=Ie(),p=Ce(),J=c(!1);W(u,(l,t)=>{E()});const ie=()=>{const{tipo:l,fecha:t}=T.params;l!=""&&(u.value=l),t!=""&&(s.value=t.split(" - ")[0].replace(/-/g,"/"),m.value=t.split(" - ")[1].replace(/-/g,"/"))},E=async()=>{try{J.value=!0;let l={headers:{tipo:u.value,"sucursal-id":$.value,desde:s.value,hasta:m.value}};const{data:t}=await R.get("/invoices",l);t.map(e=>{e.created_at=he.formatDate(e.created_at,"DD/MM/YYYY HH:mm a"),e.loading=!1}),b.value=t,J.value=!1}catch(l){console.log(l),J.value=!1}},ne=async()=>{const{data:l}=await R.post("/invoices/download-comprobantes",{sucursal_id:$.value,desde:s.value,hasta:m.value},{responseType:"arraybuffer"}),t=new Blob([l],{type:"application/zip"}),e=document.createElement("a");e.href=window.URL.createObjectURL(t),e.download="facturas.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)},de=l=>{p.dialog({title:"<center>\xBFEstas seguro de anular esta factura?</center>",message:`<span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Num Comprobante:
                  </strong>
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${l.numero_comprobante}
                  </label>
                </span>
              <span class='q-my-xs' style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Cliente:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  ${l.customer_id.nombres}
                </label>
              </span>
              <span class='q-my-xs' style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Fecha/Hora:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  ${l.created_at}
                </label>
              </span>
              <span style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Total:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  $${l.total}
                </label>
              </span>`,html:!0,ok:{push:!0,label:"Anular",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{l.loading=!0,await R.post("/CE/facturas/anularFactura",{factura:{...l,entity:"Ventas",tipo_comprobante:"nota_credito"}}),l.loading=!1}catch(t){console.log(t)}})};W($,(l,t)=>{E()});const ue=async l=>{j.value=[];const{data:t}=await R.get(`/sucursal/find/${l}/company`);t.forEach(e=>{j.value.push({label:e.nombre,value:e.id})}),j.value.length!=0&&($.value=j.value[0].value),E()},ce=async l=>{l.loading=!0;let t="",e="";l.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION"||l.estadoSRI.trim()=="ANULACION - RECIBIDA"?(t="factura",e=l.clave_acceso):(t="nota_credito",e=l.clave_acceso_nota_credito);const y=l.invoiceToProduct.map(P=>({aplicaIva:P.product_id.aplicaIva,cantidad:P.cantidad,pvp:P.product_id.pvp,descuento:P.product_id.descuento,nombre:P.product_id.nombre,codigoBarra:P.product_id.codigoBarra}));let O={headers:{"sucursal-id":l.sucursal_id.id}},M={ambiente:l.sucursal_id.ambiente,clave_acceso:e,company_name:I.company.nombre_comercial,sucursal_id:l.sucursal_id.id,customer_id:l.customer_id.id,descripcion:l.descripcion,num_comprobante:l.numero_comprobante,tipo:"EMISION",subtotal:parseFloat(l.subtotal),iva:parseFloat(l.iva),descuento:parseFloat(l.descuento),total:parseFloat(l.total),entity:"Ventas",tipo_comprobante:t,pago_id:l.id,user_id:l.user_id.id,porcentaje_iva:l.porcentaje_iva,forma_pago:l.forma_pago,products:y};(l.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||l.estadoSRI.trim()=="ERROR ENVIO RECEPCION - ANULACION")&&await R.post("/CE/facturas/recepcionComprobantesOffline",M,O),(l.estadoSRI.trim()=="RECIBIDA"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION - ANULACION")&&await R.post("/CE/facturas/autorizacionComprobantesOffline",M,O)};A(),W(w,(l,t)=>{E()}),I.roles[0]=="SUPER-ADMINISTRADOR"||I.roles[0]=="ADMINISTRADOR"?ue(I.company.id):E(),ie();const N=c("list"),me=c({rowsPerPage:10});return(l,t)=>(i(),S(se,null,[r("div",Be,[r("div",Ze,[r("div",Je,[r("div",{style:{display:"flex"},class:k([n(p).screen.xs?"q-mb-md q-mt-none q-pt-xs":"q-ml-lg q-pl-none q-my-md"])},[r("div",{class:k(["row",[n(p).screen.xs?"flex-center":""]])},[r("div",He,[r("label",Ye,[r("span",{class:k([n(p).screen.xs?"text-weight-bold":""])}," Filtrar por fecha: ",2)])]),r("div",Ge,[o(L,{outlined:"",dense:"",modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=e=>s.value=e),mask:"date"},{append:a(()=>[s.value!==""?(i(),d(V,{key:0,name:"close",onClick:t[0]||(t[0]=e=>(s.value="",E())),class:"cursor-pointer"})):f("",!0),o(V,{name:"event",class:"cursor-pointer"},{default:a(()=>[o(Y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[o(H,{modelValue:s.value,"onUpdate:modelValue":[t[1]||(t[1]=e=>s.value=e),E]},{default:a(()=>[r("div",We,[F(o(_,{label:"Close",color:"primary",flat:""},null,512),[[D]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),r("div",Ke,[r("label",{class:k(["q-mx-md",[n(p).screen.xs?"text-weight-medium":""]])}," Hasta ",2)]),r("div",Xe,[o(L,{outlined:"",dense:"",modelValue:m.value,"onUpdate:modelValue":t[5]||(t[5]=e=>m.value=e),mask:"date"},{append:a(()=>[m.value!==""?(i(),d(V,{key:0,name:"close",onClick:t[3]||(t[3]=e=>(m.value="",E())),class:"cursor-pointer"})):f("",!0),o(V,{name:"event",class:"cursor-pointer"},{default:a(()=>[o(Y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[o(H,{modelValue:m.value,"onUpdate:modelValue":[t[4]||(t[4]=e=>m.value=e),E]},{default:a(()=>[r("div",el,[F(o(_,{onClick:E,label:"Close",color:"primary",flat:""},null,512),[[D]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])],2)],2),n(p).screen.width>=935?(i(),S("div",ll,[o(_,{onClick:ne,class:"q-ml-lg q-px-sm",dense:"",outline:"",color:"primary","icon-right":"picture_as_pdf",style:{"margin-top":"2px"},label:"descargar facturas"})])):f("",!0)]),r("div",al,[o(re,{flat:"",class:"shadow_custom"},{default:a(()=>[o(ge,{"title-class":"text-grey-7 text-h6",rows:b.value,"hide-header":N.value==="grid",loading:J.value,columns:v,"row-key":"name",grid:N.value==="grid",filter:w.value,pagination:me.value},{loading:a(()=>[o(_e,{showing:"",color:"primary"})]),header:a(e=>[o(ye,{props:e,style:{height:"60px"}},{default:a(()=>[(i(!0),S(se,null,ve(e.cols,y=>(i(),d(be,{key:y.name,props:e,class:"text-grey-7 text-weight-bold text-uppercase",style:{"font-size":"13px"}},{default:a(()=>[h(x(y.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"top-left":a(e=>[n(p).screen.xs?(i(),S("div",ol,sl)):f("",!0),r("div",{style:K([{display:"flex"},!n(p).screen.xs||"width: 100%;justify-content: center;position: relative;right: 8px;"]),class:k([n(p).screen.xs?"q-mb-md":""])},[rl,o(X,{outlined:"",dense:"",modelValue:u.value,"onUpdate:modelValue":t[6]||(t[6]=y=>u.value=y),"emit-value":"","map-options":"",options:[{label:"Todos",value:"TODOS"},{label:"Proformas",value:"PROFORMA"},{label:"Facturas",value:"FACTURAS"},{label:"Facturas Anuladas",value:"ANULADO"},{label:"Facturas Autorizadas",value:"AUTORIZADO"}]},null,8,["modelValue"])],6),n(I).roles[0]=="SUPER-ADMINISTRADOR"||n(I).roles[0]=="ADMINISTRADOR"?(i(),S("div",{key:1,style:K([!n(p).screen.xs||"width: 100%;justify-content: center;",{display:"flex"}]),class:k([n(p).screen.xs?"q-mb-md":"q-ml-lg"])},[il,o(X,{outlined:"",dense:"",modelValue:$.value,"onUpdate:modelValue":t[7]||(t[7]=y=>$.value=y),"emit-value":"","map-options":"",options:j.value},null,8,["modelValue","options"])],6)):f("",!0)]),"top-right":a(e=>[n(p).screen.width>=1023&&n(G)("crear.venta")?(i(),d(_,{key:0,onClick:t[8]||(t[8]=y=>l.$router.push("/ventas/add")),outline:"",color:"primary",label:"Agregar Factura",class:"q-mr-xs"})):f("",!0),o(L,{style:K(n(p).screen.width>700||"width: 70%"),outlined:"",dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":t[9]||(t[9]=y=>w.value=y),placeholder:"Buscar..."},{append:a(()=>[o(V,{name:"search"})]),_:1},8,["style","modelValue"]),N.value==="list"?(i(),d(_,{key:1,flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen},{default:a(()=>[F((i(),d(q,{disable:n(p).platform.is.mobile},{default:a(()=>[h(x(e.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"),1)]),_:2},1032,["disable"])),[[D]])]),_:2},1032,["icon","onClick"])):f("",!0),e.inFullscreen?f("",!0):(i(),d(_,{key:2,flat:"",round:"",dense:"",icon:N.value==="grid"?"list":"grid_on",onClick:t[10]||(t[10]=y=>{N.value=N.value==="grid"?"list":"grid",l.separator=N.value==="grid"?"none":"horizontal"})},{default:a(()=>[F((i(),d(q,{disable:n(p).platform.is.mobile},{default:a(()=>[h(x(N.value==="grid"?"List":"Grid"),1)]),_:1},8,["disable"])),[[D]])]),_:1},8,["icon"]))]),"body-cell-total":a(e=>[o(Q,{props:e},{default:a(()=>[h(" $"+x(e.row.total),1)]),_:2},1032,["props"])]),"body-cell-cliente":a(e=>[o(Q,{props:e},{default:a(()=>[h(x(e.row.customer_id.nombres),1)]),_:2},1032,["props"])]),"body-cell-sucursal":a(e=>[o(Q,{props:e},{default:a(()=>[h(x(e.row.sucursal_id.nombre),1)]),_:2},1032,["props"])]),"body-cell-usuario":a(e=>[o(Q,{props:e},{default:a(()=>[h(x(e.row.user_id.fullName.toUpperCase()),1)]),_:2},1032,["props"])]),"body-cell-estado":a(e=>[o(Q,{props:e},{default:a(()=>[e.row.estadoSRI=="NO AUTORIZADO"||e.row.estadoSRI.trim()=="DEVUELTA"?(i(),d(B,{key:0,outline:"",class:"q-py-xs q-px-md",color:n(p).dark.isActive?"warning":"orange-10",label:e.row.estadoSRI},{default:a(()=>[o(q,{anchor:"center left",self:"center right",offset:[10,10],class:"blue-grey-9 text-subtitle2"},{default:a(()=>[h(x(e.row.respuestaSRI),1)]),_:2},1024)]),_:2},1032,["color","label"])):e.row.estadoSRI=="AUTORIZADO"?(i(),d(B,{key:1,outline:"",class:"q-py-xs q-px-md",color:"secondary",label:e.row.estadoSRI},null,8,["label"])):e.row.estadoSRI=="PROFORMA"?(i(),d(B,{key:2,outline:"",class:"q-py-xs q-px-md",color:n(p).dark.isActive?"blue-grey-3":"blue-grey-7",label:e.row.estadoSRI},null,8,["color","label"])):e.row.estadoSRI=="ANULADO"?(i(),d(B,{key:3,outline:"",class:"q-py-xs q-px-md",color:"red-4",label:e.row.estadoSRI},null,8,["label"])):(i(),d(B,{key:4,outline:"",class:"q-py-xs q-px-md",color:n(p).dark.isActive?"blue-grey-3":"blue-grey-7",label:e.row.estadoSRI},{default:a(()=>[o(q,{anchor:"center left",self:"center right",offset:[10,10],class:"blue-grey-9 text-subtitle2"},{default:a(()=>[h(x(e.row.respuestaSRI),1)]),_:2},1024)]),_:2},1032,["color","label"]))]),_:2},1032,["props"])]),"body-cell-acciones":a(e=>[o(Q,{props:e},{default:a(()=>{var y;return[e.row.estadoSRI.trim()==="ERROR ENVIO RECEPCION"||e.row.estadoSRI.trim()==="ERROR ENVIO RECEPCION - ANULACION"||e.row.estadoSRI.trim()==="ERROR ENVIO AUTORIZACION"||e.row.estadoSRI.trim()==="ERROR ENVIO AUTORIZACION - ANULACION"?(i(),d(_,{key:0,round:"",color:"deep-orange-8",icon:"fa-solid fa-retweet",loading:e.row.loading,onClick:O=>ce(e.row),size:"10px",class:"q-mr-sm"},{default:a(()=>[o(q,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[h(" Reenviar Factura Electr\xF3nica ")]),_:1})]),_:2},1032,["loading","onClick"])):f("",!0),e.row.estadoSRI.trim()!=="PROFORMA"?(i(),d(_,{key:1,round:"",color:"blue-grey",icon:"print",onClick:O=>C(e.row,"factura"),size:"10px",class:"q-mr-sm"},{default:a(()=>[o(q,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[h(" Imprimir comprobante ")]),_:1})]),_:2},1032,["onClick"])):f("",!0),o(_,{round:"",color:"blue-grey",icon:"visibility",size:"10px",class:"q-mr-sm",onClick:O=>(z.value=!0,le.value={...e.row})},null,8,["onClick"]),e.row.estadoSRI=="PROFORMA"||e.row.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||e.row.estadoSRI.trim()=="ERROR ENVIO RECEPCION - ANULACION"||e.row.estadoSRI.trim()=="PENDIENTE"?(i(),d(_,{key:2,onClick:O=>l.$router.push(`ventas/add/${e.row.id}`),round:"",color:"blue-grey",icon:"description",size:"10px",class:"q-mr-sm"},null,8,["onClick"])):f("",!0),e.row.customer_id.nombres!=="CONSUMIDOR FINAL"&&(e.row.estadoSRI=="AUTORIZADO"||((y=e.row.respuestaSRI)==null?void 0:y.includes("ERROR SECUENCIAL REGISTRADO")))&&n(G)("anular.venta")?(i(),d(_,{key:3,round:"",color:"blue-grey",class:"q-mr-sm",onClick:O=>de(e.row),loading:e.row.loading,icon:"close",size:"10px"},null,8,["onClick","loading"])):f("",!0),e.row.estadoSRI=="AUTORIZADO"||e.row.estadoSRI=="PROFORMA"?(i(),d(_,{key:4,round:"",color:"blue-grey",onClick:O=>(U.value=!0,ae.value=e.row),icon:"forward_to_inbox",size:"11px"},{default:a(()=>[o(q,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[h(" Enviar comprobante por email ")]),_:1})]),_:2},1032,["onClick"])):f("",!0)]}),_:2},1032,["props"])]),"no-data":a(({icon:e})=>[nl]),_:1},8,["rows","hide-header","loading","grid","filter","pagination"])]),_:1})])])]),n(p).screen.width<=1023&&n(G)("crear.venta")?(i(),d(we,{key:0,position:"bottom-right",offset:[18,18]},{default:a(()=>[o(_,{round:"",color:"secondary",size:"lg",icon:"add",onClick:t[11]||(t[11]=e=>l.$router.push("/ventas/add"))})]),_:1})):f("",!0),o(te,{modelValue:z.value,"onUpdate:modelValue":t[12]||(t[12]=e=>z.value=e)},{default:a(()=>[o(Ee,{detalleData:le.value},null,8,["detalleData"])]),_:1},8,["modelValue"]),o(te,{modelValue:U.value,"onUpdate:modelValue":t[14]||(t[14]=e=>U.value=e)},{default:a(()=>[o(je,{onCloseModal:t[13]||(t[13]=e=>U.value=!1),detalleFactura:ae.value},null,8,["detalleFactura"])]),_:1},8,["modelValue"])],64))}};export{ql as default};
