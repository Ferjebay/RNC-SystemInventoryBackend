import{aJ as Ne,as as ee,C as Te,aM as Ee,ap as ne,aN as qe,ay as $e,am as ge,aq as he,r as C,n as B,v as ce,z as ze,p as se,aC as Ye,bl as Fe,s as ke,Y as Re,bD as Be,o as I,c as L,e,ac as o,f as g,i as W,a8 as M,g as f,a9 as w,ab as t,ah as ye,h as O,a7 as ie,ad as K,Q as te,N as Qe,w as Xe,aU as Le,aT as Oe}from"./index.5d1f09cd.js";import{g as xe,s as we}from"./touch.3df10340.js";import{d as Ge}from"./QItemLabel.762c223e.js";import{u as Ke,Q as We}from"./QDate.1246deaf.js";import{Q as A}from"./QSelect.c4dd2bd4.js";import{Q as He}from"./QChip.b975933a.js";import{Q as oe}from"./QBadge.830994ce.js";import{u as be}from"./useCliente.cbd82333.js";import{u as Je}from"./useHelpers.087d2c36.js";import{d as X}from"./date.f629cf57.js";import{Q as Ze}from"./QPopupProxy.d2978973.js";import{C as et}from"./ClosePopup.488eb010.js";import{_ as tt}from"./ModalMapBox.4e05065c.js";function st(u){const y=[.06,6,50];return typeof u=="string"&&u.length&&u.split(":").forEach((p,v)=>{const m=parseFloat(p);m&&(y[v]=m)}),y}var it=Ne({name:"touch-swipe",beforeMount(u,{value:y,arg:p,modifiers:v}){if(v.mouse!==!0&&ee.has.touch!==!0)return;const m=v.mouseCapture===!0?"Capture":"",a={handler:y,sensitivity:st(p),direction:xe(v),noop:Te,mouseStart(h){we(h,a)&&Ee(h)&&(ne(a,"temp",[[document,"mousemove","move",`notPassive${m}`],[document,"mouseup","end","notPassiveCapture"]]),a.start(h,!0))},touchStart(h){if(we(h,a)){const s=h.target;ne(a,"temp",[[s,"touchmove","move","notPassiveCapture"],[s,"touchcancel","end","notPassiveCapture"],[s,"touchend","end","notPassiveCapture"]]),a.start(h)}},start(h,s){ee.is.firefox===!0&&qe(u,!0);const b=$e(h);a.event={x:b.left,y:b.top,time:Date.now(),mouse:s===!0,dir:!1}},move(h){if(a.event===void 0)return;if(a.event.dir!==!1){ge(h);return}const s=Date.now()-a.event.time;if(s===0)return;const b=$e(h),N=b.left-a.event.x,_=Math.abs(N),P=b.top-a.event.y,x=Math.abs(P);if(a.event.mouse!==!0){if(_<a.sensitivity[1]&&x<a.sensitivity[1]){a.end(h);return}}else if(window.getSelection().toString()!==""){a.end(h);return}else if(_<a.sensitivity[2]&&x<a.sensitivity[2])return;const j=_/s,S=x/s;a.direction.vertical===!0&&_<x&&_<100&&S>a.sensitivity[0]&&(a.event.dir=P<0?"up":"down"),a.direction.horizontal===!0&&_>x&&x<100&&j>a.sensitivity[0]&&(a.event.dir=N<0?"left":"right"),a.direction.up===!0&&_<x&&P<0&&_<100&&S>a.sensitivity[0]&&(a.event.dir="up"),a.direction.down===!0&&_<x&&P>0&&_<100&&S>a.sensitivity[0]&&(a.event.dir="down"),a.direction.left===!0&&_>x&&N<0&&x<100&&j>a.sensitivity[0]&&(a.event.dir="left"),a.direction.right===!0&&_>x&&N>0&&x<100&&j>a.sensitivity[0]&&(a.event.dir="right"),a.event.dir!==!1?(ge(h),a.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Ge(),a.styleCleanup=D=>{a.styleCleanup=void 0,document.body.classList.remove("non-selectable");const c=()=>{document.body.classList.remove("no-pointer-events--children")};D===!0?setTimeout(c,50):c()}),a.handler({evt:h,touch:a.event.mouse!==!0,mouse:a.event.mouse,direction:a.event.dir,duration:s,distance:{x:_,y:x}})):a.end(h)},end(h){a.event!==void 0&&(he(a,"temp"),ee.is.firefox===!0&&qe(u,!1),a.styleCleanup!==void 0&&a.styleCleanup(!0),h!==void 0&&a.event.dir!==!1&&ge(h),a.event=void 0)}};if(u.__qtouchswipe=a,v.mouse===!0){const h=v.mouseCapture===!0||v.mousecapture===!0?"Capture":"";ne(a,"main",[[u,"mousedown","mouseStart",`passive${h}`]])}ee.has.touch===!0&&ne(a,"main",[[u,"touchstart","touchStart",`passive${v.capture===!0?"Capture":""}`],[u,"touchmove","noop","notPassiveCapture"]])},updated(u,y){const p=u.__qtouchswipe;p!==void 0&&(y.oldValue!==y.value&&(typeof y.value!="function"&&p.end(),p.handler=y.value),p.direction=xe(y.modifiers))},beforeUnmount(u){const y=u.__qtouchswipe;y!==void 0&&(he(y,"main"),he(y,"temp"),ee.is.firefox===!0&&qe(u,!1),y.styleCleanup!==void 0&&y.styleCleanup(),delete u.__qtouchswipe)}});const _s={name:{required:!0},disable:Boolean},Ve={setup(u,{slots:y}){return()=>se("div",{class:"q-panel scroll",role:"tabpanel"},ke(y.default))}},bs={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},$s=["update:modelValue","beforeTransition","transition"];function xs(){const{props:u,emit:y,proxy:p}=ze(),{getCacheWithFn:v}=Ke();let m,a;const h=C(null),s=C(null);function b(q){const $=u.vertical===!0?"up":"left";T((p.$q.lang.rtl===!0?-1:1)*(q.direction===$?1:-1))}const N=B(()=>[[it,b,void 0,{horizontal:u.vertical!==!0,vertical:u.vertical,mouse:!0}]]),_=B(()=>u.transitionPrev||`slide-${u.vertical===!0?"down":"right"}`),P=B(()=>u.transitionNext||`slide-${u.vertical===!0?"up":"left"}`),x=B(()=>`--q-transition-duration: ${u.transitionDuration}ms`),j=B(()=>typeof u.modelValue=="string"||typeof u.modelValue=="number"?u.modelValue:String(u.modelValue)),S=B(()=>({include:u.keepAliveInclude,exclude:u.keepAliveExclude,max:u.keepAliveMax})),D=B(()=>u.keepAliveInclude!==void 0||u.keepAliveExclude!==void 0);ce(()=>u.modelValue,(q,$)=>{const U=E(q)===!0?H(q):-1;a!==!0&&ae(U===-1?0:U<H($)?-1:1),h.value!==U&&(h.value=U,y("beforeTransition",q,$),Re(()=>{y("transition",q,$)}))});function c(){T(1)}function d(){T(-1)}function n(q){y("update:modelValue",q)}function E(q){return q!=null&&q!==""}function H(q){return m.findIndex($=>$.props.name===q&&$.props.disable!==""&&$.props.disable!==!0)}function ue(){return m.filter(q=>q.props.disable!==""&&q.props.disable!==!0)}function ae(q){const $=q!==0&&u.animated===!0&&h.value!==-1?"q-transition--"+(q===-1?_.value:P.value):null;s.value!==$&&(s.value=$)}function T(q,$=h.value){let U=$+q;for(;U>-1&&U<m.length;){const G=m[U];if(G!==void 0&&G.props.disable!==""&&G.props.disable!==!0){ae(q),a=!0,y("update:modelValue",G.props.name),setTimeout(()=>{a=!1});return}U+=q}u.infinite===!0&&m.length!==0&&$!==-1&&$!==m.length&&T(q,q===-1?m.length:-1)}function J(){const q=H(u.modelValue);return h.value!==q&&(h.value=q),!0}function re(){const q=E(u.modelValue)===!0&&J()&&m[h.value];return u.keepAlive===!0?[se(Be,S.value,[se(D.value===!0?v(j.value,()=>({...Ve,name:j.value})):Ve,{key:j.value,style:x.value},()=>q)])]:[se("div",{class:"q-panel scroll",style:x.value,key:j.value,role:"tabpanel"},[q])]}function le(){if(m.length!==0)return u.animated===!0?[se(Ye,{name:s.value},re)]:re()}function pe(q){return m=Fe(ke(q.default,[])).filter($=>$.props!==null&&$.props.slot===void 0&&E($.props.name)===!0),m.length}function me(){return m}return Object.assign(p,{next:c,previous:d,goTo:n}),{panelIndex:h,panelDirectives:N,updatePanelsList:pe,updatePanelIndex:J,getPanelContent:le,getEnabledPanels:ue,getPanels:me,isValidPanelName:E,keepAliveProps:S,needsUniqueKeepAliveWrapper:D,goToPanelByOffset:T,goToPanel:n,nextPanel:c,previousPanel:d}}const je=C({dia_pago:"",dia_vencimiento:"",meses_vencidos:0,estado:""});let de=C(""),Q=C(""),Ce=C("");const{formFacturacion:_e}=be(),ot=C([]),at=C(),rt=C(""),lt=C(!1),nt=C([]),dt=C("");parseInt(_e.value.dia_gracia.split(" ")[0]);const ct=()=>{const{api:u,route:y,mostrarNotify:p}=Je();return ce(je.value,v=>{if(v.estado=="pagado"){let a=X.addToDate(v.dia_vencimiento,{months:1});de.value=X.formatDate(a,"DD/MM/YYYY")}else de.value=X.formatDate(v.dia_vencimiento,"DD/MM/YYYY");if(_e.value.aplicar_corte.trim()!=="Desactivado"){const a=parseInt(_e.value.aplicar_corte.split(" ")[0])-v.meses_vencidos;Q.value=X.addToDate(v.dia_vencimiento,{months:a}),Q.value=X.formatDate(Q.value,"DD/MM/YYYY"),new Date(de.value)>=new Date(Q.value)&&(Q.value="Suspendido")}else Q.value="Desactivado";const m=v.dia_pago.split("-");Ce.value=X.addToDate(`${m[0]}-${m[1]}-02`,{months:1})}),{api:u,client_name:dt,dia_pago:de,dia_corte:Q,dia_crear_factura:Ce,dia_vencimiento:rt,mes_pago:je,servicios:ot,showModalPago:lt,mostrarNotify:p,factura:at,pagos:nt,route:y}},ut={class:"col-12 flex justify-start items-center q-pt-none"},pt={class:"row"},mt={class:"col-xs-12 col-md-7"},vt={class:"row"},ft={class:"col-xs-12 col-md-7"},qt={class:"row"},gt={class:"col-xs-12 col-md-7"},ht={class:"row"},yt={class:"col-xs-12 col-md-7"},_t={class:"row"},bt={class:"col-xs-12 col-md-7"},$t={class:"row"},xt={class:"col-xs-12 col-md-7"},wt={class:"col-12 flex justify-start items-center q-py-md"},Vt={class:"row"},jt={class:"col-xs-12 col-md-7"},Ct={class:"col-md-12 q-py-md"},kt={class:"row q-col-gutter-sm"},Pt={class:"col-xs-12 col-md-4"},At={class:"text-weight-bold"},Dt={class:"col-xs-12 col-md-4"},Mt={class:"text-weight-bold"},It={class:"col-xs-12 col-md-4"},St={class:"text-weight-bold"},ws={__name:"FactAndNot",props:["edit"],setup(u){const{api:y,mostrarNotify:p,formFacturacion:v,validacionesFacturacion:m,validarFormFact:a,step:h}=be(),{dia_pago:s,dia_corte:b,dia_crear_factura:N}=ct(),_=C(!1),P=async()=>{if(!a())try{_.value=!0;const{data:d}=await y.put(`/customers/actualizarDatosFactura/${v.value.id}`,v.value);v.value={...d.factura[0]},p("positive",d.msg),_.value=!1}catch(d){_.value=!1,p("warning",d.response.data.message)}};let x=new Array(28).fill(0).map((c,d)=>d+1),j=new Array(25).fill(0).map((c,d)=>`${d+1}  ${d==0?"D\xEDa":"D\xEDas"} antes`),S=new Array(25).fill(0).map((c,d)=>`${d+1}  ${d==0?"D\xEDa":"D\xEDas"}`),D=new Array(12).fill(0).map((c,d)=>`${d+1}  ${d==0?"Mes":"Meses"} ${d==0?"Vencido":"Vencidos"}`);return j.unshift("Desactivado"),D.unshift("Desactivado"),(c,d)=>(I(),L("div",{class:o(["row q-col-gutter-md",c.$q.screen.width>1022?"q-col-gutter-y-lg q-pt-md":""])},[e("div",ut,[e("label",{class:o(["text-h6 text-weight-medium",c.$q.screen.width>1022||"q-pt-xs"])},[g(W,{name:"description"}),M(" Facturaci\xF3n: ")],2)]),e("div",{class:o(["col-xs-12 col-md-6",(c.$q.screen.width<1022,"q-pt-xs")])},[e("div",pt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[c.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(c.$q.screen.width<1022||"q-pr-md")}," Tipo: ",2)],2),e("div",mt,[g(A,{dense:"",modelValue:t(v).tipo,"onUpdate:modelValue":[d[0]||(d[0]=n=>t(v).tipo=n),d[1]||(d[1]=n=>t(m).tipo.isValid=!0)],modelModifiers:{trim:!0},outlined:"",error:!t(m).tipo.isValid,"emit-value":"","map-options":"",options:[{label:"Prepago (Adelantado)",value:"prepago"},{label:"Postpago (Vencido)",value:"postpago"}]},{error:f(()=>[e("label",{class:o(c.$q.dark.isActive?"text-red-4":"text-negative")},w(t(m).tipo.message),3)]),_:1},8,["modelValue","error","options"])])])],2),e("div",{class:o(["col-xs-12 col-md-6",c.$q.screen.width<1022?"q-pt-none":"q-pt-xs"])},[e("div",vt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[c.$q.screen.width<1022?"justify-center q-mt-md q-pb-xs":"justify-end text-right q-pb-md"]])},[e("label",{class:o(c.$q.screen.width<1022||"q-pr-md")}," Dia Pago: ",2)],2),e("div",ft,[g(A,{dense:"",modelValue:t(v).dia_pago,"onUpdate:modelValue":[d[2]||(d[2]=n=>t(v).dia_pago=n),d[3]||(d[3]=n=>t(m).dia_pago.isValid=!0)],modelModifiers:{trim:!0},outlined:"",options:t(x),error:!t(m).dia_pago.isValid},{error:f(()=>[e("label",{class:o(c.$q.dark.isActive?"text-red-4":"text-negative")},w(t(m).dia_pago.message),3)]),_:1},8,["modelValue","options","error"])])])],2),e("div",{class:o(["col-xs-12 col-md-6",c.$q.screen.width<1022?"q-pt-none":"q-pt-xs"])},[e("div",qt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[c.$q.screen.width<1022?"justify-center q-mt-md q-pb-xs":"justify-end text-right q-pb-md"]])},[e("label",{class:o(c.$q.screen.width<1022||"q-pr-md")}," Tipo Impuesto: ",2)],2),e("div",gt,[g(A,{dense:"",modelValue:t(v).tipo_impuesto,"onUpdate:modelValue":[d[4]||(d[4]=n=>t(v).tipo_impuesto=n),d[5]||(d[5]=n=>t(m).tipo_impuesto.isValid=!0)],modelModifiers:{trim:!0},outlined:"",options:["Impuestos incluido","Mas impuestos","Ninguno"],error:!t(m).tipo_impuesto.isValid},{error:f(()=>[e("label",{class:o(c.$q.dark.isActive?"text-red-4":"text-negative")},w(t(m).tipo_impuesto.message),3)]),_:1},8,["modelValue","error"])])])],2),e("div",{class:o(["col-xs-12 col-md-6",c.$q.screen.width<1022?"q-pt-none":"q-pt-xs"])},[e("div",ht,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[c.$q.screen.width<1022?"justify-center q-mt-md q-pb-xs":"justify-end text-right q-pb-md"]])},[e("label",{class:o(c.$q.screen.width<1022||"q-pr-md")}," D\xEDas de gracia: ",2)],2),e("div",yt,[g(A,{dense:"",modelValue:t(v).dia_gracia,"onUpdate:modelValue":[d[6]||(d[6]=n=>t(v).dia_gracia=n),d[7]||(d[7]=n=>t(m).dia_gracia.isValid=!0)],modelModifiers:{trim:!0},outlined:"",options:t(S),hint:"*d\xEDas tolerancia para aplicar corte",error:!t(m).dia_gracia.isValid},{error:f(()=>[e("label",{class:o(c.$q.dark.isActive?"text-red-4":"text-negative")},w(t(m).dia_gracia.message),3)]),_:1},8,["modelValue","options","error"])])])],2),e("div",{class:o(["col-xs-12 col-md-6",c.$q.screen.width<1022?"q-pt-none":"q-pt-xs"])},[e("div",_t,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[c.$q.screen.width<1022?"justify-center q-mt-md q-pb-xs":"justify-end text-right q-pb-md"]])},[e("label",{class:o(c.$q.screen.width<1022||"q-pr-md")}," Aplicar Corte: ",2)],2),e("div",bt,[g(A,{dense:"",modelValue:t(v).aplicar_corte,"onUpdate:modelValue":[d[8]||(d[8]=n=>t(v).aplicar_corte=n),d[9]||(d[9]=n=>t(m).aplicar_corte.isValid=!0)],modelModifiers:{trim:!0},outlined:"",options:t(D),error:!t(m).aplicar_corte.isValid},{error:f(()=>[e("label",{class:o(c.$q.dark.isActive?"text-red-4":"text-negative")},w(t(m).aplicar_corte.message),3)]),_:1},8,["modelValue","options","error"])])])],2),e("div",{class:o(["col-xs-12 col-md-6",c.$q.screen.width<1022?"q-pt-none":"q-pt-xs"])},[e("div",$t,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[c.$q.screen.width<1022?"justify-center q-mt-md q-pb-xs":"justify-end text-right q-pb-md"]])},[e("label",{class:o(c.$q.screen.width<1022||"q-pr-md")}," Tipo Comprobante: ",2)],2),e("div",xt,[g(A,{dense:"",modelValue:t(v).tipo_comprobante,"onUpdate:modelValue":[d[10]||(d[10]=n=>t(v).tipo_comprobante=n),d[11]||(d[11]=n=>t(m).tipo_comprobante.isValid=!0)],modelModifiers:{trim:!0},outlined:"",options:["Factura","Recibo"],error:!t(m).tipo_comprobante.isValid},{error:f(()=>[e("label",{class:o(c.$q.dark.isActive?"text-red-4":"text-negative")},w(t(m).tipo_comprobante.message),3)]),_:1},8,["modelValue","error"])])])],2),e("div",wt,[e("label",{class:o(["text-h6 text-weight-medium",c.$q.screen.width>1022||"q-pt-xs"])},[g(W,{name:"notifications"}),M(" Notificaciones: ")],2)]),e("div",{class:o(["col-xs-12 col-md-6",(c.$q.screen.width<1022,"q-pt-xs")])},[e("div",Vt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[c.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(c.$q.screen.width<1022||"q-pr-md")}," Recordatorios de pago: ",2)],2),e("div",jt,[g(A,{dense:"",modelValue:t(v).recordatorio_pago,"onUpdate:modelValue":[d[12]||(d[12]=n=>t(v).recordatorio_pago=n),d[13]||(d[13]=n=>t(m).recordatorio_pago.isValid=!0)],modelModifiers:{trim:!0},outlined:"",error:!t(m).recordatorio_pago.isValid,multiple:"","stack-label":"",options:["Correo","Telegram"]},{error:f(()=>[e("label",{class:o(c.$q.dark.isActive?"text-red-4":"text-negative")},w(t(m).recordatorio_pago.message),3)]),"selected-item":f(n=>[g(He,{color:"deep-orange-14","text-color":"white",icon:"done",removable:"",dense:"",onRemove:E=>n.removeAtIndex(n.index),tabindex:n.tabindex,class:"q-ma-none q-mr-sm"},{default:f(()=>[M(w(n.opt),1)]),_:2},1032,["onRemove","tabindex"])]),_:1},8,["modelValue","error"])])])],2),u.edit?(I(),L(ye,{key:0},[e("div",Ct,[e("div",kt,[e("div",Pt,[g(oe,{class:"text-center flex-center q-py-md",style:{width:"100%","text-align":"center","font-size":"15px"},outline:"",color:"lime-7"},{default:f(()=>[M(" D\xEDa de pago: "),e("span",At," \xA0"+w(t(s)),1)]),_:1})]),e("div",Dt,[g(oe,{class:"text-center flex-center q-py-md",style:{width:"100%","text-align":"center","font-size":"15px"},outline:"",color:"red-4"},{default:f(()=>[M(" D\xEDa de corte: "),e("span",Mt," \xA0"+w(t(b)),1)]),_:1})]),e("div",It,[g(oe,{class:"text-center flex-center q-py-md",style:{width:"100%","text-align":"center","font-size":"15px"},outline:"",color:"cyan-4"},{default:f(()=>[M(" Crear factura: "),e("span",St," \xA0"+w(t(X).formatDate(t(N),"DD/MM/YYYY"))+" 12:00 AM ",1)]),_:1})])])]),e("div",{class:o(["col-xs-12 col-md-12 flex q-py-md justify-center",[c.$q.screen.width<600?" q-pt-none q-ml-md":""]]),style:{"padding-bottom":"0px"}},[g(O,{"icon-right":"save",onClick:P,loading:_.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:f(()=>[M(" \xA0 Guardar\xA0 ")]),_:1},8,["loading"])],2)],64)):(I(),L("div",{key:1,class:o(["col-xs-12 col-md-12 flex q-py-md",[c.$q.screen.width<600?"justify-center q-pt-none q-ml-md":"justify-between"]]),style:{"padding-bottom":"0px"}},[c.$q.screen.width>600?(I(),ie(O,{key:0,icon:"arrow_back",onClick:d[14]||(d[14]=n=>h.value=1),outline:"",rounded:"",class:"q-ml-md",color:c.$q.dark.isActive?"blue-grey-2":"blue-grey-10"},{default:f(()=>[M(" \xA0 Anterior ")]),_:1},8,["color"])):K("",!0),g(O,{onClick:t(a),"icon-right":"arrow_forward",outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:f(()=>[M(" \xA0 Siguiente\xA0 ")]),_:1},8,["onClick"])],2))],2))}},Ut={class:"row justify-center"},Nt={class:"row"},Tt={class:"col-xs-12 col-md-7 justify-center"},Et={class:"col-xs-12 col-md-6 q-pt-none"},zt={class:"row"},Yt={class:"col-xs-12 col-md-7"},Ft={class:"row"},Rt={class:"col-xs-12 col-md-7"},Bt={class:"row"},Qt={class:"col-xs-12 col-md-7 justify-center"},Xt={class:"row"},Lt={class:"col-xs-12 col-md-7"},Ot={class:"col-xs-12 col-md-6 q-pt-none"},Gt={class:"row"},Kt={class:"col-xs-12 col-md-7"},Wt={class:"row items-center justify-end"},Ht={class:"row"},Jt={class:"col-xs-12 col-md-7"},Zt={class:"row"},es={class:"col-xs-12 col-md-7 justify-center"},ts={class:"row"},ss={class:"col-xs-12 col-md-7"},is={class:"row"},os={class:"col-xs-12 col-md-7 justify-center"},as={class:"row"},rs={class:"col-xs-12 col-md-7"},Vs={__name:"ServicioInternet",props:["edit","servicio"],emits:["actualizarDatos"],setup(u,{emit:y}){const p=u;let v=[],m=[];const{api:a,claim:h,formInternet:s,listIps:b,loading:N,listCajasNap:_,listPuertosCajaNap:P,groupedIpsByRed:x,listRedes:j,optionsListIps:S,listRouter:D,listServicionsInternet:c,obtenerListaSubred:d,validacionesInternet:n,mostrarNotify:E,validDecimal:H,validarFormInternet:ue,step:ae}=be(),T=C(!1),J=C({edit:!1,coords:""}),re=()=>{p.edit&&(J.value={edit:!0,coords:s.value.coordenadas}),T.value=!0},le=async()=>{p.edit&&(s.value.router_id=p.servicio.router_id.id,s.value.direccion=p.servicio.direccion,s.value.coordenadas=p.servicio.coordenadas,s.value.perfil_internet=p.servicio.perfil_internet.id,s.value.precio=p.servicio.precio,s.value.fecha_instalacion=p.servicio.fecha_instalacion,s.value.mac=p.servicio.mac,s.value.red_id=`${p.servicio.red_id.id}|${p.servicio.indice}`,s.value.ipv4=p.servicio.ipv4,s.value.caja_id=p.servicio.caja_id?p.servicio.caja_id.id:"",s.value.puerto_id=p.servicio.puerto_id?p.servicio.puerto_id.id:"");const i=s.value.router_id;s.value.router_id="";const{data:r}=await a.get(`/router/find/${h.company.id}`);D.value=[],r.forEach((l,V)=>{D.value.push({label:l.nombre,value:l.id,ip_host:l.ip_host,puerto_api:l.puerto_api,user:l.user_api,password:l.password_api}),V+1==r.length&&(s.value.router_id=i)})},pe=async()=>{n.value.router_id.isValid=!0,p.edit||(s.value.perfil_internet="",s.value.precio=0);const i=s.value.perfil_internet;s.value.perfil_internet="",c.value=[];let r={headers:{router_id:s.value.router_id}};const{data:l}=await a.get("/internet",r);l.length==0?E("warning","Por favor agrega un perfil de internet"):l.forEach((V,k)=>{c.value.push({label:V.nombre_plan,value:V.id,precio_plan:V.precio_plan,detalles:V}),k+1==l.length&&(s.value.perfil_internet=i)}),q(),U()},me=(i,r)=>{const l=r.split(".");for(const V in i)if(i.hasOwnProperty(V)&&V.split(".").every((Y,z)=>Y===l[z]))return i[`${V}`].length;return 0},q=async()=>{j.value=[],m=[];let i={headers:{router_id:s.value.router_id}};const r=await a.get(`/customers/get-ips/${s.value.router_id}`);r.data.forEach((k,Y)=>{k.puerto_id&&m.push(k.puerto_id.id),v.push(k.ipv4),Y+1==r.data.length&&p.edit&&(v=v.filter(z=>z!=p.servicio.ipv4))}),await Promise.resolve();const l=x(v),{data:V}=await a.get("/red-ipv4",i);V.forEach(k=>{const Y=k.red,z=k.cidr.split(" ")[0],Ie=d(`${Y}/${z}`),Se=x(Ie);let fe;parseInt(z)>=25&&parseInt(z)<=32?fe=2**(32-z):fe=256;let F=Object.keys(Se);for(let R=0;R<F.length;R++){const Ue=me(l,F[R]);let Z;F.length==1?Z=2:F.length>1&&R==0||F.length>1&&R+1==F.length?Z=1:Z=0,j.value.push({value:`${k.id}|${R}`,label:`${F[R]}.0 
          (${fe-(Z+Ue)} Ips disponibles) ${k.nombre}`,red_name:k.nombre,cidr:z})}})},$=()=>{p.edit||(s.value.ipv4="");const i=j.value.find(V=>V.value==s.value.red_id),r=j.value.filter(V=>V.red_name==i.red_name);let l;parseInt(i.cidr)>=25&&parseInt(i.cidr)<=32?l=i.cidr:l="24",b.value=d(`${i.label.split(" ")[0]}/${l}`),r.length==1?(b.value.shift(),b.value.pop()):s.value.red_id==r[0].value?b.value.shift():s.value.red_id==r[r.length-1].value&&b.value.pop(),S.value=b.value,n.value.red_id.isValid=!0,v.forEach(V=>{const k=b.value.findIndex(Y=>Y==V);k!=-1&&b.value.splice(k,1)}),b.value.length>0&&(p.edit||(s.value.ipv4=b.value[0]),n.value.ipv4.isValid=!0)},U=async()=>{let i={headers:{router_id:s.value.router_id}};_.value=[];const{data:r}=await a.get("/caja-nap",i);r.forEach(l=>{_.value.push({value:`${l.id}`,label:`${l.nombre}`,puertos:l.puertos})})},G=()=>{P.value=[],_.value.find(i=>i.value==s.value.caja_id).puertos.forEach(i=>{m.includes(i.id)||P.value.push({value:`${i.id}`,label:`Puerto ${i.puerto}`})}),P.value.unshift({value:"Ninguno",label:"Ninguno"})},Pe=()=>{n.value.perfil_internet.isValid=!0,n.value.precio.isValid=!0;const i=c.value.find(r=>r.value==s.value.perfil_internet);s.value.precio=i.precio_plan},Ae=(i="",r)=>{if(i===""){r(()=>{b.value=S.value});return}r(()=>{const l=i.toLowerCase();b.value=b.value.filter(V=>V.toLowerCase().indexOf(l)>-1)})},De=i=>{s.value.coordenadas=`${i.lng}, ${i.lat}`,T.value=!1};ce(()=>s.value.router_id,i=>{s.value.router_id.length!=0&&pe()}),ce(()=>s.value.red_id,i=>{p.edit?setTimeout(()=>{$()},2e3):s.value.indice||$()});const ve=C(!1),Me=async()=>{try{ve.value=!0;const i=ue(),r=c.value.filter(l=>l.value==s.value.perfil_internet);if(!i){const{data:l}=await a.put(`/customers/actualizarDatosServicio/${p.servicio.id}`,{...s.value,indice:s.value.red_id.split("|")[1],red_id:s.value.red_id.split("|")[0],cliente:p.servicio.cliente,perfil_internet:r[0].detalles,ipv4_old:p.servicio.ipv4,estado:p.servicio.estado});E("positive",l.msg),ve.value=!1,y("actualizarDatos")}}catch(i){ve.value=!1,E("warning",i.response.data.message)}};return(D.value.length==0||p.edit)&&le(),(i,r)=>(I(),L(ye,null,[e("div",{class:o(["row q-col-gutter-md",i.$q.screen.width<1022||"q-col-gutter-y-lg q-pt-md"])},[e("div",{class:o(["col-12 q-pt-none",i.$q.screen.width<1022||"q-pl-none"])},[e("div",Ut,[e("div",{class:o(["col-xs-12 col-md-6",(i.$q.screen.width<1022,"q-pt-xs")])},[e("div",Nt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Router: ",2)],2),e("div",Tt,[g(A,{dense:"",modelValue:t(s).router_id,"onUpdate:modelValue":r[0]||(r[0]=l=>t(s).router_id=l),modelModifiers:{trim:!0},filled:"",error:!t(n).router_id.isValid,"emit-value":"","map-options":"",options:t(D)},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).router_id.message),3)]),_:1},8,["modelValue","error","options"])])])],2)])],2),t(s).router_id.length!=0?(I(),L(ye,{key:0},[e("div",Et,[e("div",zt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Direcci\xF3n: ",2)],2),e("div",Yt,[g(te,{modelValue:t(s).direccion,"onUpdate:modelValue":r[1]||(r[1]=l=>t(s).direccion=l),modelModifiers:{trim:!0},"input-style":"width: 81%",error:!t(n).direccion.isValid,dense:"",outlined:""},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).direccion.message),3)]),append:f(()=>[g(oe,{filled:"",color:"blue-grey-6",style:{height:"100%",width:"19%",position:"absolute",right:"0px","justify-content":"center","font-size":"14px",cursor:"pointer"}},{default:f(()=>[g(W,{name:"fa-solid fa-street-view",size:"xs"})]),_:1})]),_:1},8,["modelValue","error"])])])]),e("div",{class:o(["col-xs-12 col-md-6 q-pt-none",i.$q.screen.width<1022||"q-pl-none"])},[e("div",Ft,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Coordenadas: ",2)],2),e("div",Rt,[g(te,{modelValue:t(s).coordenadas,"onUpdate:modelValue":r[2]||(r[2]=l=>t(s).coordenadas=l),modelModifiers:{trim:!0},placeholder:"Coordenadas Longitud, Latitud","input-style":"width: 81%",error:!t(n).coordenadas.isValid,dense:"",outlined:""},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).coordenadas.message),3)]),append:f(()=>[g(oe,{filled:"",color:"blue-grey-6",onClick:re,style:{height:"100%",width:"19%",position:"absolute",right:"0px","justify-content":"center","font-size":"14px",cursor:"pointer"}},{default:f(()=>[g(W,{name:"fa-solid fa-location-dot",size:"xs"})]),_:1})]),_:1},8,["modelValue","error"])])])],2),e("div",{class:o(["col-xs-12 col-md-6",(i.$q.screen.width<1022,"q-pt-xs")])},[e("div",Bt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Perfil Internet: ",2)],2),e("div",Qt,[g(A,{dense:"",modelValue:t(s).perfil_internet,"onUpdate:modelValue":[r[3]||(r[3]=l=>t(s).perfil_internet=l),Pe],modelModifiers:{trim:!0},filled:"",error:!t(n).perfil_internet.isValid,"emit-value":"","map-options":"",options:t(c)},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).perfil_internet.message),3)]),_:1},8,["modelValue","error","options"])])])],2),e("div",{class:o(["col-xs-12 col-md-6 q-pt-none",i.$q.screen.width<1022||"q-pl-none"])},[e("div",Xt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Precio: ",2)],2),e("div",Lt,[g(te,{modelValue:t(s).precio,"onUpdate:modelValue":[r[4]||(r[4]=l=>t(s).precio=l),r[5]||(r[5]=l=>t(H)("precio"))],modelModifiers:{trim:!0},type:"number",step:"0.01",error:!t(n).precio.isValid,"input-class":"resaltarTextoInput",dense:"",outlined:""},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).precio.message),3)]),_:1},8,["modelValue","error"])])])],2),e("div",Ot,[e("div",Gt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Fecha Instalaci\xF3n: ",2)],2),e("div",Kt,[g(te,{filled:"",dense:"",modelValue:t(s).fecha_instalacion,"onUpdate:modelValue":r[7]||(r[7]=l=>t(s).fecha_instalacion=l),"input-style":{textAlign:"center"},mask:"date",rules:["date"]},{append:f(()=>[g(W,{name:"event",class:"cursor-pointer"},{default:f(()=>[g(Ze,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:f(()=>[g(We,{modelValue:t(s).fecha_instalacion,"onUpdate:modelValue":r[6]||(r[6]=l=>t(s).fecha_instalacion=l)},{default:f(()=>[e("div",Wt,[Qe(g(O,{label:"Close",color:"primary",flat:""},null,512),[[et]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),e("div",{class:o(["col-xs-12 col-md-6 q-pt-none",i.$q.screen.width<1022||"q-pl-none"])},[e("div",Ht,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," MAC: ",2)],2),e("div",Jt,[g(te,{modelValue:t(s).mac,"onUpdate:modelValue":r[8]||(r[8]=l=>t(s).mac=l),modelModifiers:{trim:!0},mask:"XX:XX:XX:XX:XX:XX","unmasked-value":"",error:!t(n).mac.isValid,"input-class":"resaltarTextoInput",dense:"",outlined:""},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).mac.message),3)]),_:1},8,["modelValue","error"])])])],2),e("div",{class:o(["col-xs-12 col-md-6",(i.$q.screen.width<1022,"q-pt-xs")])},[e("div",Zt,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Redes IPv4: ",2)],2),e("div",es,[g(A,{dense:"",modelValue:t(s).red_id,"onUpdate:modelValue":r[9]||(r[9]=l=>t(s).red_id=l),modelModifiers:{trim:!0},filled:"",error:!t(n).red_id.isValid,"emit-value":"","map-options":"",options:t(j)},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).red_id.message),3)]),_:1},8,["modelValue","error","options"])])])],2),t(s).red_id!=""?(I(),L("div",{key:0,class:o(["col-xs-12 col-md-6 q-pt-none",i.$q.screen.width<1022||"q-pl-none"])},[e("div",ts,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," IPv4: ",2)],2),e("div",ss,[g(A,{dense:"",modelValue:t(s).ipv4,"onUpdate:modelValue":r[10]||(r[10]=l=>t(s).ipv4=l),modelModifiers:{trim:!0},filled:"",error:!t(n).ipv4.isValid,"emit-value":"","map-options":"","use-input":"","input-debounce":"10",onFilter:Ae,options:t(b)},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).ipv4.message),3)]),_:1},8,["modelValue","error","options"])])])],2)):K("",!0),e("div",{class:o(["col-xs-12 col-md-6",(i.$q.screen.width<1022,"q-pt-xs")])},[e("div",is,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Caja(s) Nap: ",2)],2),e("div",os,[g(A,{dense:"",modelValue:t(s).caja_id,"onUpdate:modelValue":[r[12]||(r[12]=l=>t(s).caja_id=l),G],modelModifiers:{trim:!0},filled:"",error:!t(n).caja_id.isValid,"emit-value":"","map-options":"",options:t(_)},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).caja_id.message),3)]),append:f(()=>[t(s).caja_id.length>0?(I(),ie(W,{key:0,name:"close",onClick:r[11]||(r[11]=Xe(l=>(t(s).caja_id="",t(s).puerto_id=""),["stop","prevent"])),class:"cursor-pointer"})):K("",!0)]),_:1},8,["modelValue","error","options"])])])],2),t(s).caja_id!=""?(I(),L("div",{key:1,class:o(["col-xs-12 col-md-6 q-pt-none",i.$q.screen.width<1022||"q-pl-none"])},[e("div",as,[e("div",{class:o(["col-xs-12 col-md-4 flex items-center justify-end",[i.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"texto-rigth q-pb-md"]])},[e("label",{class:o(i.$q.screen.width<1022||"q-pr-md")}," Puerto Nap: ",2)],2),e("div",rs,[g(A,{dense:"",modelValue:t(s).puerto_id,"onUpdate:modelValue":[r[13]||(r[13]=l=>t(s).puerto_id=l),r[14]||(r[14]=l=>t(n).puerto_id.isValid=!0)],modelModifiers:{trim:!0},filled:"",error:!t(n).puerto_id.isValid,"emit-value":"","map-options":"",options:t(P)},{error:f(()=>[e("label",{class:o(i.$q.dark.isActive?"text-red-4":"text-negative")},w(t(n).puerto_id.message),3)]),_:1},8,["modelValue","error","options"])])])],2)):K("",!0)],64)):K("",!0),e("div",{class:o(["col-xs-12 col-md-12 flex q-py-md",[i.$q.screen.width<600?"justify-center q-pt-none q-ml-md":"justify-between"]]),style:{"padding-bottom":"0px"}},[i.$q.screen.width>600?(I(),ie(O,{key:0,icon:"arrow_back",onClick:r[15]||(r[15]=l=>ae.value=2),outline:"",rounded:"",class:"q-ml-md",style:Le(p.edit?"visibility: hidden;":""),color:i.$q.dark.isActive?"blue-grey-2":"blue-grey-10"},{default:f(()=>[M(" \xA0 Anterior ")]),_:1},8,["style","color"])):K("",!0),p.edit?(I(),ie(O,{key:2,onClick:Me,"icon-right":"save",outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:f(()=>[M(" \xA0 Actualizar\xA0 ")]),_:1})):(I(),ie(O,{key:1,type:"submit","icon-right":"save",loading:t(N),outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:f(()=>[M(" \xA0 Guardar\xA0 ")]),_:1},8,["loading"]))],2)],2),g(Oe,{modelValue:T.value,"onUpdate:modelValue":r[16]||(r[16]=l=>T.value=l)},{default:f(()=>[g(tt,{objMap:J.value,onCoordenadasSelected:De},null,8,["objMap"])]),_:1},8,["modelValue"])],64))}};export{ws as _,bs as a,$s as b,xs as c,Vs as d,ct as e,_s as u};
