import{r as f,o as v,a9 as w,g as a,f as e,aV as g,e as l,aa as $,O,h as x,ah as N,Q,ad as A,aU as S,c as G,ba as I,aj as z,ai as R,af as W,ab as j,by as P}from"./index.474519f9.js";import{Q as D}from"./QPopupEdit.7eb0530c.js";import{m as E,Q as q,d as H,a as M}from"./format.60b19ab8.js";import{Q as L}from"./QList.67272121.js";import{Q as F}from"./QForm.fec3fa64.js";import{C as T}from"./ClosePopup.0951b21e.js";import{u as B}from"./useHelpers.a0dac464.js";import{a as X}from"./use-quasar.7f1204f4.js";import"./axios.15fd7c93.js";const Y={class:"text-h6 text-center"},Z={class:"row q-pt-lg q-gutter-lg justify-center"},ee={class:"col-xs-12"},ae=l("label",{class:"text-center"},"Nombre:",-1),te={class:"col-xs-12"},le=l("label",{class:"text-center"},"Descripcion:",-1),oe={class:"col-xs-9 col-sm-12 q-mt-lg q-mb-md flex justify-center"},se={__name:"ModalProforma",props:["clausulas","aceptacion"],emits:["hideModal"],setup(k,{emit:b}){const h=k,{capitalize:V}=E,d=f(!1),t=f({nombre:"",descripcion:""}),{api:_,claim:y,mostrarNotify:i}=B(),C=async()=>{try{h.clausulas.unshift({...t.value});let n={company_id:y.company.id};await _.post("/proforma/clausula",{clausulas:h.clausulas,aceptacion_proforma:h.aceptacion},{headers:n}),i("positive","Clausula agregada exitosamente"),b("hideModal")}catch(n){console.log(n),i("warning","No se pudo agregar la clausula")}};return(n,o)=>(v(),w(S,{style:{width:"500px !important","max-width":"80vw"}},{default:a(()=>[e(g,null,{default:a(()=>[l("div",Y,[$(" Nueva Clausula "),O(e(x,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[T]])])]),_:1}),e(N,{inset:""}),e(g,{class:"q-pt-none"},{default:a(()=>[e(F,{onSubmit:C},{default:a(()=>[l("div",Z,[l("div",ee,[ae,e(Q,{modelValue:t.value.nombre,"onUpdate:modelValue":o[0]||(o[0]=m=>t.value.nombre=m),modelModifiers:{trim:!0},onKeyup:o[1]||(o[1]=m=>t.value.nombre=A(V)(t.value.nombre)),dense:"",filled:"",required:""},null,8,["modelValue"])]),l("div",te,[le,e(Q,{type:"textarea",rows:"3",onKeyup:o[2]||(o[2]=m=>t.value.descripcion=A(V)(t.value.descripcion)),modelValue:t.value.descripcion,"onUpdate:modelValue":o[3]||(o[3]=m=>t.value.descripcion=m),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])]),l("div",oe,[e(x,{label:"Guardar",loading:d.value,outline:"",rounded:"",class:"q-px-xl",type:"submit",style:{color:"#696cff"}},null,8,["loading"])])])]),_:1})]),_:1})]),_:1}))}},ue={class:"text-h6 text-center"},ne={class:"row q-pt-lg q-gutter-lg justify-center"},re={class:"col-xs-12"},de=l("label",{class:"text-center"},"Detalle:",-1),ce={class:"col-xs-9 col-sm-12 q-mt-lg q-mb-md flex justify-center"},ie={__name:"ModalAceptacionPropuesta",props:["clausulas","aceptacion","proforma_id"],emits:["hideModal"],setup(k,{emit:b}){const h=k,{capitalize:V}=E,d=f(!1),t=f(""),{api:_,claim:y,mostrarNotify:i}=B(),C=async()=>{try{let n={company_id:y.company.id};await _.post("/proforma/clausula",{clausulas:h.clausulas,aceptacion_proforma:t.value},{headers:n}),i("positive","Clausula agregada exitosamente"),b("hideModal")}catch{i("warning","No se pudo agregar la clausula")}};return(n,o)=>(v(),w(S,{style:{width:"500px !important","max-width":"80vw"}},{default:a(()=>[e(g,null,{default:a(()=>[l("div",ue,[$(" Aceptaci\xF3n de la propuesta "),O(e(x,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[T]])])]),_:1}),e(N,{inset:""}),e(g,{class:"q-pt-none"},{default:a(()=>[e(F,{onSubmit:C},{default:a(()=>[l("div",ne,[l("div",re,[de,e(Q,{type:"textarea",rows:"4",modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=m=>t.value=m),modelModifiers:{trim:!0},onKeyup:o[1]||(o[1]=m=>t.value=A(V)(t.value)),dense:"",filled:"",required:""},null,8,["modelValue"])]),l("div",ce,[e(x,{label:"Guardar",loading:d.value,outline:"",rounded:"",class:"q-px-xl",type:"submit",style:{color:"#696cff"}},null,8,["loading"])])])]),_:1})]),_:1})]),_:1}))}},me={class:"q-ma-lg q-pt-md"},pe={class:"row q-col-gutter-lg"},fe={class:"col-xs-12 col-sm-7"},ve=l("div",{class:"text-h6 q-pt-sm"},"Clausulas de la propuesta",-1),_e={class:"text-weight-medium text-left"},ye={class:"text-weight-medium text-justify"},ge={class:"text-grey-8 q-gutter-xs"},xe={class:"col-xs-12 col-sm-5"},be=l("div",{class:"text-h6 q-pt-sm"},"Aceptaci\xF3n de la propuesta",-1),he={class:"text-weight-medium text-justify",id:"text-aceptacion"},Ve={class:"text-grey-8 q-gutter-xs"},Se={__name:"IndexPage",setup(k){const{api:b,claim:h,mostrarNotify:V}=B(),d=f([]),t=f(""),_=f("");f(!1);const y=f(!1),i=f(!1),C=X(),n=async()=>{const{data:p}=await b.get(`/proforma/${h.company.id}`);_.value=p.id,d.value=p.clausulas?p.clausulas:[],t.value=p.aceptacion_proforma?p.aceptacion_proforma:""},o=async()=>{setTimeout(async()=>{await b.patch(`/proforma/${_.value}`,{clausulas:d.value,aceptacion_proforma:t.value})},1e3)},m=p=>{C.dialog({title:"Confirmar",message:"Deseas quitar esta clausula?",ok:{push:!0,label:"Quitar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{d.value.splice(p,1),o()}catch(s){V("negative",s.response.data.message)}})},J=()=>{C.dialog({title:"Confirmar",message:"Deseas quitar esta aceptaci\xF3n?",ok:{push:!0,label:"Quitar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{await b.patch(`/proforma/${_.value}`,{clausulas:d.value,aceptacion_proforma:""}),n()}catch(p){V("negative",p.response.data.message)}})};return n(),(p,s)=>(v(),G(z,null,[l("div",me,[l("div",pe,[l("div",fe,[e(S,{class:"my-card"},{default:a(()=>[e(g,{class:"text-white flex justify-between q-pt-sm q-pb-sm"},{default:a(()=>[ve,e(x,{onClick:s[0]||(s[0]=u=>y.value=!0),round:"",color:"primary",icon:"add"})]),_:1}),e(N),e(g,{class:"q-pa-none"},{default:a(()=>[e(L,{bordered:"",class:"rounded-borders q-pt-sm"},{default:a(()=>{var u;return[((u=d.value)==null?void 0:u.length)>0?(v(!0),G(z,{key:0},R(d.value,(r,U)=>(v(),w(M,{key:U},{default:a(()=>[e(q,{top:"",class:"col-2 gt-sm flex flex-center"},{default:a(()=>[l("span",_e,[$(j(r.nombre)+" ",1),e(D,{modelValue:r.nombre,"onUpdate:modelValue":c=>r.nombre=c,buttons:"",onSave:o,"label-set":"Guardar","label-cancel":"Cancelar","auto-save":""},{default:a(c=>[e(Q,{modelValue:c.value,"onUpdate:modelValue":K=>c.value=K,dense:"",autofocus:"",counter:"",onKeyup:P(c.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024),e(q,{top:""},{default:a(()=>[l("span",ye,[$(j(r.descripcion)+" ",1),e(D,{modelValue:r.descripcion,"onUpdate:modelValue":c=>r.descripcion=c,buttons:"",onSave:o,"label-set":"Guardar","label-cancel":"Cancelar","auto-save":""},{default:a(c=>[e(Q,{type:"textarea",rows:"4",modelValue:c.value,"onUpdate:modelValue":K=>c.value=K,dense:"",autofocus:"",counter:"",onKeyup:P(c.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024),e(q,{top:"",side:"",class:"flex flex-center"},{default:a(()=>[l("div",ge,[e(x,{class:"gt-xs",onClick:c=>m(U),size:"12px",flat:"",dense:"",round:"",icon:"delete"},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128)):(v(),w(M,{key:1,class:"text-center"},{default:a(()=>[e(q,{top:"",class:"col-12 gt-sm"},{default:a(()=>[e(H,{class:"q-mt-sm"},{default:a(()=>[$(" No hay clausulas ")]),_:1})]),_:1})]),_:1}))]}),_:1})]),_:1})]),_:1})]),l("div",xe,[e(S,{class:"my-card"},{default:a(()=>[e(g,{class:"text-white flex justify-between q-pt-sm q-pb-sm"},{default:a(()=>{var u;return[be,((u=t.value)==null?void 0:u.length)==0?(v(),w(x,{key:0,onClick:s[1]||(s[1]=r=>i.value=!0),round:"",color:"primary",icon:"add"})):W("",!0)]}),_:1}),e(N),e(g,{class:"q-pa-none"},{default:a(()=>[e(L,{bordered:"",class:"rounded-borders q-pt-sm"},{default:a(()=>{var u;return[((u=t.value)==null?void 0:u.length)>0?(v(),w(M,{key:0},{default:a(()=>[e(q,{top:""},{default:a(()=>[l("span",he,[$(j(t.value)+" ",1),e(D,{modelValue:t.value,"onUpdate:modelValue":s[2]||(s[2]=r=>t.value=r),buttons:"",onSave:o,"label-set":"Guardar","label-cancel":"Cancelar","auto-save":""},{default:a(r=>[e(Q,{type:"textarea",rows:"4",modelValue:r.value,"onUpdate:modelValue":U=>r.value=U,dense:"",autofocus:"",counter:"",onKeyup:P(r.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])]),_:1}),e(q,{top:"",side:""},{default:a(()=>[l("div",Ve,[e(x,{class:"gt-xs",onClick:J,size:"12px",flat:"",dense:"",round:"",icon:"delete"})])]),_:1})]),_:1})):(v(),w(M,{key:1,class:"text-center"},{default:a(()=>[e(q,{top:"",class:"col-12 gt-sm"},{default:a(()=>[e(H,{class:"q-mt-sm"},{default:a(()=>[$(" No hay clausulas ")]),_:1})]),_:1})]),_:1}))]}),_:1})]),_:1})]),_:1})])])]),e(I,{modelValue:y.value,"onUpdate:modelValue":s[4]||(s[4]=u=>y.value=u)},{default:a(()=>[e(se,{clausulas:d.value,aceptacion:t.value,onHideModal:s[3]||(s[3]=u=>(y.value=!1,n()))},null,8,["clausulas","aceptacion"])]),_:1},8,["modelValue"]),e(I,{modelValue:i.value,"onUpdate:modelValue":s[6]||(s[6]=u=>i.value=u)},{default:a(()=>[e(ie,{clausulas:d.value,aceptacion:t.value,proforma_id:_.value,onHideModal:s[5]||(s[5]=u=>(i.value=!1,n()))},null,8,["clausulas","aceptacion","proforma_id"])]),_:1},8,["modelValue"])],64))}};export{Se as default};
