import{d as N,r as S,o as d,a9 as y,g as a,bc as j,aU as F,f as c,e,ab as s,aV as v,ae as r,c as i,af as x,ad as m,aa as u,O as w,h as q}from"./index.99fcdda9.js";import{Q as T}from"./QBadge.b9344e7e.js";import{Q as p}from"./QTd.27124c05.js";import{Q as E}from"./QInnerLoading.8030aac6.js";import{Q as L}from"./QTable.622b56ab.js";import{a as P,Q as k,d as $}from"./format.95f9b84a.js";import{Q as U}from"./QList.e7e6854f.js";import{Q as V}from"./QBtnDropdown.f2c943e9.js";import{C}from"./ClosePopup.ff79bbcf.js";import{u as M}from"./useHelpers.b746f64c.js";const z={class:"text-h6 text-center"},G={class:"row q-gutter-sm text-center"},H=e("label",{class:"text-subtitle1 text-weight-medium"}," Num. Comprobantes: ",-1),X=[H],J=e("label",{class:"text-subtitle1 text-weight-medium"},"Clave de Acceso:",-1),K=[J],W={style:{width:"100%","word-wrap":"break-word"}},Y=e("label",{class:"text-subtitle1 text-weight-medium"},"Descripci\xF3n:",-1),Z=[Y],ee=e("label",{class:"text-subtitle1 text-weight-medium"},"Sucursal:",-1),te=[ee],le={class:"text-subtitle1 text-weight-medium"},ae={key:0},se={key:1},oe=e("label",{class:"text-subtitle1 text-weight-medium"},"Usuario:",-1),ce=[oe],re={class:"text-subtitle1 text-weight-medium"},de={key:0},ne={key:1},ie=e("label",{class:"text-subtitle1 text-weight-medium"}," Estado: ",-1),ue=[ie],me={class:"col-xs-12 col-sm-12 q-my-sm"},pe={class:"row"},xe={key:0,class:"col-xs-12 col-sm-6 row items-center"},_e={key:1,class:"col-xs-12 col-sm-6 row items-center"},be={style:{"margin-right":"5px"}},he={class:"text-right"},ye=e("td",null,[e("b",null,"TOTAL BRUTO:")],-1),fe={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},ge={class:"text-right"},De=e("td",{class:""},[e("b",null,"DESCUENTOS:")],-1),ve={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},we={class:"text-right"},qe=e("td",null,[e("b",null,"SUBTOTAL:")],-1),Te={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},Pe={class:"text-right"},ke={class:"q-py-none"},$e={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},Ce={class:"text-right"},Ae={style:{width:"90px"}},Oe={key:2,class:"col-xs-12 row justify-center q-my-sm col-sm-5"},Ue=N({__name:"DetalleProducts",props:{detalleData:{}},setup(A){const t=A,O=[{label:"Codigo",align:"left",name:"codigoBarra"},{label:"Producto",align:"left",name:"product"},{label:"Cantidad",align:"center",field:"cantidad"},{label:"Precio de Venta",align:"center",name:"pvp"},{name:"descuento",label:"Descuento",align:"center"},{name:"iva",label:"Aplica IVA",align:"center"},{name:"total",label:"Total",align:"center"}],{api:Q,claim:R,mostrarNotify:B,formatearNumero:_}=M();let b;t.detalleData.buyToProduct?t.detalleData.isActive?b="Aceptado":b="Anulado":b=t.detalleData.estadoSRI;const f=async(o,n,l="")=>{try{const{data:D}=await Q.post("/invoices/download-ride-xml",{clave_acceso:o,tipo_documento:n,razon_social:R.company.nombre_comercial},{responseType:"arraybuffer"}),I=new Blob([D],{type:n=="ride"||n=="proforma"?"application/pdf":"application/xml"}),h=document.createElement("a");h.href=window.URL.createObjectURL(I),h.download=`${n=="proforma"?l.replace(".pdf",""):t.detalleData.numero_comprobante}${n=="ride"||n=="proforma"?".pdf":".xml"}`,document.body.appendChild(h),h.click(),document.body.removeChild(h)}catch{B("negative","No se encontro el archivo")}},g=S({sortBy:"desc",descending:!1,page:1,rowsPerPage:10,rowsNumber:15});return(o,n)=>(d(),y(F,{style:j(o.$q.screen.width<=1023?"max-width: 92vw;":"max-width: 60vw;")},{default:a(()=>[c(v,{class:"q-pb-none"},{default:a(()=>[e("div",z,s(t.detalleData.buyToProduct?"Detalle de Compra":t.detalleData.estadoSRI=="PROFORMA"?"Detalle de la Proforma":"Detalle de la Factura"),1)]),_:1}),c(v,{class:"q-pb-none q-pt-xs"},{default:a(()=>[e("div",G,[e("div",{class:r(["col-xs-12 col-sm-5",[o.$q.screen.xs?"text-center":"text-right"]])},X,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-sm flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,s(t.detalleData.numero_comprobante),1)],2),t.detalleData.buyToProduct?x("",!0):(d(),i("div",{key:0,class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},K,2)),t.detalleData.buyToProduct?x("",!0):(d(),i("div",{key:1,class:r(["col-xs-12 col-sm-6 q-mt-none flex items-center",[o.$q.screen.xs?"justify-left":"q-ml-lg text-left"]])},[e("label",W,s(t.detalleData.clave_acceso),1)],2)),t.detalleData.buyToProduct?(d(),i("div",{key:2,class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},Z,2)):x("",!0),t.detalleData.buyToProduct?(d(),i("div",{key:3,class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,s(t.detalleData.descripcion),1)],2)):x("",!0),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},te,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,s(t.detalleData.sucursal_id.nombre),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},[e("label",le,s(t.detalleData.buyToProduct?"Proveedor":"Cliente"),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[t.detalleData.buyToProduct?(d(),i("label",ae,s(t.detalleData.proveedor_id.razon_social),1)):(d(),i("label",se,s(t.detalleData.customer_id.nombres),1))],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},ce,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,s(t.detalleData.user_id.fullName.toUpperCase()),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},[e("label",re,s(t.detalleData.buyToProduct?"Fecha de Compra:":"Fecha de Emisi\xF3n:"),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[t.detalleData.buyToProduct?(d(),i("label",de,s(t.detalleData.fecha_compra),1)):(d(),i("label",ne,s(t.detalleData.created_at),1))],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},ue,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[c(T,{outline:"",class:"q-py-xs q-px-md",color:o.$q.dark.isActive?"blue-grey-3":"blue-grey-7",label:m(b)},null,8,["color","label"])],2),e("div",me,[c(L,{style:{"max-height":"300px"},class:r([o.$q.dark.isActive?"":"my-sticky-header-table2"]),rows:t.detalleData.invoiceToProduct?t.detalleData.invoiceToProduct:t.detalleData.buyToProduct,columns:O,pagination:g.value,"onUpdate:pagination":n[0]||(n[0]=l=>g.value=l),"hide-bottom":"","row-key":"name"},{"body-cell-indice":a(l=>[c(p,{props:l},{default:a(()=>[u(s(l.pageIndex+1),1)]),_:2},1032,["props"])]),"body-cell-descuento":a(l=>[c(p,{props:l},{default:a(()=>[u(s(l.row.descuento)+"%",1)]),_:2},1032,["props"])]),"body-cell-product":a(l=>[c(p,{props:l},{default:a(()=>[u(s(l.row.product_id.nombre),1)]),_:2},1032,["props"])]),"body-cell-iva":a(l=>[t.detalleData.buyToProduct?(d(),y(p,{key:0,props:l},{default:a(()=>[u(s(l.row.iva?"SI":"NO"),1)]),_:2},1032,["props"])):(d(),y(p,{key:1},{default:a(()=>[u(s(l.row.product_id.aplicaIva?"SI":"NO"),1)]),_:2},1024))]),"body-cell-total":a(l=>[c(p,{props:l},{default:a(()=>[u(s(l.row.v_total),1)]),_:2},1032,["props"])]),"body-cell-codigoBarra":a(l=>[c(p,{props:l},{default:a(()=>[u(s(l.row.product_id.codigoBarra),1)]),_:2},1032,["props"])]),"body-cell-pvp":a(l=>[c(p,{props:l},{default:a(()=>[u(s(m(_)(parseFloat(l.row.v_total)/parseInt(l.row.cantidad))),1)]),_:2},1032,["props"])]),loading:a(()=>[c(E,{showing:"",color:"primary"})]),_:1},8,["class","rows","pagination"]),e("div",pe,[!o.$q.screen.xs&&m(b)!=="PROFORMA"&&!t.detalleData.buyToProduct?(d(),i("div",xe,[c(V,{class:"q-mr-xs",label:"Descargar Documento",outline:"",color:"primary",icon:"download"},{default:a(()=>[c(U,null,{default:a(()=>[w((d(),y(P,{clickable:"",onClick:n[1]||(n[1]=l=>f(t.detalleData.clave_acceso,"ride"))},{default:a(()=>[c(k,null,{default:a(()=>[c($,null,{default:a(()=>[u("Descargar RIDE")]),_:1})]),_:1})]),_:1})),[[C]]),w((d(),y(P,{onClick:n[2]||(n[2]=l=>f(t.detalleData.clave_acceso,"xml")),clickable:""},{default:a(()=>[c(k,null,{default:a(()=>[c($,null,{default:a(()=>[u("Descargar XML")]),_:1})]),_:1})]),_:1})),[[C]])]),_:1})]),_:1})])):x("",!0),!o.$q.screen.xs&&m(b)=="PROFORMA"?(d(),i("div",_e,[c(q,{onClick:n[3]||(n[3]=l=>f(t.detalleData.name_proforma,"proforma",t.detalleData.name_proforma)),outline:"",rounded:"",style:{color:"#696cff"}},{default:a(()=>[u(" \xA0 DESCARGAR PROFORMA ")]),_:1})])):x("",!0),e("div",{class:r(["col-xs-12",t.detalleData.buyToProduct?"col-sm-12":"col-sm-6"]),style:{display:"flex","justify-content":"end"}},[e("table",be,[e("tr",he,[ye,e("td",fe,s(m(_)(t.detalleData.subtotal)),1)]),e("tr",ge,[De,e("td",ve,s(m(_)(t.detalleData.descuento)),1)]),e("tr",we,[qe,e("td",Te,s(m(_)(parseFloat(t.detalleData.subtotal)-parseFloat(t.detalleData.descuento))),1)]),e("tr",Pe,[e("td",ke,[e("b",null,"IVA("+s(t.detalleData.porcentaje_iva)+"%):",1)]),e("td",$e,s(m(_)(t.detalleData.iva)),1)]),e("tr",Ce,[e("td",null,[e("b",null,s(t.detalleData.buyToProduct?"TOTAL DE COMPRA:":"TOTAL DE VENTA:"),1)]),e("td",Ae,[c(T,{outline:"",class:"text-subtitle1 text-weight-bold",color:"secondary",label:`${m(_)(t.detalleData.total)}`},null,8,["label"])])])])],2),o.$q.screen.xs?(d(),i("div",Oe,[c(q,{type:"submit",label:"Descargar Documento","icon-right":"picture_as_pdf",outline:"",rounded:"",style:{color:"#696cff"},size:"14px"})])):x("",!0)])])])]),_:1})]),_:1},8,["style"]))}});export{Ue as _};
