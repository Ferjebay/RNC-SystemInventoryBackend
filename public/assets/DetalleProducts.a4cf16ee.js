import{d as B,o as d,a9 as p,g as s,bc as I,aU as N,f as c,e,ab as a,aV as f,ae as r,c as i,af as x,ad as h,aa as n,O as g,h as j}from"./index.29f4c737.js";import{Q as D}from"./QBadge.4e28918c.js";import{Q as m}from"./QTd.23ff1cd7.js";import{Q as S}from"./QInnerLoading.1dedf0d2.js";import{Q as E}from"./QTable.1092949f.js";import{a as v,Q as w,d as q}from"./format.32e8bea4.js";import{Q as F}from"./QList.735afe1b.js";import{Q as L}from"./QBtnDropdown.1c68582b.js";import{C as T}from"./ClosePopup.7003054d.js";import{u as R}from"./useHelpers.c99bee56.js";const V={class:"text-h6 text-center"},U={class:"row q-gutter-sm text-center"},z=e("label",{class:"text-subtitle1 text-weight-medium"}," Num. Comprobantes: ",-1),M=[z],H=e("label",{class:"text-subtitle1 text-weight-medium"},"Clave de Acceso:",-1),X=[H],G={style:{width:"100%","word-wrap":"break-word"}},J=e("label",{class:"text-subtitle1 text-weight-medium"},"Descripci\xF3n:",-1),K=[J],W=e("label",{class:"text-subtitle1 text-weight-medium"},"Sucursal:",-1),Y=[W],Z={class:"text-subtitle1 text-weight-medium"},ee={key:0},te={key:1},le=e("label",{class:"text-subtitle1 text-weight-medium"},"Usuario:",-1),se=[le],ae={class:"text-subtitle1 text-weight-medium"},oe={key:0},ce={key:1},re=e("label",{class:"text-subtitle1 text-weight-medium"}," Estado: ",-1),de=[re],ie={class:"col-xs-12 col-sm-12 q-my-sm"},ne={class:"row"},ue={key:0,class:"col-xs-12 col-sm-6 row items-center"},me={style:{"margin-right":"5px"}},_e={class:"text-right"},xe=e("td",null,[e("b",null,"TOTAL BRUTO:")],-1),be={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},pe={class:"text-right"},he=e("td",{class:""},[e("b",null,"DESCUENTOS:")],-1),ye={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},fe={class:"text-right"},ge=e("td",null,[e("b",null,"SUBTOTAL:")],-1),De={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},ve={class:"text-right"},we={class:"q-py-none"},qe={style:{width:"90px"},class:"text-subtitle1 text-weight-regular"},Te={class:"text-right"},ke={style:{width:"90px"}},$e={key:1,class:"col-xs-12 row justify-center q-my-sm col-sm-5"},Ee=B({__name:"DetalleProducts",props:{detalleData:{}},setup(k){const t=k,$=[{label:"Codigo",align:"left",name:"codigoBarra"},{label:"Producto",align:"left",name:"product"},{label:"Cantidad",align:"center",field:"cantidad"},{label:"Precio de Venta",align:"center",name:"pvp"},{name:"descuento",label:"Descuento",align:"center"},{name:"iva",label:"Aplica IVA",align:"center"},{name:"total",label:"Total",align:"center"}],{api:P,claim:C,mostrarNotify:Q,formatearNumero:A}=R();let _;t.detalleData.buyToProduct?t.detalleData.isActive?_="Aceptado":_="Anulado":_=t.detalleData.estadoSRI;const y=async(o,u)=>{try{const{data:l}=await P.post("/invoices/download-ride-xml",{clave_acceso:o,tipo_documento:u,razon_social:C.company.nombre_comercial},{responseType:"arraybuffer"}),O=new Blob([l],{type:u=="ride"?"application/pdf":"application/xml"}),b=document.createElement("a");b.href=window.URL.createObjectURL(O),b.download=`${o}${u=="ride"?".pdf":".xml"}`,document.body.appendChild(b),b.click(),document.body.removeChild(b)}catch{Q("negative","No se encontro el archivo")}};return(o,u)=>(d(),p(N,{style:I(o.$q.screen.width<=1023?"max-width: 92vw;":"max-width: 60vw;")},{default:s(()=>[c(f,{class:"q-pb-none"},{default:s(()=>[e("div",V,a(t.detalleData.buyToProduct?"Detallle de Compra":"Detalle de la Factura/Proforma"),1)]),_:1}),c(f,null,{default:s(()=>[e("div",U,[e("div",{class:r(["col-xs-12 col-sm-5",[o.$q.screen.xs?"text-center":"text-right"]])},M,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-sm flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,a(t.detalleData.numero_comprobante),1)],2),t.detalleData.buyToProduct?x("",!0):(d(),i("div",{key:0,class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},X,2)),t.detalleData.buyToProduct?x("",!0):(d(),i("div",{key:1,class:r(["col-xs-12 col-sm-6 q-mt-none flex items-center",[o.$q.screen.xs?"justify-left":"q-ml-lg text-left"]])},[e("label",G,a(t.detalleData.clave_acceso),1)],2)),t.detalleData.buyToProduct?(d(),i("div",{key:2,class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},K,2)):x("",!0),t.detalleData.buyToProduct?(d(),i("div",{key:3,class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,a(t.detalleData.descripcion),1)],2)):x("",!0),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},Y,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,a(t.detalleData.sucursal_id.nombre),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},[e("label",Z,a(t.detalleData.buyToProduct?"Proveedor":"Cliente"),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[t.detalleData.buyToProduct?(d(),i("label",ee,a(t.detalleData.proveedor_id.razon_social),1)):(d(),i("label",te,a(t.detalleData.customer_id.nombres),1))],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},se,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[e("label",null,a(t.detalleData.user_id.fullName.toUpperCase()),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},[e("label",ae,a(t.detalleData.buyToProduct?"Fecha de Compra:":"Fecha de Emisi\xF3n:"),1)],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[t.detalleData.buyToProduct?(d(),i("label",oe,a(t.detalleData.fecha_compra),1)):(d(),i("label",ce,a(t.detalleData.created_at),1))],2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none",[o.$q.screen.xs?"text-center":"text-right"]])},de,2),e("div",{class:r(["col-xs-12 col-sm-5 q-mt-none flex items-center",[o.$q.screen.xs?"justify-center":"q-ml-lg"]])},[c(D,{outline:"",class:"q-py-xs q-px-md",color:o.$q.dark.isActive?"blue-grey-3":"blue-grey-7",label:h(_)},null,8,["color","label"])],2),e("div",ie,[c(E,{class:r([o.$q.dark.isActive?"":"my-sticky-header-table2"]),rows:t.detalleData.invoiceToProduct?t.detalleData.invoiceToProduct:t.detalleData.buyToProduct,columns:$,"hide-bottom":"","row-key":"name"},{"body-cell-indice":s(l=>[c(m,{props:l},{default:s(()=>[n(a(l.pageIndex+1),1)]),_:2},1032,["props"])]),"body-cell-descuento":s(l=>[c(m,{props:l},{default:s(()=>[n(a(l.row.descuento)+"%",1)]),_:2},1032,["props"])]),"body-cell-product":s(l=>[c(m,{props:l},{default:s(()=>[n(a(l.row.product_id.nombre),1)]),_:2},1032,["props"])]),"body-cell-iva":s(l=>[t.detalleData.buyToProduct?(d(),p(m,{key:0,props:l},{default:s(()=>[n(a(l.row.iva?"SI":"NO"),1)]),_:2},1032,["props"])):(d(),p(m,{key:1},{default:s(()=>[n(a(l.row.product_id.aplicaIva?"SI":"NO"),1)]),_:2},1024))]),"body-cell-total":s(l=>[c(m,{props:l},{default:s(()=>[n(a(l.row.v_total),1)]),_:2},1032,["props"])]),"body-cell-codigoBarra":s(l=>[c(m,{props:l},{default:s(()=>[n(a(l.row.product_id.codigoBarra),1)]),_:2},1032,["props"])]),"body-cell-pvp":s(l=>[c(m,{props:l},{default:s(()=>[n(a(h(A)(parseFloat(l.row.v_total)/parseInt(l.row.cantidad))),1)]),_:2},1032,["props"])]),loading:s(()=>[c(S,{showing:"",color:"primary"})]),_:1},8,["class","rows"]),e("div",ne,[!o.$q.screen.xs&&h(_)!=="PROFORMA"?(d(),i("div",ue,[c(L,{class:"q-mr-xs",label:"Descargar Documento",outline:"",color:"primary",icon:"download"},{default:s(()=>[c(F,null,{default:s(()=>[g((d(),p(v,{clickable:"",onClick:u[0]||(u[0]=l=>y(t.detalleData.clave_acceso,"ride"))},{default:s(()=>[c(w,null,{default:s(()=>[c(q,null,{default:s(()=>[n("Descargar RIDE")]),_:1})]),_:1})]),_:1})),[[T]]),g((d(),p(v,{onClick:u[1]||(u[1]=l=>y(t.detalleData.clave_acceso,"xml")),clickable:""},{default:s(()=>[c(w,null,{default:s(()=>[c(q,null,{default:s(()=>[n("Descargar XML")]),_:1})]),_:1})]),_:1})),[[T]])]),_:1})]),_:1})])):x("",!0),e("div",{class:r(["col-xs-12 col-sm-6",[h(_)=="PROFORMA"?"col-sm-12":"col-sm-5"]]),style:{display:"flex","justify-content":"end"}},[e("table",me,[e("tr",_e,[xe,e("td",be,a(t.detalleData.subtotal),1)]),e("tr",pe,[he,e("td",ye,a(t.detalleData.descuento),1)]),e("tr",fe,[ge,e("td",De,a(parseFloat(t.detalleData.subtotal)-parseFloat(t.detalleData.descuento)),1)]),e("tr",ve,[e("td",we,[e("b",null,"IVA("+a(t.detalleData.porcentaje_iva)+"%):",1)]),e("td",qe,a(t.detalleData.iva),1)]),e("tr",Te,[e("td",null,[e("b",null,a(t.detalleData.buyToProduct?"TOTAL DE COMPRA:":"TOTAL DE VENTA:"),1)]),e("td",ke,[c(D,{outline:"",class:"text-subtitle1 text-weight-bold",color:"secondary",label:`${t.detalleData.total}`},null,8,["label"])])])])],2),o.$q.screen.xs?(d(),i("div",$e,[c(j,{type:"submit",label:"Descargar Documento","icon-right":"picture_as_pdf",outline:"",rounded:"",style:{color:"#696cff"},size:"14px"})])):x("",!0)])])])]),_:1})]),_:1},8,["style"]))}});export{Ee as _};
