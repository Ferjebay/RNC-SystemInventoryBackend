import{Q as $t,a as Me}from"./QBreadcrumbs.ea768e66.js";import{k as wt,t as Ne,r as D,n as G,x as st,C as qt,bH as rt,O as ae,a8 as fe,p as X,ap as Xe,ao as xt,bh as Ct,i as oe,N as It,z as Le,bd as kt,aJ as Vt,m as Te,ax as Oe,X as et,v as Pe,a2 as At,L as Pt,M as Dt,s as nt,I as St,J as Tt,$ as Rt,o as y,a9 as P,g as a,e,ae as k,f as t,Q as ee,ad as b,ab as I,h as Q,aa as x,c as re,af as J,aR as be,aS as ge,ah as Ce,aV as Ue,aj as De,bt as Qe,a7 as Et,bq as Ft,bI as Mt,bJ as Nt,w as Ot,ai as Ut,aK as Lt,aU as tt}from"./index.d6c4bdc6.js";import{u as Ie}from"./useCliente.e1731374.js";import{u as Qt,a as jt,b as Bt,c as Yt,e as he,d as zt,_ as Gt}from"./ServicioInternet.acf6a0c1.js";import{Q as Ht}from"./QResizeObserver.af6c534d.js";import{r as Kt,Q as Se}from"./QSelect.a8a1d697.js";import{Q as ie}from"./QBadge.dade6de9.js";import{Q as ke}from"./QForm.18dc3b57.js";import{d as z}from"./date.6bb37875.js";import{Q as je,a as Y}from"./QTable.841f7159.js";import{a as _e,Q as at}from"./QTooltip.a288d9b7.js";import{C as we}from"./ClosePopup.ce0f6283.js";import{a as me,Q as se,c as ne}from"./QItemLabel.1ee9546f.js";import{Q as Wt}from"./QList.ed89e0ad.js";import{Q as ot}from"./QDate.dd5f33e5.js";import{Q as lt}from"./QPopupProxy.59f3ce1c.js";import{M as Zt}from"./index.2065a85c.js";import"./useHelpers.0a8a684c.js";import"./use-quasar.293c2d69.js";import"./axios.465f24f1.js";import"./touch.3df10340.js";import"./QChip.f02742be.js";import"./ModalMapBox.8908603a.js";import"./QBtnGroup.227f3910.js";import"./format.cbf00d5d.js";let Jt=0;const Xt=["click","keydown"],ea={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${Jt++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function ta(s,h,l,u){const d=wt(rt,Ne);if(d===Ne)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Ne;const{proxy:S}=Le(),N=D(null),R=D(null),F=D(null),T=G(()=>s.disable===!0||s.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},s.ripple===!0?{}:s.ripple)),O=G(()=>d.currentModel.value===s.name),o=G(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(O.value===!0?" q-tab--active"+(d.tabProps.value.activeClass?" "+d.tabProps.value.activeClass:"")+(d.tabProps.value.activeColor?` text-${d.tabProps.value.activeColor}`:"")+(d.tabProps.value.activeBgColor?` bg-${d.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(s.icon&&s.label&&d.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(s.noCaps===!0||d.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(s.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(u!==void 0?u.linkClass.value:"")),i=G(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(d.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(s.contentClass!==void 0?` ${s.contentClass}`:"")),p=G(()=>s.disable===!0||d.hasFocus.value===!0||O.value===!1&&d.hasActiveTab.value===!0?-1:s.tabindex||0);function w(c,n){if(n!==!0&&N.value!==null&&N.value.focus(),s.disable===!0){u!==void 0&&u.hasRouterLink.value===!0&&Xe(c);return}if(u===void 0){d.updateModel({name:s.name}),l("click",c);return}if(u.hasRouterLink.value===!0){const v=(r={})=>{let f;const E=r.to===void 0||kt(r.to,s.to)===!0?d.avoidRouteWatcher=Vt():null;return u.navigateToRouterLink(c,{...r,returnRouterError:!0}).catch(L=>{f=L}).then(L=>{if(E===d.avoidRouteWatcher&&(d.avoidRouteWatcher=!1,f===void 0&&(L===void 0||L.message.startsWith("Avoided redundant navigation")===!0)&&d.updateModel({name:s.name})),r.returnRouterError===!0)return f!==void 0?Promise.reject(f):L})};l("click",c,v),c.defaultPrevented!==!0&&v();return}l("click",c)}function U(c){xt(c,[13,32])?w(c,!0):Ct(c)!==!0&&c.keyCode>=35&&c.keyCode<=40&&c.altKey!==!0&&c.metaKey!==!0&&d.onKbdNavigate(c.keyCode,S.$el)===!0&&Xe(c),l("keydown",c)}function W(){const c=d.tabProps.value.narrowIndicator,n=[],v=X("div",{ref:F,class:["q-tab__indicator",d.tabProps.value.indicatorClass]});s.icon!==void 0&&n.push(X(oe,{class:"q-tab__icon",name:s.icon})),s.label!==void 0&&n.push(X("div",{class:"q-tab__label"},s.label)),s.alert!==!1&&n.push(s.alertIcon!==void 0?X(oe,{class:"q-tab__alert-icon",color:s.alert!==!0?s.alert:void 0,name:s.alertIcon}):X("div",{class:"q-tab__alert"+(s.alert!==!0?` text-${s.alert}`:"")})),c===!0&&n.push(v);const r=[X("div",{class:"q-focus-helper",tabindex:-1,ref:N}),X("div",{class:i.value},It(h.default,n))];return c===!1&&r.push(v),r}const te={name:G(()=>s.name),rootRef:R,tabIndicatorRef:F,routeData:u};st(()=>{d.unregisterTab(te)}),qt(()=>{d.registerTab(te)});function V(c,n){const v={ref:R,class:o.value,tabindex:p.value,role:"tab","aria-selected":O.value===!0?"true":"false","aria-disabled":s.disable===!0?"true":void 0,onClick:w,onKeydown:U,...n};return ae(X(c,v,W()),[[fe,T.value]])}return{renderTab:V,$tabs:d}}var qe=Te({name:"QTab",props:ea,emits:Xt,setup(s,{slots:h,emit:l}){const{renderTab:u}=ta(s,h,l);return()=>u("div")}});function aa(s,h,l){const u=l===!0?["left","right"]:["top","bottom"];return`absolute-${h===!0?u[0]:u[1]}${s?` text-${s}`:""}`}const oa=["left","center","right","justify"];var it=Te({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:s=>oa.includes(s)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(s,{slots:h,emit:l}){const{proxy:u}=Le(),{$q:d}=u,{registerTick:S}=Oe(),{registerTick:N}=Oe(),{registerTick:R}=Oe(),{registerTimeout:F,removeTimeout:T}=et(),{registerTimeout:O,removeTimeout:o}=et(),i=D(null),p=D(null),w=D(s.modelValue),U=D(!1),W=D(!0),te=D(!1),V=D(!1),c=[],n=D(0),v=D(!1);let r=null,f=null,E;const L=G(()=>({activeClass:s.activeClass,activeColor:s.activeColor,activeBgColor:s.activeBgColor,indicatorClass:aa(s.indicatorColor,s.switchIndicator,s.vertical),narrowIndicator:s.narrowIndicator,inlineLabel:s.inlineLabel,noCaps:s.noCaps})),$=G(()=>{const m=n.value,g=w.value;for(let q=0;q<m;q++)if(c[q].name.value===g)return!0;return!1}),C=G(()=>`q-tabs__content--align-${U.value===!0?"left":V.value===!0?"justify":s.align}`),_=G(()=>`q-tabs row no-wrap items-center q-tabs--${U.value===!0?"":"not-"}scrollable q-tabs--${s.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${s.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${s.mobileArrows===!0?"":"out"}-arrows`+(s.dense===!0?" q-tabs--dense":"")+(s.shrink===!0?" col-shrink":"")+(s.stretch===!0?" self-stretch":"")),H=G(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+C.value+(s.contentClass!==void 0?` ${s.contentClass}`:"")),K=G(()=>s.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),le=G(()=>s.vertical!==!0&&d.lang.rtl===!0),$e=G(()=>Kt===!1&&le.value===!0);Pe(le,pe),Pe(()=>s.modelValue,m=>{Re({name:m,setCurrent:!0,skipEmit:!0})}),Pe(()=>s.outsideArrows,Ve);function Re({name:m,setCurrent:g,skipEmit:q}){w.value!==m&&(q!==!0&&s["onUpdate:modelValue"]!==void 0&&l("update:modelValue",m),(g===!0||s["onUpdate:modelValue"]===void 0)&&(dt(w.value,m),w.value=m))}function Ve(){S(()=>{Be({width:i.value.offsetWidth,height:i.value.offsetHeight})})}function Be(m){if(K.value===void 0||p.value===null)return;const g=m[K.value.container],q=Math.min(p.value[K.value.scroll],Array.prototype.reduce.call(p.value.children,(B,M)=>B+(M[K.value.content]||0),0)),j=g>0&&q>g;U.value=j,j===!0&&N(pe),V.value=g<parseInt(s.breakpoint,10)}function dt(m,g){const q=m!=null&&m!==""?c.find(B=>B.name.value===m):null,j=g!=null&&g!==""?c.find(B=>B.name.value===g):null;if(q&&j){const B=q.tabIndicatorRef.value,M=j.tabIndicatorRef.value;r!==null&&(clearTimeout(r),r=null),B.style.transition="none",B.style.transform="none",M.style.transition="none",M.style.transform="none";const A=B.getBoundingClientRect(),Z=M.getBoundingClientRect();M.style.transform=s.vertical===!0?`translate3d(0,${A.top-Z.top}px,0) scale3d(1,${Z.height?A.height/Z.height:1},1)`:`translate3d(${A.left-Z.left}px,0,0) scale3d(${Z.width?A.width/Z.width:1},1,1)`,R(()=>{r=setTimeout(()=>{r=null,M.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",M.style.transform="none"},70)})}j&&U.value===!0&&ve(j.rootRef.value)}function ve(m){const{left:g,width:q,top:j,height:B}=p.value.getBoundingClientRect(),M=m.getBoundingClientRect();let A=s.vertical===!0?M.top-j:M.left-g;if(A<0){p.value[s.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(A),pe();return}A+=s.vertical===!0?M.height-B:M.width-q,A>0&&(p.value[s.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(A),pe())}function pe(){const m=p.value;if(m===null)return;const g=m.getBoundingClientRect(),q=s.vertical===!0?m.scrollTop:Math.abs(m.scrollLeft);le.value===!0?(W.value=Math.ceil(q+g.width)<m.scrollWidth-1,te.value=q>0):(W.value=q>0,te.value=s.vertical===!0?Math.ceil(q+g.height)<m.scrollHeight:Math.ceil(q+g.width)<m.scrollWidth)}function Ye(m){f!==null&&clearInterval(f),f=setInterval(()=>{vt(m)===!0&&de()},5)}function ze(){Ye($e.value===!0?Number.MAX_SAFE_INTEGER:0)}function Ge(){Ye($e.value===!0?0:Number.MAX_SAFE_INTEGER)}function de(){f!==null&&(clearInterval(f),f=null)}function ut(m,g){const q=Array.prototype.filter.call(p.value.children,Z=>Z===g||Z.matches&&Z.matches(".q-tab.q-focusable")===!0),j=q.length;if(j===0)return;if(m===36)return ve(q[0]),q[0].focus(),!0;if(m===35)return ve(q[j-1]),q[j-1].focus(),!0;const B=m===(s.vertical===!0?38:37),M=m===(s.vertical===!0?40:39),A=B===!0?-1:M===!0?1:void 0;if(A!==void 0){const Z=le.value===!0?-1:1,ce=q.indexOf(g)+A*Z;return ce>=0&&ce<j&&(ve(q[ce]),q[ce].focus({preventScroll:!0})),!0}}const mt=G(()=>$e.value===!0?{get:m=>Math.abs(m.scrollLeft),set:(m,g)=>{m.scrollLeft=-g}}:s.vertical===!0?{get:m=>m.scrollTop,set:(m,g)=>{m.scrollTop=g}}:{get:m=>m.scrollLeft,set:(m,g)=>{m.scrollLeft=g}});function vt(m){const g=p.value,{get:q,set:j}=mt.value;let B=!1,M=q(g);const A=m<M?-1:1;return M+=A*5,M<0?(B=!0,M=0):(A===-1&&M<=m||A===1&&M>=m)&&(B=!0,M=m),j(g,M),pe(),B}function He(m,g){for(const q in m)if(m[q]!==g[q])return!1;return!0}function pt(){let m=null,g={matchedLen:0,queryDiff:9999,hrefLen:0};const q=c.filter(A=>A.routeData!==void 0&&A.routeData.hasRouterLink.value===!0),{hash:j,query:B}=u.$route,M=Object.keys(B).length;for(const A of q){const Z=A.routeData.exact.value===!0;if(A.routeData[Z===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:ce,query:Ee,matched:ht,href:yt}=A.routeData.resolvedLink.value,Fe=Object.keys(Ee).length;if(Z===!0){if(ce!==j||Fe!==M||He(B,Ee)===!1)continue;m=A.name.value;break}if(ce!==""&&ce!==j||Fe!==0&&He(Ee,B)===!1)continue;const ue={matchedLen:ht.length,queryDiff:M-Fe,hrefLen:yt.length-ce.length};if(ue.matchedLen>g.matchedLen){m=A.name.value,g=ue;continue}else if(ue.matchedLen!==g.matchedLen)continue;if(ue.queryDiff<g.queryDiff)m=A.name.value,g=ue;else if(ue.queryDiff!==g.queryDiff)continue;ue.hrefLen>g.hrefLen&&(m=A.name.value,g=ue)}m===null&&c.some(A=>A.routeData===void 0&&A.name.value===w.value)===!0||Re({name:m,setCurrent:!0})}function ft(m){if(T(),v.value!==!0&&i.value!==null&&m.target&&typeof m.target.closest=="function"){const g=m.target.closest(".q-tab");g&&i.value.contains(g)===!0&&(v.value=!0,U.value===!0&&ve(g))}}function _t(){F(()=>{v.value=!1},30)}function Ae(){We.avoidRouteWatcher===!1?O(pt):o()}function Ke(){if(E===void 0){const m=Pe(()=>u.$route.fullPath,Ae);E=()=>{m(),E=void 0}}}function gt(m){c.push(m),n.value++,Ve(),m.routeData===void 0||u.$route===void 0?O(()=>{if(U.value===!0){const g=w.value,q=g!=null&&g!==""?c.find(j=>j.name.value===g):null;q&&ve(q.rootRef.value)}}):(Ke(),m.routeData.hasRouterLink.value===!0&&Ae())}function bt(m){c.splice(c.indexOf(m),1),n.value--,Ve(),E!==void 0&&m.routeData!==void 0&&(c.every(g=>g.routeData===void 0)===!0&&E(),Ae())}const We={currentModel:w,tabProps:L,hasFocus:v,hasActiveTab:$,registerTab:gt,unregisterTab:bt,verifyRouteModel:Ae,updateModel:Re,onKbdNavigate:ut,avoidRouteWatcher:!1};At(rt,We);function Ze(){r!==null&&clearTimeout(r),de(),E!==void 0&&E()}let Je;return st(Ze),Pt(()=>{Je=E!==void 0,Ze()}),Dt(()=>{Je===!0&&Ke(),Ve()}),()=>X("div",{ref:i,class:_.value,role:"tablist",onFocusin:ft,onFocusout:_t},[X(Ht,{onResize:Be}),X("div",{ref:p,class:H.value,onScroll:pe},nt(h.default)),X(oe,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(W.value===!0?"":" q-tabs__arrow--faded"),name:s.leftIcon||d.iconSet.tabs[s.vertical===!0?"up":"left"],onMousedownPassive:ze,onTouchstartPassive:ze,onMouseupPassive:de,onMouseleavePassive:de,onTouchendPassive:de}),X(oe,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(te.value===!0?"":" q-tabs__arrow--faded"),name:s.rightIcon||d.iconSet.tabs[s.vertical===!0?"down":"right"],onMousedownPassive:Ge,onTouchstartPassive:Ge,onMouseupPassive:de,onMouseleavePassive:de,onTouchendPassive:de})])}}),xe=Te({name:"QTabPanel",props:Qt,setup(s,{slots:h}){return()=>X("div",{class:"q-tab-panel",role:"tabpanel"},nt(h.default))}}),ct=Te({name:"QTabPanels",props:{...jt,...St},emits:Bt,setup(s,{slots:h}){const l=Le(),u=Tt(s,l.proxy.$q),{updatePanelsList:d,getPanelContent:S,panelDirectives:N}=Yt(),R=G(()=>"q-tab-panels q-panel-parent"+(u.value===!0?" q-tab-panels--dark q-dark":""));return()=>(d(h),Rt("div",{class:R.value},S(),"pan",s.swipeable,()=>N.value))}});const la={class:"my-card"},sa={class:"q-pt-none"},ra={class:"row q-pt-sm"},na={class:"col-xs-12 col-md-7"},ia={class:"row"},ca=e("div",{class:"col-11 flex justify-start items-center"},[e("label",{class:"text-h6 text-weight-medium"}," >> Datos del Cliente:")],-1),da={class:"col-xs-12 col-md-6 col-sm-6"},ua={class:"col-xs-12 col-md-6 col-sm-6"},ma={class:"col-xs-12 col-md-6 col-sm-6"},va={class:"col-xs-12 col-md-6 col-sm-6"},pa={class:"col-xs-12 col-md-6 col-sm-6"},fa={class:"col-xs-12 col-md-6 col-sm-6"},_a={class:"col-xs-11 col-md-5"},ga={class:"row q-col-gutter-sm q-col-gutter-y-md"},ba=e("label",{class:"text-h6 text-weight-medium"}," >> Resumen Notificaciones:",-1),ha=[ba],ya={class:"col-xs-12 col-md-6"},$a={style:{display:"flex"}},wa={style:{width:"30%"},class:"q-mr-xs q-ml-md"},qa={style:{width:"70%","text-align":"left"}},xa=e("br",null,null,-1),Ca=e("div",null,"D\xEDa de pago",-1),Ia={class:"col-xs-12 col-md-6"},ka={style:{display:"flex"}},Va={style:{width:"30%"},class:"q-mr-xs q-ml-md"},Aa={style:{width:"70%","text-align":"left"}},Pa=e("br",null,null,-1),Da=e("div",null,"Crear Factura",-1),Sa={class:"col-xs-12 col-md-6"},Ta={style:{display:"flex"}},Ra={style:{width:"30%"},class:"q-mr-xs q-ml-md"},Ea={style:{width:"70%","text-align":"left"}},Fa=e("br",null,null,-1),Ma=e("div",null,"D\xEDa de corte",-1),Na={class:"row justify-center q-mt-md"},Oa={__name:"ResumenPage",setup(s){const{api:h,mostrarNotify:l,formCliente:u,validaciones:d,validarDatosPersonales:S}=Ie(),{dia_pago:N,dia_corte:R,dia_crear_factura:F}=he(),T=D(!1),O=async()=>{if(!S())try{T.value=!0;const{planInternet:i,created_at:p,updated_at:w,...U}=u.value,{data:W}=await h.put(`/customers/actualizarDatosPersonales/${u.value.id}`,U);u.value={...W.cliente[0]},l("positive",W.msg),T.value=!1}catch(i){T.value=!1,l("warning",i.response.data.message)}};return(o,i)=>(y(),P(ke,{onSubmit:O},{default:a(()=>[e("div",la,[e("div",sa,[e("div",ra,[e("div",na,[e("div",ia,[ca,e("div",{class:k(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:k(o.$q.screen.width<1022||"q-pr-md")}," Cliente: ",2)],2),e("div",da,[t(ee,{modelValue:b(u).nombres,"onUpdate:modelValue":[i[0]||(i[0]=p=>b(u).nombres=p),i[1]||(i[1]=p=>(b(u).nombres=b(u).nombres.toUpperCase(),b(d).nombres.isValid=!0))],modelModifiers:{trim:!0},error:!b(d).nombres.isValid,"input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:k(o.$q.dark.isActive?"text-red-4":"text-negative")},I(b(d).nombres.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:k(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:k(o.$q.screen.width<1022||"q-pr-md")}," Email: ",2)],2),e("div",ua,[t(ee,{modelValue:b(u).email,"onUpdate:modelValue":i[2]||(i[2]=p=>b(u).email=p),modelModifiers:{trim:!0},error:!b(d).email.isValid,"input-class":"resaltarTextoInput",onKeyup:i[3]||(i[3]=p=>b(d).email.isValid=!0),dense:"",outlined:""},{error:a(()=>[e("label",{class:k(o.$q.dark.isActive?"text-red-4":"text-negative")},I(b(d).email.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:k(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:k(o.$q.screen.width<1022||"q-pr-md")}," Celular: ",2)],2),e("div",ma,[t(ee,{type:o.$q.platform.is.mobile?"number":"text",modelValue:b(u).celular,"onUpdate:modelValue":i[4]||(i[4]=p=>b(u).celular=p),modelModifiers:{trim:!0},counter:"",maxlength:"10","input-class":"resaltarTextoInput",error:!b(d).celular.isValid,onKeyup:i[5]||(i[5]=p=>(b(d).celular.isValid=!0,b(u).celular=b(u).celular.replace(/\D/g,""))),dense:"",outlined:""},{error:a(()=>[e("label",{class:k(o.$q.dark.isActive?"text-red-4":"text-negative")},I(b(d).celular.message),3)]),_:1},8,["type","modelValue","error"])]),e("div",{class:k(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:k(o.$q.screen.width<1022||"q-pr-md")}," Direcci\xF3n: ",2)],2),e("div",va,[t(ee,{modelValue:b(u).direccion,"onUpdate:modelValue":i[6]||(i[6]=p=>b(u).direccion=p),error:!b(d).direccion.isValid,"input-class":"resaltarTextoInput",onKeyup:i[7]||(i[7]=p=>b(d).direccion.isValid=!0),dense:"",outlined:""},{error:a(()=>[e("label",{class:k(o.$q.dark.isActive?"text-red-4":"text-negative")},I(b(d).direccion.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:k(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:k(o.$q.screen.width<1022||"q-pr-md")}," Tipo de Documento: ",2)],2),e("div",pa,[t(Se,{dense:"",modelValue:b(u).tipo_documento,"onUpdate:modelValue":[i[8]||(i[8]=p=>b(u).tipo_documento=p),i[9]||(i[9]=p=>b(d).tipo_documento.isValid=!0)],modelModifiers:{trim:!0},outlined:"",error:!b(d).tipo_documento.isValid,"emit-value":"","map-options":"",options:[{label:"RUC",value:"04"},{label:"Cedula",value:"05"},{label:"Pasaporte",value:"06"}]},{error:a(()=>[e("label",{class:k(o.$q.dark.isActive?"text-red-4":"text-negative")},I(b(d).tipo_documento.message),3)]),_:1},8,["modelValue","error"])]),e("div",{class:k(["col-xs-12 col-md-4 flex items-center",[o.$q.screen.width<1022?"justify-center q-mt-sm q-pb-xs":"justify-end"]])},[e("label",{class:k(o.$q.screen.width<1022||"q-pr-md")}," N. Identificaci\xF3n: ",2)],2),e("div",fa,[t(ee,{type:o.$q.platform.is.mobile?"number":"text",modelValue:b(u).numero_documento,"onUpdate:modelValue":i[10]||(i[10]=p=>b(u).numero_documento=p),readonly:b(u).tipo_documento==="","input-class":"resaltarTextoInput",counter:"",maxlength:b(u).tipo_documento==="04"?13:10,error:!b(d).numero_documento.isValid,onKeyup:i[11]||(i[11]=p=>(b(d).numero_documento.isValid=!0,b(u).numero_documento=b(u).numero_documento.replace(/\D/g,""))),dense:"",outlined:""},{error:a(()=>[e("label",{class:k(o.$q.dark.isActive?"text-red-4":"text-negative")},I(b(d).numero_documento.message),3)]),_:1},8,["type","modelValue","readonly","maxlength","error"])])])]),e("div",_a,[e("div",ga,[e("div",{class:k(["col-11 flex justify-start items-center",[o.$q.screen.xs?"q-my-md":""]])},ha,2),e("div",ya,[e("div",null,[t(ie,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:o.$q.dark.isActive?"indigo-6":"indigo-8",filled:""},{default:a(()=>[e("div",$a,[e("div",wa,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",qa,[e("div",null,I(b(N)),1),xa,Ca])])]),_:1},8,["color"])])]),e("div",Ia,[e("div",null,[t(ie,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:(o.$q.dark.isActive,"orange-9"),filled:""},{default:a(()=>[e("div",ka,[e("div",Va,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",Aa,[e("div",null,I(b(z).formatDate(b(F),"DD/MM/YYYY"))+" 12:00 AM",1),Pa,Da])])]),_:1},8,["color"])])]),e("div",Sa,[e("div",null,[t(ie,{class:"text-center q-py-sm",style:{width:"100%","text-align":"center","font-size":"15px",display:"block"},color:o.$q.dark.isActive?"red-7":"red-9",filled:""},{default:a(()=>[e("div",Ta,[e("div",Ra,[t(oe,{name:"calendar_month",style:{"font-size":"32px"}})]),e("div",Ea,[e("div",null,I(b(R)),1),Fa,Ma])])]),_:1},8,["color"])])])])])])]),e("div",Na,[e("div",{class:k(["q-pb-md",[o.$q.screen.width>600||" q-ml-lg"]])},[t(Q,{type:"submit",icon:"save",loading:T.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Guardar Cambios ")]),_:1},8,["loading"])],2)])])]),_:1}))}};const Ua={class:"my-card"},La={class:"q-pt-none"},Qa={class:"row q-pt-sm"},ja={class:"col-12"},Ba={class:"row"},Ya=e("label",{class:"text-h6 text-weight-medium"}," >> Servicios de Internet:",-1),za={class:"text-h6 text-weight-medium"},Ga={class:"col-12 q-mt-md"},Ha={class:"text-h6 text-center"},Ka={__name:"ServiciosPage",setup(s){const h=[{name:"cont",label:"#",align:"center"},{name:"nombre_plan",align:"center",label:"Plan",field:"nombre_plan"},{name:"precio",label:"Costo",field:"precio",align:"center"},{name:"ipv4",label:"IP",field:"ipv4",align:"center"},{name:"router",label:"Router",field:"router",align:"center"},{name:"fecha_instalacion",label:"Instalado",field:"fecha_instalacion",align:"center"},{name:"direccion",label:"Direcci\xF3n",field:"direccion",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}],{api:l,client_name:u,route:d,servicios:S,mostrarNotify:N}=he();Ie();const R=D([]),F=D(!1),T=D(null);R.value=S.value;const O=async()=>{F.value=!1,T.value=null,S.value=[];const{data:i}=await l.get("/customers/find/"+d.params.client_id);i[0].planInternet.forEach(p=>{S.value.push({detalles:{...p,cliente:u.value},servicio_id:p.id,precio:p.precio,direccion:`${p.direccion==""?"- - - - -":p.direccion}`,fecha_instalacion:p.fecha_instalacion,ipv4:p.ipv4,nombre_plan:p.perfil_internet.nombre_plan,router:p.router_id.nombre,estado:`${p.isActive?"Activo":"Inactivo"}`})}),R.value=S.value},o=async(i,p)=>{Qe.create({title:`<div class="text-center">
              <i class="fa-regular fa-circle-question"></i>
                ${p=="activar"?"Activar Servicio":"Suspender Servicio"}
            </div>`,message:`<div class="text-center">                  
                  \xBFEstas seguro que deseas ${p=="activar"?"activar":"suspender"} el servicio al cliente?
              </div>
              <div class="text-center">                  
                ${i.detalles.cliente}
              </div>`,html:!0,ok:{push:!0,label:`Si, ${p=="activar"?"Activar":"Suspender"}`,color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{const{data:w}=await l.put(`/customers/activeOrSuspendService/${i.detalles.id}`,{router:i.detalles.router_id,address_list:i.detalles.perfil_internet.address_list,ipv4:i.detalles.ipv4,estado:p});N("positive",`El cliente fue ${p=="activar"?" activado":"suspendido"}`),O()}catch(w){N("negative",w.response.data.message)}})};return(i,p)=>(y(),re(De,null,[t(ke,{onSubmit:p[0]||(p[0]=()=>{})},{default:a(()=>[e("div",Ua,[e("div",La,[e("div",Qa,[e("div",ja,[e("div",Ba,[e("div",{class:k(["col-12 flex items-center",i.$q.screen.xs?"justify-center":"justify-between"])},[Ya,e("label",za,[t(Q,{outline:"",color:"primary",label:"Agregar Servicio",class:k(["q-mr-xs",!i.$q.screen.xs||"q-mt-sm"])},null,8,["class"])])],2),e("div",Ga,[t(je,{rows:R.value,columns:h,class:k([i.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50],"row-key":"name"},{"body-cell-cont":a(w=>[t(Y,{props:w},{default:a(()=>[x(I(w.rowIndex+1),1)]),_:2},1032,["props"])]),"body-cell-estado":a(w=>[t(Y,{props:w},{default:a(()=>[w.row.estado=="Activo"?(y(),P(ie,{key:0,outline:"",color:"positive",label:"Activo",class:"q-pa-sm"})):(y(),P(ie,{key:1,outline:"",color:"red",label:"Inactivo",class:"q-pa-sm"}))]),_:2},1032,["props"])]),"body-cell-acciones":a(w=>[t(Y,{props:w},{default:a(()=>[w.row.estado!=="Inactivo"?(y(),P(Q,{key:0,round:"",color:"blue-grey",onClick:U=>(T.value={...w.row.detalles,estado:w.row.estado},F.value=!0),icon:"edit",class:"q-mr-sm",size:"10px"},null,8,["onClick"])):J("",!0),w.row.estado!=="Inactivo"?(y(),P(Q,{key:1,round:"",color:"blue-grey",onClick:U=>o(w.row,"inactivar"),icon:"power_settings_new",class:"q-mr-sm",size:"10px"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Suspender ")]),_:1})]),_:2},1032,["onClick"])):(y(),P(Q,{key:2,round:"",color:"blue-grey",onClick:U=>o(w.row,"activar"),icon:"check_circle",class:"q-mr-sm",size:"10px"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Activar ")]),_:1})]),_:2},1032,["onClick"]))]),_:2},1032,["props"])]),_:1},8,["rows","class"])])])])])])])]),_:1}),t(Ue,{modelValue:F.value,"onUpdate:modelValue":p[1]||(p[1]=w=>F.value=w)},{default:a(()=>[t(be,{style:{width:"900px","max-width":"80vw"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",Ha,[x(" Editar Servicio "),ae(t(Q,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[we]])])]),_:1}),t(Ce,{class:"q-mb-md",inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(zt,{servicio:T.value,edit:!0,onActualizarDatos:O},null,8,["servicio"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Wa={__name:"ConfiguracionPage",setup(s){return(h,l)=>(y(),P(Gt,{edit:!0}))}},Za=()=>({imprimirAbono:(l,u,d,S)=>`
    <html>
    <head>
      <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
      <meta name="viewport" content="width=device-width, initial" />
      <style>
        th, td {
          text-align: center;
          white-space: nowrap; /* Omitir espacios en blanco */
        }
      </style>
    </head>
      <body>
        <table border="0" align="center" style="font-size: 8px; width: 230px;">
          <tbody>
            <tr>
              <td>
                <pre>    ${l.company_name}         -</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>       R.U.C.: ${l.ruc}         </pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Direccion: ${l.direccion}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Fecha: ${l.fecha_abono}          Hora: ${l.hora_abono}</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>Cliente: ${u.cliente}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>${u.tipo_documento=="05"?"Cedula:":"R.U.C:"}: ${u.num_doc}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Correo: ${u.email}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>----------------------------------------</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Cant.         Servicio             Total</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>----------------------------------------</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>1     Servicio de Internet        $${(parseFloat(l.monto_pendiente)+parseFloat(l.totalAbonado)).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                        IVA(12%): $00.00</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                       Descuento: $00.00</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                   Valor Abonado: $${parseFloat(l.valor).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                   Total Abonado: $${parseFloat(l.totalAbonado).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                 Valor pendiente: $${parseFloat(l.monto_pendiente).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>      Forma de Pago:</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>  ${l.forma_pago}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Atentido Por: ${d}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Gracias por su Compra</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>-</pre>
              </td>
            </tr>
        </table>
      </body>
    </html>
    `,imprimirFactura:(l,u,d,S)=>`
    <html>
    <head>
      <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
      <meta name="viewport" content="width=device-width, initial" />
      <style>
        th, td {
          text-align: center;
          white-space: nowrap; /* Omitir espacios en blanco */
        }
      </style>
    </head>
      <body>
        <table border="0" align="center" style="font-size: 8px; width: 230px;">
          <tbody>
            <tr>
              <td>
                <pre>    ${l.company_name}         -</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>       R.U.C.: ${l.ruc}         </pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Direccion: ${l.direccion}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Ambiente: PRUEBA         Emision: NORMAL</pre>
              </td>
            </tr>   
            <tr>
              <td>
                <pre>Fecha: ${l.pagos[l.pagos.length-1].fecha_abono}          Hora: ${l.pagos[l.pagos.length-1].hora_abono}</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>Num. Comprobante: ${l.num_comprobante}</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>Clave Acceso:</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>${l.clave_acceso}</pre>
              </td>
            </tr>     
            <tr>
              <td>
                <pre>Cliente: ${u.cliente}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>${u.tipo_documento=="05"?"Cedula:":"R.U.C:"}: ${u.num_doc}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Correo: ${u.email}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>----------------------------------------</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Cant.         Servicio             Total</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>----------------------------------------</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>1     Servicio de Internet        $${parseFloat(l.precio).toFixed(2)}</pre>
              </td>
            </tr>
            <tr>
              <td>
              <pre>                        Subtotal: $${l.precio}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                        IVA(12%): $00.00</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>                       Descuento: $00.00</pre>
              </td>
            </tr>
            <tr>
              <td>
              <pre>                           Total: $${l.precio}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>      Forma de Pago:</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>SIN UTILIZACION DEL SISTEMA FINANCIERO</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Atentido Por: ${d}</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>Gracias por su Compra</pre>
              </td>
            </tr>
            <tr>
              <td>
                <pre>-</pre>
              </td>
            </tr>
        </table>
      </body>
    </html>
    `});const ye=s=>(Mt("data-v-137f4dea"),s=s(),Nt(),s),Ja={class:"text-h6 text-center"},Xa={class:"row q-pt-lg q-gutter-lg justify-center"},eo={class:"col-12"},to=ye(()=>e("label",null,"Forma de pago:",-1)),ao={class:"col-12 q-mt-sm"},oo=ye(()=>e("label",null,"N\xBA transacci\xF3n:",-1)),lo={key:0,class:"col-12 q-mt-sm"},so=ye(()=>e("label",null,"Pagar Importe Total:",-1)),ro={class:"col-12 q-mt-sm"},no={key:1,class:"col-12 q-mt-sm"},io=ye(()=>e("label",null,"Monto Pendiente:",-1)),co={key:2,class:"col-12 q-mt-sm"},uo=ye(()=>e("label",null,"Sucursal a Facturar:",-1)),mo={class:"col-12 q-mt-none"},vo=ye(()=>e("label",null,"Notas:",-1)),po={class:"col-xs-9 col-sm-12 q-mt-lg q-mb-md flex justify-center"},fo={__name:"ModalPago",props:["servicio","nuevoPago"],emits:["actualizarDatos"],setup(s,{emit:h}){const l=s,u=["forma_pago","montoPendiente","montoCancelar"],{api:d,claim:S,mostrarNotify:N,route:R}=Ie(),{showModalPago:F}=he(),T=D([]),O=D(!1),o=D({forma_pago:"",n_transaccion:"",importe_total:!0,sucursal_id:"",montoCancelar:"",montoPendiente:"",detalle:""}),i=D({forma_pago:{message:"",isValid:!0},montoPendiente:{message:"",isValid:!0},montoCancelar:{message:"",isValid:!0},sucursal_id:{message:"",isValid:!0}});if(l.nuevoPago)if(l.servicio.pagos.length==0)o.value.montoPendiente=l.servicio.precio,o.value.montoCancelar=l.servicio.precio;else{let V=0;l.servicio.pagos.forEach(n=>{V+=parseFloat(n.valor)});const c=parseFloat(l.servicio.precio)-V;o.value.montoPendiente=c.toString(),o.value.montoCancelar=c.toString()}else o.value={...l.servicio.pago,montoCancelar:parseFloat(l.servicio.pago.valor).toFixed(2)};const p=V=>{let c=0;c=o.value[V];const n=/^\d{0,9}(\.\d{1,2})?$/;setTimeout(function(){let v=0;if(v=o.value[V],!n.test(v.toString())){const r=parseFloat(c.toString().substring(0,c.toString().length-1));o.value[V]=r}},0)},w=()=>{let V=!1;return l.nuevoPago&&(u.forEach(c=>{(o.value[c].length==0||o.value[c]==0)&&(i.value[c].message="Debes completar este campo",i.value[c].isValid=!1,V=!0)}),(S.roles[0]=="SUPER-ADMINISTRADOR"||S.roles[0]=="ADMINISTRADOR")&&o.value.sucursal_id==""&&l.servicio.tipo_comprobante!="Recibo"&&parseFloat(o.value.montoCancelar)>=parseFloat(o.value.montoPendiente)&&(i.value.sucursal_id.message="Debes seleccionar una sucursal",i.value.sucursal_id.isValid=!1,V=!0)),V},U=["Efectivo Oficina/Sucursal","Dep\xF3sito Bancario","Transferencia Bancaria","Facilito","Punto Agil"],W=async()=>{if(w())return;const V=Date.now(),c=z.formatDate(V,"DD/MM/YYYY"),n=z.formatDate(V,"HH:mma"),v=parseFloat(o.value.montoPendiente)-parseFloat(o.value.montoCancelar);let r=0;l.nuevoPago&&l.servicio.pagos.forEach($=>{r+=parseFloat($.valor)});let f;if(l.nuevoPago)f=l.servicio.pagos,f.unshift({valor:o.value.montoCancelar,monto_pendiente:v.toString(),totalAbonado:(r+parseFloat(o.value.montoCancelar)).toString(),fecha_abono:c,hora_abono:n,detalle:o.value.detalle,n_transaccion:o.value.n_transaccion,forma_pago:o.value.forma_pago});else{const $=l.servicio.pagos.pagos.findIndex(C=>l.servicio.pago.hora_abono==C.hora_abono&&l.servicio.pago.valor==C.valor);l.servicio.pagos.pagos[$]={...o.value}}let E,L;l.nuevoPago?(E={pagos:f,estadoSRI:v<=0?"PAGADO":"PENDIENTE"},L=l.servicio.pago_id):(E={pagos:l.servicio.pagos.pagos},L=l.servicio.pagos.pago_id);try{let $={headers:{sucursal_id:o.value.sucursal_id}};O.value=!0;const{data:C}=await d.patch(`/pagos/${L}`,E,$);if(v<=0&&l.servicio.tipo_comprobante!="Recibo"&&l.nuevoPago){let _={customer_id:R.params.client_id,tipo:"EMISION",subtotal:parseFloat(l.servicio.precio),iva:parseFloat(l.servicio.iva),descuento:0,total:parseFloat(l.servicio.precio),entity:"Pagos",pago_id:l.servicio.pago_id,user_id:S.id,products:[{aplicaIva:l.servicio.iva>0,cantidad:1,pvp:l.servicio.precio,descuento:0,nombre:"SERVICIO DE INTERNET",codigoBarra:l.servicio.pago_id.split("-")[0]}]};await d.post("/CE/facturas/generarFacturaElectronica",_,$)}O.value=!1,N("positive",C.msg),F.value=!1,h("actualizarDatos")}catch($){console.log($)}},te=async V=>{T.value=[];const{data:c}=await d.get(`/sucursal/find/${V}/company`);c.forEach(n=>{T.value.push({label:n.nombre,value:n.id})}),T.value.length==1&&(o.value.sucursal_id=T.value[0].value)};return(S.roles[0]=="SUPER-ADMINISTRADOR"||S.roles[0]=="ADMINISTRADOR")&&te(S.company.id),(V,c)=>(y(),P(be,{style:{width:"450px !important","max-width":"fit-content"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",Ja,[x(I(l.nuevoPago?"Agregar Pago:":"Editar Pago")+" ",1),ae(t(Q,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[we]])])]),_:1}),t(Ce,{inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(ke,{onSubmit:W},{default:a(()=>[e("div",Xa,[e("div",eo,[to,t(Se,{color:"orange","transition-show":"scale","transition-hide":"scale","onUpdate:modelValue":[c[0]||(c[0]=n=>i.value.forma_pago.isValid=!0),c[1]||(c[1]=n=>o.value.forma_pago=n)],error:!i.value.forma_pago.isValid,outlined:"",modelValue:o.value.forma_pago,dense:"",options:U},{error:a(()=>[e("label",{class:k(V.$q.dark.isActive?"text-red-4":"text-negative")},I(i.value.forma_pago.message),3)]),_:1},8,["error","modelValue"])]),e("div",ao,[oo,t(ee,{modelValue:o.value.n_transaccion,"onUpdate:modelValue":c[2]||(c[2]=n=>o.value.n_transaccion=n),dense:"",outlined:""},null,8,["modelValue"])]),l.nuevoPago?(y(),re("div",lo,[so,t(Ft,{color:"green","onUpdate:modelValue":[c[3]||(c[3]=n=>o.value.montoCancelar=o.value.montoPendiente),c[4]||(c[4]=n=>o.value.importe_total=n)],size:"lg",modelValue:o.value.importe_total},null,8,["modelValue"])])):J("",!0),e("div",ro,[e("label",null,I(l.nuevoPago?"Monto a Cancelar:":"Monto Cancelado"),1),t(ee,{modelValue:o.value.montoCancelar,"onUpdate:modelValue":[c[5]||(c[5]=n=>o.value.montoCancelar=n),c[6]||(c[6]=n=>(p("montoCancelar"),i.value.montoCancelar.isValid=!0))],modelModifiers:{trim:!0},readonly:o.value.importe_total||!l.nuevoPago,"input-style":"padding-right: 27px;",type:"number",step:"0.01",error:!i.value.montoCancelar.isValid,"input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:k(V.$q.dark.isActive?"text-red-4":"text-negative")},I(i.value.montoCancelar.message),3)]),prepend:a(()=>[t(oe,{name:"attach_money"})]),_:1},8,["modelValue","readonly","error"])]),l.nuevoPago?(y(),re("div",no,[io,t(ee,{modelValue:o.value.montoPendiente,"onUpdate:modelValue":[c[7]||(c[7]=n=>o.value.montoPendiente=n),c[8]||(c[8]=n=>(p("montoPendiente"),i.value.montoPendiente.isValid=!0))],modelModifiers:{trim:!0},disable:"",type:"number",step:"0.01",error:!i.value.montoPendiente.isValid,"input-style":"padding-right: 27px;","input-class":"resaltarTextoInput",dense:"",outlined:""},{error:a(()=>[e("label",{class:k(V.$q.dark.isActive?"text-red-4":"text-negative")},I(i.value.montoCancelar.message),3)]),prepend:a(()=>[t(oe,{name:"attach_money"})]),_:1},8,["modelValue","error"])])):J("",!0),l.servicio.tipo_comprobante!="Recibo"&&l.nuevoPago&&parseFloat(o.value.montoCancelar)>=parseFloat(o.value.montoPendiente)?(y(),re("div",co,[uo,T.value.length>1?(y(),P(Se,{key:0,modelValue:o.value.sucursal_id,"onUpdate:modelValue":[c[9]||(c[9]=n=>o.value.sucursal_id=n),c[10]||(c[10]=n=>i.value.sucursal_id.isValid=!0)],error:!i.value.sucursal_id.isValid,outlined:"",options:T.value,"emit-value":"","map-options":"",dense:""},{error:a(()=>[e("label",{class:k(V.$q.dark.isActive?"text-red-4":"text-negative")},I(i.value.sucursal_id.message),3)]),"no-option":a(()=>[t(me,null,{default:a(()=>[t(se,{class:"text-grey"},{default:a(()=>[x(" No se encontro sucursal ")]),_:1})]),_:1})]),_:1},8,["modelValue","error","options"])):J("",!0)])):J("",!0),e("div",mo,[vo,t(ee,{modelValue:o.value.detalle,"onUpdate:modelValue":c[11]||(c[11]=n=>o.value.detalle=n),modelModifiers:{trim:!0},outlined:"",rows:"2",type:"textarea"},null,8,["modelValue"])]),e("div",po,[t(Q,{type:"submit",icon:"save",loading:O.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Guardar ")]),_:1},8,["loading"])])])]),_:1})]),_:1})]),_:1}))}};var _o=Et(fo,[["__scopeId","data-v-137f4dea"]]);const go={class:"text-h6 text-center"},bo={class:"row q-col-gutter-lg q-mt-md justify-center"},ho={class:"col-xs-12 col-md-9"},yo={class:"row q-col-gutter-lg"},$o={class:"col-xs-12 col-sm-6 q-pt-sm"},wo=e("label",{class:"q-mr-md row items-center"},"Vencimiento:",-1),qo={class:"row items-center justify-end"},xo={class:"col-xs-12 col-sm-6 q-pt-sm"},Co=e("label",{class:"q-mr-md row items-center"},"Fecha:",-1),Io={class:"row items-center justify-end"},ko={class:"col-12"},Vo={class:"full-width row flex-center text-lime-10 q-gutter-sm"},Ao=e("span",{class:"text-subtitle1"}," Agrega alg\xFAn Producto ",-1),Po={class:"q-my-none"},Do={key:0,class:"col-xs-12 col-sm-5 q-mt-sm"},So=e("label",null,"Sucursal a Facturar:",-1),To={class:"col-xs-12 col-sm-7",style:{display:"flex","justify-content":"end"}},Ro={class:"text-right"},Eo=e("td",null,[e("b",null,"TOTAL BRUTO:")],-1),Fo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Mo={class:"text-right"},No=e("td",null,[e("b",null,"DESCUENTOS:")],-1),Oo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},Uo={class:"text-right"},Lo=e("td",null,[e("b",null,"SUBTOTAL:")],-1),Qo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},jo={class:"text-right"},Bo=e("td",null,[e("b",null,"IVA(12%):")],-1),Yo={style:{width:"50px"},class:"text-subtitle1 text-weight-regular"},zo={class:"text-right"},Go=e("td",null,[e("b",null,"TOTAL:")],-1),Ho={style:{width:"50px"}},Ko={class:"col-xs-9 col-sm-12 q-pt-none q-mb-md flex justify-center"},Wo={__name:"ModalNuevaFactura",setup(s){const{api:h,claim:l,pagos:u,mostrarNotify:d,route:S,showModalNuevaFactura:N}=he(),R=D([{name:"acciones",label:"Quitar",align:"left"},{label:"Producto/Servicio",align:"left",field:"producto",name:"producto"},{name:"cantidad",label:"Cantidad",align:"left"},{name:"iva",label:"IVA(%)",align:"center"},{name:"descuento",label:"Descuento %",align:"left",field:"descuento"},{name:"v_total",label:"Total",align:"center",field:"v_total"}]),F=D([]),T=D([]),O=D(!1),o=D({fechaVencimiento:"",fecha:"",sucursal_id:""}),{vencimiento:i,servicio:{perfil_internet:{nombre_plan:p,descarga_Mbps:w,subida_Mbps:U,impuesto:W},factura_id:{tipo_comprobante:te},precio:V}}=u.value[0],c=i.split("/"),n=`${c[2]}-${c[1]}-${c[0]}`;o.value.fechaVencimiento=z.addToDate(n,{months:1,day:1});const v=z.addToDate(n,{months:2,day:1});o.value.fechaVencimiento=z.formatDate(o.value.fechaVencimiento,"YYYY/MM/DD"),o.value.fecha=z.formatDate(Date.now(),"YYYY/MM/DD");const r=`
Servicio de Internet Banda ancha
facturaci\xF3n del ${z.formatDate(o.value.fechaVencimiento,"DD/MM/YYYY")} al ${z.formatDate(v,"DD/MM/YYYY")}
Fecha de Suspensi\xF3n : ${z.formatDate(o.value.fechaVencimiento,"DD/MM/YYYY")}
Plan de Internet : ${p}
Descarga : ${w} Mbps
Subida : ${U} Mbps`;F.value.unshift({tipo:"servicio",producto:r,cantidad:1,iva:W,descuento:0,precio:V,v_total:parseFloat(V)-W*parseFloat(V)/100});const f=G(()=>{let $=0,C=0,_=0,H=0;return F.value.forEach(K=>{K.descuento>0&&(_+=parseFloat(K.v_total)*parseFloat(K.descuento)/100),K.iva&&(C+=(parseFloat(K.v_total)-parseFloat(K.v_total)*parseFloat(K.descuento)/100)*(parseInt(K.iva)/100)),$+=parseFloat(K.v_total)}),H=$+C-_,{subtotal:parseFloat((Math.floor($*100)/100).toString()),iva:parseFloat((Math.floor(C*100)/100).toString()),descuento:parseFloat((Math.floor(_*100)/100).toString()),total:parseFloat((Math.floor(H*100)/100).toString())}}),E=async $=>{T.value=[];const{data:C}=await h.get(`/sucursal/find/${$}/company`);C.forEach((_,H)=>{T.value.push({label:_.nombre,value:_.id}),H+1==C.length&&T.value.length>0&&(o.value.sucursal_id=T.value[0].value)})};l.roles[0]=="SUPER-ADMINISTRADOR"||l.roles[0]=="ADMINISTRADOR"?E(l.company.id):o.value.sucursal_id=l.sucursales[0];const L=async()=>{Qe.create({title:"\xBFDeseas agregar esta factura?",ok:{push:!0,color:"cyan-10",label:"Agregar"},cancel:{push:!0,color:"blue-grey-6",label:"Cancelar"}}).onOk(async()=>{try{let $={headers:{sucursal_id:o.value.sucursal_id}};O.value=!0;const C={estadoSRI:"PAGADO",pagos:[{detalle:"",fecha_abono:z.formatDate(o.value.fecha,"DD/MM/YYYY"),forma_pago:"Efectivo",hora_abono:z.formatDate(Date.now(),"HH:mma"),monto_pendiente:"0",n_transaccion:"",totalAbonado:`${f.value.total}`,valor:`${f.value.total}`}]},{data:_}=await h.post("/pagos/create",{servicio:u.value[0].servicio.id,...C,dia_pago:z.formatDate(o.value.fechaVencimiento,"YYYY-MM-DD")},$);if(te!="Recibo"){let H=[];F.value.forEach((le,$e)=>{H.push({aplicaIva:le.iva>0,cantidad:le.cantidad,pvp:le.v_total,descuento:le.descuento,nombre:le.tipo=="servicio"?"SERVICIO DE INTERNET":le.producto,codigoBarra:_.id.split("-")[0]+`${$e}`})});let K={customer_id:S.params.client_id,tipo:"EMISION",subtotal:f.value.subtotal,iva:f.value.iva,descuento:f.value.descuento,total:f.value.total,entity:"Pagos",pago_id:_.id,user_id:l.id,products:H};await h.post("/CE/facturas/generarFacturaElectronica",K,$)}O.value=!1,N.value=!1,d("positive","Factura Generado"),emit("actualizarDatos")}catch($){d("negative","Algo salio mal"),console.log($)}})};return($,C)=>(y(),P(be,{style:{width:"1000px","max-width":"80vw"}},{default:a(()=>[t(ge,null,{default:a(()=>[e("div",go,[x(" Nueva Factura Servicio "),ae(t(Q,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[we]])])]),_:1}),t(Ce,{inset:""}),t(ge,{class:"q-pt-none"},{default:a(()=>[t(ke,{onSubmit:Ot(L,["prevent"])},{default:a(()=>[e("div",bo,[e("div",ho,[e("div",yo,[e("div",$o,[wo,t(ee,{dense:"",filled:"",modelValue:o.value.fechaVencimiento,"onUpdate:modelValue":C[1]||(C[1]=_=>o.value.fechaVencimiento=_),mask:"date",rules:["date"]},{append:a(()=>[t(oe,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(lt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(ot,{modelValue:o.value.fechaVencimiento,"onUpdate:modelValue":C[0]||(C[0]=_=>o.value.fechaVencimiento=_)},{default:a(()=>[e("div",qo,[ae(t(Q,{label:"Close",color:"primary",flat:""},null,512),[[we]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",xo,[Co,t(ee,{dense:"",filled:"",modelValue:o.value.fecha,"onUpdate:modelValue":C[3]||(C[3]=_=>o.value.fecha=_),mask:"date",rules:["date"],hint:"ejfiojwef","hide-hint":""},{append:a(()=>[t(oe,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(lt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(ot,{modelValue:o.value.fecha,"onUpdate:modelValue":C[2]||(C[2]=_=>o.value.fecha=_)},{default:a(()=>[e("div",Io,[ae(t(Q,{label:"Close",color:"primary",flat:""},null,512),[[we]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),e("div",ko,[t(je,{rows:F.value,columns:R.value,"row-key":"name",class:k([$.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50]},{"no-data":a(({})=>[e("div",Vo,[Ao,t(oe,{size:"2em",name:"playlist_add"})])]),"body-cell-producto":a(_=>[t(Y,{props:_},{default:a(()=>[e("pre",Po,"                      "+I(_.row.producto)+`
                    `,1)]),_:2},1032,["props"])]),"body-cell-cantidad":a(_=>[t(Y,{props:_},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",readonly:_.row.tipo=="servicio",min:"0",max:_.row.stock,type:"number",style:{width:"100px"},modelValue:_.row.cantidad,"onUpdate:modelValue":H=>_.row.cantidad=H,modelModifiers:{trim:!0}},null,8,["readonly","max","modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-descuento":a(_=>[t(Y,{props:_},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",min:"0",max:"100",type:"number",style:{width:"100px"},modelValue:_.row.descuento,"onUpdate:modelValue":H=>_.row.descuento=H},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-iva":a(_=>[t(Y,{props:_},{default:a(()=>[t(ee,{"input-class":"resaltarTextoInput",dense:"",required:"",min:"0",max:"100",type:"number",style:{width:"100px"},modelValue:_.row.iva,"onUpdate:modelValue":H=>_.row.iva=H,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-v_total":a(_=>[t(Y,{props:_},{default:a(()=>[x(" $"+I(_.row.v_total),1)]),_:2},1032,["props"])]),"body-cell-acciones":a(_=>[t(Y,{props:_},{default:a(()=>[t(Q,{round:"",color:"deep-orange",disable:_.row.tipo=="servicio",onClick:H=>$.quitarArticulo(_.row.id),icon:"close",size:"8px"},null,8,["disable","onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","class"])]),b(l).roles[0]=="SUPER-ADMINISTRADOR"||b(l).roles[0]=="ADMINISTRADOR"?(y(),re("div",Do,[So,T.value.length>1?(y(),P(Se,{key:0,modelValue:o.value.sucursal_id,"onUpdate:modelValue":C[4]||(C[4]=_=>o.value.sucursal_id=_),outlined:"",options:T.value,"emit-value":"","map-options":"",dense:""},{"no-option":a(()=>[t(me,null,{default:a(()=>[t(se,{class:"text-grey"},{default:a(()=>[x(" No se encontro sucursales ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"])):J("",!0)])):J("",!0),e("div",To,[e("table",{class:k([$.$q.screen.xs?"":"linearTablaDetalle"])},[e("tr",Ro,[Eo,e("td",Fo," $"+I(f.value.subtotal),1)]),e("tr",Mo,[No,e("td",Oo," $"+I(f.value.descuento),1)]),e("tr",Uo,[Lo,e("td",Qo," $"+I(f.value.subtotal-f.value.descuento),1)]),e("tr",jo,[Bo,e("td",Yo," $"+I(f.value.iva),1)]),e("tr",zo,[Go,e("td",Ho,[t(ie,{outline:"",class:"text-subtitle1 text-weight-bold",color:"secondary",label:`$${f.value.total}`},null,8,["label"])])])],2)]),e("div",Ko,[t(Q,{type:"submit",icon:"save",loading:O.value,outline:"",rounded:"",class:"q-mr-lg",style:{color:"#696cff"}},{default:a(()=>[x(" \xA0 Crear Factura ")]),_:1},8,["loading"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}))}};const Zo={class:"my-card"},Jo={class:"q-pt-none"},Xo={class:"row"},el={class:"col-12"},tl={class:"row"},al={class:"col-12 text-right"},ol={class:"col-12 q-mt-md"},ll=e("br",null,null,-1),sl=e("br",null,null,-1),rl=e("br",null,null,-1),nl=e("br",null,null,-1),il={class:"row q-col-gutter-sm"},cl=e("div",{class:"full-width row flex-center text-lime-10 q-gutter-sm"},[e("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun registros ")],-1),dl={__name:"IndexFacturas",setup(s){const h=D([{name:"x",align:"center",label:" ",field:"x"},{name:"n_comprobantes",align:"center",label:"N. Comprobante",field:"n_comprobantes"},{name:"emitido",label:"Emitido",field:"emitido",align:"center"},{name:"vencimiento",label:"Vencimiento",field:"vencimiento",align:"center"},{name:"precio",label:"Total",field:"precio",align:"center"},{name:"iva",label:"Impuesto",field:"iva",align:"center"},{name:"pagado",label:"Pagado",field:"pagado",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}]),l=D(!0),u=D({}),{api:d,servicios:S,pagos:N,showModalPago:R,showModalNuevaFactura:F,dia_vencimiento:T}=he(),{claim:O,route:o}=Ie();let i;const p=()=>{const n=new Zt("http://localhost:3000/socket.io/socket.io.js",{extraHeaders:{autentication:O.id}});i==null||i.removeAllListeners(),i=n.socket("/"),i.on("updateStateInvoice",()=>{N.value=[],U()})},w=async()=>{const{data:n}=await d.get("/customers/find/"+o.params.client_id);return n},U=async()=>{try{N.value=[];const{data:n}=await d.get("/pagos/find/"+S.value[0].servicio_id);n.length>0&&n[0].servicio.factura_id.tipo_comprobante=="Recibo"&&(h.value[1].label="Tipo Comprobante"),n.forEach(v=>{var C;let r;v.servicio.factura_id.tipo_impuesto=="Impuestos incluido"?r=`${Math.floor(parseFloat(v.servicio.precio)*.12*100)/100}`:r=0;let f=0;v.pagos.forEach(_=>{f+=parseFloat(_.valor)});const E=(C=v.estadoSRI)==null?void 0:C.trim();let L=parseInt(v.servicio.factura_id.dia_gracia.split(" ")[0]);const $=z.addToDate(v.dia_pago,{days:L+1});N.value.push({ambiente:v.sucursal_id?v.sucursal_id.ambiente:"",clave_acceso:v.clave_acceso,company_name:v.servicio.router_id.company_id.nombre_comercial,num_comprobante:v.num_comprobante,sucursal_id:v.sucursal_id!==null?v.sucursal_id.id:null,pago_id:v.id,ruc:v.servicio.perfil_internet.router_id.company_id.ruc,direccion:v.sucursal_id!==null?v.sucursal_id.direccion:null,emitido:z.formatDate(v.created_at,"DD/MM/YYYY"),vencimiento:z.formatDate($,"DD/MM/YYYY"),precio:`${v.servicio.precio}`,tipo_comprobante:v.servicio.factura_id.tipo_comprobante,iva:r,pagos:v.pagos,pagado:f,servicio:v.servicio,estado:E,cancelado:f>=parseFloat(v.servicio.precio),expand:!1,loading:!1})})}catch(n){console.log(n)}},W=async(n,v)=>{N.value[v].loading=!0;let r={headers:{sucursal_id:n.sucursal_id}},f={ambiente:n.ambiente,clave_acceso:n.clave_acceso,company_name:n.company_name,sucursal_id:n.sucursal_id,customer_id:o.params.client_id,num_comprobante:n.num_comprobante,tipo:"EMISION",subtotal:parseFloat(n.precio),iva:parseFloat(n.iva),descuento:0,total:parseFloat(n.precio),entity:"Pagos",pago_id:n.pago_id,user_id:O.id,products:[{aplicaIva:n.iva>0,cantidad:1,pvp:n.precio,descuento:0,nombre:"SERVICIO DE INTERNET",codigoBarra:n.pago_id.split("-")[0]}]};n.estado.trim()=="ERROR ENVIO RECEPCION"&&await d.post("/CE/facturas/recepcionComprobantesOffline",f,r),n.estado.trim()=="RECIBIDA"&&await d.post("/CE/facturas/autorizacionComprobantesOffline",f,r),N.value[v].loading=!1},te=async(n,v,r=null)=>{r&&(n.company_name=r.company_name,n.ruc=r.ruc,n.direccion=r.direccion);const f=await w(),E={cliente:f[0].nombres,tipoDoc:f[0].tipo_documento,num_doc:f[0].numero_documento,email:f[0].email},{imprimirAbono:L,imprimirFactura:$}=Za();let C="";v=="Recibo"?C=L(n,E,O.fullName,v):C=$(n,E,O.fullName,v);var _=window.open("","_blank");_.document.write(C),_.print(),_.close()},V=(n,v,r,f)=>{Qe.create({title:"\xBFEstas seguro de eliminar este abono?",message:`<span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Fecha abonado:
                  </strong> 
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${n.fecha_abono} ${n.hora_abono}
                  </label>
                </span>
                <span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Forma de pago:
                  </strong> 
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${n.forma_pago} 
                  </label>
                </span>
                <span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Valor Abonado:
                  </strong> 
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    $${parseFloat(n.valor).toFixed(2)}
                  </label>                
                </span>`,html:!0,ok:{push:!0,label:"Eliminar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{const E=[...v];let L=0;E.reverse().map(($,C)=>{n.hora_abono==$.hora_abono&&n.valor==$.valor?$.delete=!0:($.totalAbonado=(parseFloat($.valor)+L).toString(),$.monto_pendiente=(parseFloat(r)-parseFloat($.totalAbonado)).toString(),L+=parseFloat($.totalAbonado))}),setTimeout(async()=>{const $=E.filter(C=>C.delete!==!0);await d.patch(`/pagos/${f}`,{pagos:$}),U()},1e3)}catch(E){mostrarNotify("negative",E.response.data.message)}})},c=async n=>{await d.post(`/CE/facturas/getRide/${n}`,{},{responseType:"blob"}).then(v=>{var r=new Blob([v.data],{type:"application/pdf"}),f=URL.createObjectURL(r);window.open(f)}).catch(v=>{v.response.status==422&&this.$setLaravelErrors(v.response.data.errors)})};return U(),p(),(n,v)=>(y(),re(De,null,[t(ke,{onSubmit:v[1]||(v[1]=()=>{})},{default:a(()=>[e("div",Zo,[e("div",Jo,[e("div",Xo,[e("div",el,[e("div",tl,[e("div",al,[t(Q,{onClick:v[0]||(v[0]=r=>F.value=!0),outline:"",color:"primary",label:"Factura de Servicio",class:k(["q-mr-xs",!n.$q.screen.xs||"q-mt-sm"])},null,8,["class"])]),e("div",ol,[t(je,{rows:b(N),columns:h.value,class:k([n.$q.dark.isActive?"":"my-sticky-header-table3"]),"hide-pagination":!0,"rows-per-page-options":[50],"row-key":"name"},{body:a(r=>[t(at,{props:r},{default:a(()=>[r.row.estado!="NO PAGADO"?(y(),P(Y,{key:0,"auto-width":""},{default:a(()=>[t(Q,{size:"sm",color:"accent",round:"",dense:"",onClick:f=>r.row.expand=!r.row.expand,icon:r.row.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024)):(y(),P(Y,{key:1,"auto-width":""})),t(Y,{key:"n_comprobantes",props:r},{default:a(()=>[x(I(r.row.tipo_comprobante=="Recibo"?"Recibo":r.row.num_comprobante==""||r.row.num_comprobante==null?"- - - - - -":r.row.num_comprobante),1)]),_:2},1032,["props"]),t(Y,{key:"emitido",props:r},{default:a(()=>[x(I(r.row.emitido),1)]),_:2},1032,["props"]),t(Y,{key:"vencimiento",props:r},{default:a(()=>[x(I(r.row.vencimiento),1)]),_:2},1032,["props"]),t(Y,{key:"precio",props:r},{default:a(()=>[x(" $"+I(r.row.precio),1)]),_:2},1032,["props"]),t(Y,{key:"iva",props:r},{default:a(()=>[x(" $"+I(r.row.iva),1)]),_:2},1032,["props"]),t(Y,{key:"pagado",props:r},{default:a(()=>[x(" $"+I(r.row.pagado),1)]),_:2},1032,["props"]),t(Y,{key:"estado",props:r},{default:a(()=>[r.row.estado=="AUTORIZADO"?(y(),P(ie,{key:0,outline:"",class:"q-py-xs q-px-md",color:"secondary"},{default:a(()=>[x(" PAGADO "),ll,x(" Y "),sl,x(" AUTORIZADO ")]),_:1})):r.row.estado=="NO PAGADO"||r.row.estado=="PENDIENTE"?(y(),P(ie,{key:1,outline:"",class:"q-py-xs q-px-md",color:n.$q.dark.isActive?"blue-grey-3":"blue-grey-7",label:r.row.estado},null,8,["color","label"])):r.row.estado=="PAGADO"?(y(),P(ie,{key:2,outline:"",class:"q-py-xs q-px-md",color:"secondary",label:r.row.estado},null,8,["label"])):(y(),P(ie,{key:3,outline:"",class:"q-py-xs q-px-md",color:n.$q.dark.isActive?"warning":"orange-10"},{default:a(()=>[x(" PAGADO "),rl,x(" - "),nl,x(" "+I(r.row.estado),1)]),_:2},1032,["color"]))]),_:2},1032,["props"]),t(Y,{key:"acciones",props:r},{default:a(()=>[r.row.cancelado?J("",!0):(y(),P(Q,{key:0,round:"",color:"blue-grey",onClick:f=>(R.value=!0,u.value=r.row),icon:"done",size:"10px",class:"q-mr-sm"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Agregar Pago ")]),_:1})]),_:2},1032,["onClick"])),r.row.estado=="ERROR ENVIO RECEPCION"||r.row.estado=="ERROR ENVIO RECEPCION - ANULACION"||r.row.estado=="RECIBIDA"?(y(),P(Q,{key:1,round:"",color:"blue-grey",icon:"fa-solid fa-retweet",loading:r.row.loading,onClick:f=>W(r.row,r.rowIndex),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Emitir Factura Electr\xF3nica ")]),_:1})]),_:2},1032,["loading","onClick"])):J("",!0),r.row.estado=="AUTORIZADO"?(y(),P(Q,{key:2,round:"",color:"blue-grey",icon:"print",onClick:f=>te(r.row,"factura"),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Imprimir comprobante ")]),_:1})]),_:2},1032,["onClick"])):J("",!0),r.row.estado=="AUTORIZADO"?(y(),P(Q,{key:3,round:"",color:"blue-grey",icon:"fa-solid fa-file-pdf",onClick:f=>c(r.row.clave_acceso),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(_e,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[x(" Descargar PDF ")]),_:1})]),_:2},1032,["onClick"])):J("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"]),ae(t(at,{props:r},{default:a(()=>[t(Y,{colspan:"100%"},{default:a(()=>[e("div",il,[(y(!0),re(De,null,Ut(r.row.pagos,(f,E)=>(y(),re("div",{key:E,class:"col-4"},[t(Wt,{bordered:"",padding:"",dense:""},{default:a(()=>[t(ne,{header:"",class:"text-center"},{default:a(()=>[x(" Fecha Abonado: "+I(f.fecha_abono)+" "+I(f.hora_abono),1)]),_:2},1024),ae((y(),P(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,null,{default:a(()=>[x("Forma de Pago:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ne,null,{default:a(()=>[x(I(f.forma_pago),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]]),ae((y(),P(me,{tag:"label",class:""},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,null,{default:a(()=>[x("Valor Abonado:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ne,null,{default:a(()=>[x("$"+I(f.valor),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]]),ae((y(),P(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,null,{default:a(()=>[x("N\xBA transacci\xF3n:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ne,null,{default:a(()=>[x(I(f.n_transaccion),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]]),ae((y(),P(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,null,{default:a(()=>[x("Detalle:")]),_:1})]),_:1}),t(se,{side:"",top:"",class:"justify-center"},{default:a(()=>[t(ne,null,{default:a(()=>[x(I(f.detalle==""?"Sin detalles":f.detalle),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]]),ae((y(),P(me,{tag:"label"},{default:a(()=>[t(se,null,{default:a(()=>[t(ne,{class:"text-center"},{default:a(()=>[r.row.estado=="PENDIENTE"?(y(),P(Q,{key:0,square:"",onClick:L=>(R.value=!0,u.value={pagos:r.row,pago:f},l.value=!1),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md q-mr-md",outline:"",rounded:"",dense:"","icon-right":"edit"},null,8,["onClick","color"])):J("",!0),t(Q,{square:"",onClick:L=>te(f,"Recibo",r.row),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md",outline:"",rounded:"",dense:"","icon-right":"print"},null,8,["onClick","color"]),r.row.estado=="PENDIENTE"?(y(),P(Q,{key:1,square:"",onClick:L=>V(f,r.row.pagos,r.row.precio,r.row.pago_id),color:n.$q.dark.isActive?"blue-grey-2":"blue-grey-7",class:"q-px-md q-ml-md",outline:"",rounded:"",dense:"","icon-right":"delete"},null,8,["onClick","color"])):J("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[fe]])]),_:2},1024)]))),128))])]),_:2},1024)]),_:2},1032,["props"]),[[Lt,r.row.expand]])]),"no-data":a(({icon:r})=>[cl]),_:1},8,["rows","columns","class"])])])])])])])]),_:1}),t(Ue,{modelValue:b(R),"onUpdate:modelValue":v[2]||(v[2]=r=>tt(R)?R.value=r:null)},{default:a(()=>[t(_o,{servicio:u.value,nuevoPago:l.value,onActualizarDatos:U},null,8,["servicio","nuevoPago"])]),_:1},8,["modelValue"]),t(Ue,{modelValue:b(F),"onUpdate:modelValue":v[3]||(v[3]=r=>tt(F)?F.value=r:null)},{default:a(()=>[t(Wo,{onActualizarDatos:U})]),_:1},8,["modelValue"])],64))}},ul={class:"q-gutter-y-md"},ml={__name:"FacturacionPagos",setup(s){const h=D("facturas");return(l,u)=>(y(),re("div",ul,[t(be,null,{default:a(()=>[t(it,{modelValue:h.value,"onUpdate:modelValue":u[0]||(u[0]=d=>h.value=d),draggable:"false",dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":""},{default:a(()=>[t(qe,{name:"facturas",label:"Facturas"}),t(qe,{name:"configuracion",label:"Configuraci\xF3n"})]),_:1},8,["modelValue"]),t(Ce),t(ct,{modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=d=>h.value=d),animated:""},{default:a(()=>[t(xe,{name:"facturas"},{default:a(()=>[t(dl)]),_:1}),t(xe,{name:"configuracion"},{default:a(()=>[t(Wa)]),_:1})]),_:1},8,["modelValue"])]),_:1})]))}};const vl={class:"q-gutter-y-md"},pl={__name:"IndexPage",setup(s){const h=D("resumen");return(l,u)=>(y(),re("div",vl,[t(be,null,{default:a(()=>[t(it,{modelValue:h.value,"onUpdate:modelValue":u[0]||(u[0]=d=>h.value=d),draggable:"false",dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:a(()=>[t(qe,{name:"resumen",label:"Resumen"}),t(qe,{name:"servicios",label:"Servicios"}),t(qe,{name:"facturacion/pagos",label:"Facturaci\xF3n/Pagos"})]),_:1},8,["modelValue"]),t(Ce),t(ct,{modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=d=>h.value=d),animated:""},{default:a(()=>[t(xe,{name:"resumen"},{default:a(()=>[t(Oa)]),_:1}),t(xe,{name:"servicios"},{default:a(()=>[h.value=="servicios"?(y(),P(Ka,{key:0})):J("",!0)]),_:1}),t(xe,{name:"facturacion/pagos"},{default:a(()=>[h.value=="facturacion/pagos"?(y(),P(ml,{key:0})):J("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]))}},fl={class:"q-ma-lg q-pt-md"},_l={class:"row q-col-gutter-md",style:{"justify-content":"center"}},gl={class:"text-h6 text-center",style:{position:"relative",top:"-8px",left:"17px"}},bl={class:"row q-col-gutter-md",style:{"justify-content":"center"}},hl={class:"col-xs-11 col-md-11 q-pt-xs"},Yl={__name:"EditCliente",setup(s){const{api:h,route:l,formCliente:u,formFacturacion:d}=Ie(),{client_name:S,dia_vencimiento:N,mes_pago:R,servicios:F}=he(),T=async()=>{const{data:o}=await h.get("/pagos/find/"+F.value[0].servicio_id);o.length>0&&(R.value.dia_pago=o[0].dia_pago,o[0].estadoSRI!=="PAGADO"&&o[0].estadoSRI!=="AUTORIZADO"?R.value.estado="pendiente":R.value.estado="pagado"),R.value.meses_vencidos=o.reduce((i,p)=>i+(p.estadoSRI=="NO PAGADO"||p.estadoSRI=="PENDIENTE"),0),o.forEach((i,p)=>{let w=parseInt(i.servicio.factura_id.dia_gracia.split(" ")[0]);N.value=z.addToDate(i.dia_pago,{days:w+1}),p==0&&(R.value.dia_vencimiento=N.value)})};return(async()=>{F.value=[];const{data:o}=await h.get("/customers/find/"+l.params.client_id);S.value=o[0].nombres,u.value={...o[0]},o[0].planInternet.forEach(i=>{d.value={...i.factura_id},F.value.push({detalles:{...i,cliente:S.value},servicio_id:i.id,precio:i.precio,direccion:`${i.direccion==""?"- - - - -":i.direccion}`,fecha_instalacion:i.fecha_instalacion,ipv4:i.ipv4,nombre_plan:i.perfil_internet.nombre_plan,router:i.router_id.nombre,estado:`${i.isActive?"Activo":"Inactivo"}`})}),T()})(),(o,i)=>(y(),re(De,null,[e("div",fl,[e("div",_l,[e("div",{class:k(["col-xs-12 q-pl-none",[o.$q.screen.width<1022?"q-pt-sm col-md-6":"col-md-6"]])},[t($t,{class:k(["row q-mr-xs",[o.$q.screen.width<1022?"justify-center q-pt-sm":"justify-start "]])},{default:a(()=>[t(Me,{label:"Inicio",icon:"home",to:"/"}),t(Me,{label:"Clientes",icon:"fa-solid fa-list",to:"/clientes"}),t(Me,{label:"Nuevo",icon:"add_circle"})]),_:1},8,["class"])],2),e("div",{class:k(["col-xs-12",[o.$q.screen.width<1022?"text-center q-pt-sm col-md-6 q-pl-none":"text-right col-md-5"]])},[e("label",gl,I(b(S)),1)],2)])]),e("div",bl,[e("div",hl,[t(be,{flat:"",class:"shadow_custom q-pt-none"},{default:a(()=>[t(pl,{edit:!0})]),_:1})])])],64))}};export{Yl as default};
