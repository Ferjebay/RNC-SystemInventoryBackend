import{r as g,o as r,a9 as u,g as a,f as t,aV as le,e as n,aa as h,O as T,h as O,ah as be,i as S,af as p,ae as V,ab as E,c as $,ad as c,Q as Z,aU as ce,v as Y,ba as ae,aj as oe,ai as _e,bc as X}from"./index.e9d5a3b4.js";import{Q as te}from"./QDate.bdd83eb3.js";import{Q as se}from"./QPopupProxy.9cb0bc93.js";import{Q as ne,d as re,a as ie}from"./format.1423409a.js";import{Q as ye}from"./QList.d9315cb4.js";import{Q as he}from"./QBtnDropdown.16eb3d09.js";import{Q as Re}from"./QInnerLoading.a3395d83.js";import{Q as we,a as Ie}from"./QTable.967c4fee.js";import{Q as Ce,a as D}from"./QTooltip.66a0b9bf.js";import{Q as K}from"./QSelect.362fc43f.js";import{Q as L}from"./QTd.88d9027a.js";import{Q as B}from"./QBadge.3f84dac9.js";import{Q as Oe}from"./QPageSticky.4f7f0322.js";import{C as q}from"./ClosePopup.808ea52d.js";import{M as Ee}from"./index.2065a85c.js";import{u as xe}from"./useRolPermisos.637c804b.js";import{u as ue}from"./useHelpers.328dd33e.js";import{d as ke}from"./date.abdd825f.js";import{a as Ae}from"./use-quasar.da31b326.js";import{E as Ve}from"./exceljs.min.2e3e1cbd.js";import{_ as Ne}from"./DetalleProducts.dcaf437f.js";import{u as Se}from"./useImpresion.4d2c76f5.js";import{e as De}from"./vue3-q-tel-input.esm.10d44a57.js";import"./QBtnGroup.e8817a68.js";import"./axios.7d4088a1.js";const Te=()=>({generarExcel:k=>{let R=k.map(i=>[i.created_at.split(" ")[0],i.numero_comprobante,i.clave_acceso,i.customer_id.nombres,i.customer_id.numero_documento,i.subtotal,i.iva,i.total,i.estadoSRI]);R=R.filter(i=>i[8]=="AUTORIZADO");const w=new Ve.Workbook,I=w.addWorksheet("Hoja1");I.columns=[{header:"Fecha",key:"Fecha",width:15,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"# Documento",key:"Documento",width:22,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"CA/NA",key:"CA",width:53,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Persona",key:"Persona",width:45,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Identificaci\xF3n",key:"Identificaci\xF3n",width:18,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Subtotal",key:"Subtotal",width:14,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"IVA",key:"IVA",width:10,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Total",key:"Total",width:14,style:{font:{bold:!0},alignment:{horizontal:"center"}}}],R.forEach((i,b)=>{Object.assign(I.getCell(`A${b+2}`),{value:i[0],font:{bold:!1}}),Object.assign(I.getCell(`B${b+2}`),{value:i[1],font:{bold:!1}}),Object.assign(I.getCell(`C${b+2}`),{value:i[2],font:{bold:!1}}),Object.assign(I.getCell(`D${b+2}`),{value:i[3],font:{bold:!1}}),Object.assign(I.getCell(`E${b+2}`),{value:i[4],font:{bold:!1}}),Object.assign(I.getCell(`F${b+2}`),{value:i[5],font:{bold:!1}}),Object.assign(I.getCell(`G${b+2}`),{value:i[6],font:{bold:!1}}),Object.assign(I.getCell(`H${b+2}`),{value:i[7],font:{bold:!1}})}),w.xlsx.writeBuffer().then(i=>{const b=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=URL.createObjectURL(b),s=document.createElement("a");s.href=y,s.download="archivo.xlsx",document.body.appendChild(s),s.click(),document.body.removeChild(s)})}});const qe={class:"text-h6 text-center"},$e={class:"row flex flex-center"},Ue={class:"col-xs-11 col-sm-9 text-center q-mt-md q-mb-lg"},Fe=n("label",null,"Enviar por:",-1),Qe={key:0,class:"col-xs-11 col-sm-9 text-center q-mb-md"},Pe=n("label",null,"Celular del cliente:",-1),Le={key:1,class:"col-xs-11 col-sm-9 text-center"},ze=n("label",null,"Email del cliente:",-1),Me={class:"col-xs-9 col-md-12 flex justify-center q-ml-none"},je={__name:"ModalReenviarComproantes",props:["detalleFactura"],emits:["closeModal"],setup(H,{emit:k}){const R=H,{api:w,mostrarNotify:I,claim:i}=ue(),b=g(!1),y=g(!1),s=g({tipo_envio:"",telefono:"",email:""});s.value.telefono=R.detalleFactura.customer_id.celular,s.value.email=R.detalleFactura.customer_id.email;const z=()=>{b.value=!1;const d=/^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/;let m=[];return s.value.tipo_envio=="whatsapp"&&m.push("telefono"),s.value.tipo_envio=="email"&&m.push("email"),s.value.tipo_envio=="ambas"&&(m=["telefono","email"]),s.value.tipo_envio==""&&(m=["tipo_envio"]),s.value.email.length>5&&!d.test(s.value.email)&&(f.value.email.message="Ingresa un email valido",f.value.email.isValid=!1,b.value=!0),m.forEach(C=>{s.value[C].length==0&&(f.value[C].message="Debes completar este campo",f.value[C].isValid=!1,b.value=!0)}),b.value};function U(d){return d.startsWith("593")?d:(d=d.replace(/\s/g,"").replace(/-/g,""),d.startsWith("0")?"593"+d.substring(1):"593"+d)}const f=g({telefono:{message:"",isValid:!0},tipo_envio:{message:"",isValid:!0},email:{message:"",isValid:!0}}),W=async()=>{const{data:d}=await w.get(`/companies/find/${i.company.id}`);if(!z()&&!((s.value.tipo_envio=="whatsapp"||s.value.tipo_envio=="ambas")&&!f.value.telefono.isValid))try{y.value=!0,await w.post("/CE/facturas/reenviar-comprobantes",{...s.value,factura:R.detalleFactura,number:s.value.telefono,telefono:U(d[0].telefono)}),I("positive","Comprobantes enviados"),k("closeModal"),y.value=!1}catch(m){y.value=!1,I("warning",m.response.data.message),k("closeModal")}},G=d=>{f.value.telefono.isValid=!d};return(d,m)=>(r(),u(ce,{style:{width:"400px","max-width":"80vw"}},{default:a(()=>[t(le,null,{default:a(()=>[n("div",qe,[h(" Enviar Comprobantes "),T(t(O,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[q]])])]),_:1}),t(be,{inset:""}),t(le,{class:"q-pt-none"},{default:a(()=>[n("div",$e,[n("div",Ue,[Fe,t(K,{filled:"",dense:"",modelValue:s.value.tipo_envio,"onUpdate:modelValue":m[0]||(m[0]=C=>s.value.tipo_envio=C),error:!f.value.tipo_envio.isValid,"emit-value":"","map-options":"",options:[{label:"WhatsApp",value:"whatsapp"},{label:"Email",value:"email"},{label:"Ambas",value:"ambas"}]},{append:a(()=>[s.value.tipo_envio.length!=0&&s.value.tipo_envio=="whatsapp"?(r(),u(S,{key:0,name:"fa-brands fa-whatsapp",color:"teal-7"})):p("",!0),s.value.tipo_envio.length!=0&&s.value.tipo_envio=="email"?(r(),u(S,{key:1,name:"mail",color:"indigo-5"})):p("",!0),s.value.tipo_envio.length!=0&&s.value.tipo_envio=="ambas"?(r(),u(S,{key:2,name:"fa-solid fa-list-check",color:"deep-orange-4"})):p("",!0)]),error:a(()=>[n("label",{class:V(d.$q.dark.isActive?"text-red-4":"text-negative")},E(f.value.tipo_envio.message),3)]),_:1},8,["modelValue","error"])]),s.value.tipo_envio=="whatsapp"||s.value.tipo_envio=="ambas"?(r(),$("div",Qe,[Pe,t(c(De),{"default-country":"EC","search-text":"Buscar pais...","onUpdate:modelValue":m[1]||(m[1]=C=>f.value.telefono.isValid=!0),onError:G,error:!f.value.telefono.isValid,filled:"",dense:"",tel:s.value.telefono,"onUpdate:tel":m[2]||(m[2]=C=>s.value.telefono=C)},{error:a(()=>[n("label",{class:V(d.$q.dark.isActive?"text-red-4":"text-negative")},E(f.value.telefono.message),3)]),_:1},8,["error","tel"])])):p("",!0),s.value.tipo_envio=="email"||s.value.tipo_envio=="ambas"?(r(),$("div",Le,[ze,t(Z,{type:"email",modelValue:s.value.email,"onUpdate:modelValue":[m[3]||(m[3]=C=>s.value.email=C),m[4]||(m[4]=C=>f.value.email.isValid=!0)],"input-class":"resaltarTextoInput",error:!f.value.email.isValid,"lazy-rules":"",dense:"",filled:""},{error:a(()=>[n("label",{class:V(d.$q.dark.isActive?"text-red-4":"text-negative")},E(f.value.email.message),3)]),_:1},8,["modelValue","error"])])):p("",!0),n("div",Me,[t(O,{label:"Enviar",onClick:W,loading:y.value,class:"q-px-xl q-mt-md q-mb-md",outline:"",rounded:"",style:{color:"#696cff"}},null,8,["loading"])])])]),_:1})]),_:1}))}};const Be={class:"q-mx-lg q-pt-md"},Ze={class:"row q-col-gutter-lg"},He={style:{display:"flex"}},We={class:"col-xs-12 col-sm-3"},Ge={class:"q-mr-sm row q-pt-sm justify-center"},Je={class:"col-xs-10 col-sm-4"},Ye={class:"row items-center justify-end"},Xe={class:"col-xs-12 col-sm-1 flex flex-center"},Ke={class:"col-xs-10 col-sm-4"},el={class:"row items-center justify-end"},ll={key:0,class:"flex flex-center"},al={class:"col-12 q-pt-none"},ol={key:0,class:"text-center row justify-center",style:{width:"100%"}},tl=n("label",{class:"q-mb-sm text-grey-7 text-h6"}," Listado de Comprobantes ",-1),sl=[tl],nl=n("label",{class:"q-mr-sm row items-center"},[n("span",null,"Tipo: ")],-1),rl=n("label",{class:"q-mr-sm row items-center"},[n("span",null,"Por Sucursal: ")],-1),il=n("div",{class:"full-width row flex-center text-lime-10 q-gutter-sm"},[n("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun resultado ")],-1),Tl={__name:"IndexPage",setup(H){let k;const{api:R,claim:w,route:I}=ue(),i=()=>{const l=new Ee("https://facturacion.rednuevaconexion.net/socket.io/socket.io.js",{extraHeaders:{autentication:w.id}});k==null||k.removeAllListeners(),k=l.socket("/"),k.on("updateStateInvoice",async()=>{await x()})},b=[{name:"acciones",label:"acciones",align:"center"},{name:"sucursal",label:"Sucursal",align:"center"},{name:"num_comprobante",label:"Num. Comprobante",field:"numero_comprobante",align:"center"},{name:"usuario",label:"Usuario",align:"center"},{name:"cliente",label:"Cliente",align:"center"},{name:"f/h",label:"Fecha/Hora",align:"center",field:"created_at"},{name:"total",label:"Total",name:"total",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"}],y=g(""),s=g(""),z=g([]),U=g(!1),f=g(!1),{generarExcel:W}=Te(),G=async(l,o)=>{l.company_name=l.sucursal_id.company_id.nombre_comercial,l.ruc=l.sucursal_id.company_id.ruc,l.direccion=l.sucursal_id.direccion;const e={cliente:l.customer_id.nombres,tipoDoc:l.customer_id.tipo_documento,num_doc:l.customer_id.numero_documento,email:l.customer_id.email};l.forma_pago=="01"&&(l.forma_pago="SIN UTILIZACION DEL SISTEMA FINANCIERO"),l.forma_pago=="15"&&(l.forma_pago="COMPENSACI\xD3N DE DEUDAS"),l.forma_pago=="16"&&(l.forma_pago="TARJETA DE D\xC9BITO"),l.forma_pago=="17"&&(l.forma_pago="DINERO ELECTR\xD3NICO"),l.forma_pago=="18"&&(l.forma_pago="TARJETA PREPAGO"),l.forma_pago=="19"&&(l.forma_pago="TARJETA DE CR\xC9DITO"),l.forma_pago=="20"&&(l.forma_pago="OTROS CON UTILIZACI\xD3N DEL SISTEMA FINANCIERO"),l.forma_pago=="21"&&(l.forma_pago="ENDOSO DE T\xCDTULOS");const{imprimirFactura:_}=Se();let A=_(l,e,w.fullName,o);var Q=window.open("","_blank");Q.document.write(A),Q.print(),Q.close()},d=g("FACTURAS"),m=g(""),C=g({}),M=g([]),F=g([]),ee=g({}),{validarPermisos:J}=xe(),v=Ae(),j=g(!1);Y(d,(l,o)=>{x()});const de=()=>{const{tipo:l,fecha:o}=I.params;l!=""&&(d.value=l),o!=""&&(y.value=o.split(" - ")[0].replace(/-/g,"/"),s.value=o.split(" - ")[1].replace(/-/g,"/"))},x=async()=>{try{j.value=!0;let l={headers:{tipo:d.value,"sucursal-id":F.value,desde:y.value,hasta:s.value}};const{data:o}=await R.get("/invoices",l);o.map(e=>{e.created_at=ke.formatDate(e.created_at,"DD/MM/YYYY HH:mm a"),e.loading=!1}),z.value=o,j.value=!1}catch(l){console.log(l),j.value=!1}},me=async()=>{const{data:l}=await R.post("/invoices/download-comprobantes",{sucursal_id:F.value,desde:y.value,hasta:s.value},{responseType:"arraybuffer"}),o=new Blob([l],{type:"application/zip"}),e=document.createElement("a");e.href=window.URL.createObjectURL(o),e.download="facturas.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)},pe=l=>{v.dialog({title:"<center>\xBFEstas seguro de anular esta factura?</center>",message:`<span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Num Comprobante:
                  </strong>
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${l.numero_comprobante}
                  </label>
                </span>
              <span class='q-my-xs' style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Cliente:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  ${l.customer_id.nombres}
                </label>
              </span>
              <span class='q-my-xs' style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Fecha/Hora:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  ${l.created_at}
                </label>
              </span>
              <span style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Total:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  $${l.total}
                </label>
              </span>`,html:!0,ok:{push:!0,label:"Anular",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{l.loading=!0,await R.post("/CE/facturas/anularFactura",{factura:{...l,entity:"Ventas",tipo_comprobante:"nota_credito"}}),l.loading=!1}catch(o){console.log(o)}})};Y(F,(l,o)=>{x()});const fe=async l=>{j.value=!0,M.value=[];const{data:o}=await R.get(`/sucursal/find/${l}/company`);o.forEach(e=>{M.value.push({label:e.nombre,value:e.id})}),M.value.length!=0&&(F.value=M.value[0].value),x()},ve=async l=>{l.loading=!0;let o="",e="";l.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION"||l.estadoSRI.trim()=="ANULACION - RECIBIDA"?(o="factura",e=l.clave_acceso):(o="nota_credito",e=l.clave_acceso_nota_credito);const _=l.invoiceToProduct.map(P=>({aplicaIva:P.product_id.aplicaIva,cantidad:P.cantidad,pvp:P.product_id.pvp,descuento:P.product_id.descuento,nombre:P.product_id.nombre,codigoBarra:P.product_id.codigoBarra}));let A={headers:{"sucursal-id":l.sucursal_id.id}},Q={ambiente:l.sucursal_id.ambiente,clave_acceso:e,company_name:w.company.nombre_comercial,sucursal_id:l.sucursal_id.id,customer_id:l.customer_id.id,descripcion:l.descripcion,num_comprobante:l.numero_comprobante,tipo:"EMISION",subtotal:parseFloat(l.subtotal),iva:parseFloat(l.iva),descuento:parseFloat(l.descuento),total:parseFloat(l.total),entity:"Ventas",tipo_comprobante:o,pago_id:l.id,user_id:l.user_id.id,porcentaje_iva:l.porcentaje_iva,forma_pago:l.forma_pago,products:_};(l.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||l.estadoSRI.trim()=="ERROR ENVIO RECEPCION - ANULACION")&&await R.post("/CE/facturas/recepcionComprobantesOffline",Q,A),(l.estadoSRI.trim()=="RECIBIDA"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION - ANULACION")&&await R.post("/CE/facturas/autorizacionComprobantesOffline",Q,A)};i(),Y(m,(l,o)=>{x()}),w.roles[0]=="SUPER-ADMINISTRADOR"||w.roles[0]=="ADMINISTRADOR"?fe(w.company.id):x(),de();const N=g("list"),ge=g({rowsPerPage:10});return(l,o)=>(r(),$(oe,null,[n("div",Be,[n("div",Ze,[n("div",He,[n("div",{style:{display:"flex"},class:V([c(v).screen.xs?"q-mb-md q-mt-none q-pt-xs":"q-ml-lg q-pl-none q-my-md"])},[n("div",{class:V(["row",[c(v).screen.xs?"flex-center":""]])},[n("div",We,[n("label",Ge,[n("span",{class:V([c(v).screen.xs?"text-weight-bold":""])}," Filtrar por fecha: ",2)])]),n("div",Je,[t(Z,{outlined:"",dense:"",modelValue:y.value,"onUpdate:modelValue":o[2]||(o[2]=e=>y.value=e),mask:"date"},{append:a(()=>[y.value!==""?(r(),u(S,{key:0,name:"close",onClick:o[0]||(o[0]=e=>(y.value="",x())),class:"cursor-pointer"})):p("",!0),t(S,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(se,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(te,{modelValue:y.value,"onUpdate:modelValue":[o[1]||(o[1]=e=>y.value=e),x]},{default:a(()=>[n("div",Ye,[T(t(O,{label:"Close",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",Xe,[n("label",{class:V(["q-mx-md",[c(v).screen.xs?"text-weight-medium":""]])}," Hasta ",2)]),n("div",Ke,[t(Z,{outlined:"",dense:"",modelValue:s.value,"onUpdate:modelValue":o[5]||(o[5]=e=>s.value=e),mask:"date"},{append:a(()=>[s.value!==""?(r(),u(S,{key:0,name:"close",onClick:o[3]||(o[3]=e=>(s.value="",x())),class:"cursor-pointer"})):p("",!0),t(S,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(se,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(te,{modelValue:s.value,"onUpdate:modelValue":[o[4]||(o[4]=e=>s.value=e),x]},{default:a(()=>[n("div",el,[T(t(O,{onClick:x,label:"Close",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])],2)],2),c(v).screen.width>=935?(r(),$("div",ll,[t(he,{class:"q-ml-md",label:"Descargar Documento",outline:"",color:"primary",icon:"download"},{default:a(()=>[t(ye,null,{default:a(()=>[T((r(),u(ie,{clickable:"",onClick:me},{default:a(()=>[t(ne,null,{default:a(()=>[t(re,null,{default:a(()=>[h("Descargar Facturas")]),_:1})]),_:1})]),_:1})),[[q]]),T((r(),u(ie,{onClick:o[6]||(o[6]=e=>c(W)(z.value)),clickable:""},{default:a(()=>[t(ne,null,{default:a(()=>[t(re,null,{default:a(()=>[h("Descargar EXCEL")]),_:1})]),_:1})]),_:1})),[[q]])]),_:1})]),_:1})])):p("",!0)]),n("div",al,[t(ce,{flat:"",class:"shadow_custom"},{default:a(()=>[t(we,{"title-class":"text-grey-7 text-h6",rows:z.value,"hide-header":N.value==="grid",loading:j.value,columns:b,"row-key":"name",grid:N.value==="grid",filter:m.value,pagination:ge.value},{loading:a(()=>[t(Re,{showing:"",color:"primary"})]),header:a(e=>[t(Ce,{props:e,style:{height:"60px"}},{default:a(()=>[(r(!0),$(oe,null,_e(e.cols,_=>(r(),u(Ie,{key:_.name,props:e,class:"text-grey-7 text-weight-bold text-uppercase",style:{"font-size":"13px"}},{default:a(()=>[h(E(_.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"top-left":a(e=>[c(v).screen.xs?(r(),$("div",ol,sl)):p("",!0),n("div",{style:X([{display:"flex"},!c(v).screen.xs||"width: 100%;justify-content: center;position: relative;right: 8px;"]),class:V([c(v).screen.xs?"q-mb-md":""])},[nl,t(K,{outlined:"",dense:"",modelValue:d.value,"onUpdate:modelValue":o[7]||(o[7]=_=>d.value=_),"emit-value":"","map-options":"",options:[{label:"Todos",value:"TODOS"},{label:"Facturas",value:"FACTURAS"},{label:"Facturas Anuladas",value:"ANULADO"},{label:"Facturas Autorizadas",value:"AUTORIZADO"}]},null,8,["modelValue"])],6),c(w).roles[0]=="SUPER-ADMINISTRADOR"||c(w).roles[0]=="ADMINISTRADOR"?(r(),$("div",{key:1,style:X([!c(v).screen.xs||"width: 100%;justify-content: center;",{display:"flex"}]),class:V([c(v).screen.xs?"q-mb-md":"q-ml-lg"])},[rl,t(K,{outlined:"",dense:"",modelValue:F.value,"onUpdate:modelValue":o[8]||(o[8]=_=>F.value=_),"emit-value":"","map-options":"",options:M.value},null,8,["modelValue","options"])],6)):p("",!0)]),"top-right":a(e=>[c(v).screen.width>=1023&&c(J)("crear.venta")?(r(),u(O,{key:0,onClick:o[9]||(o[9]=_=>l.$router.push("/ventas/add")),outline:"",color:"primary",label:"Agregar Factura",class:"q-mr-xs"})):p("",!0),t(Z,{style:X(c(v).screen.width>700||"width: 70%"),outlined:"",dense:"",debounce:"300",modelValue:m.value,"onUpdate:modelValue":o[10]||(o[10]=_=>m.value=_),placeholder:"Buscar..."},{append:a(()=>[t(S,{name:"search"})]),_:1},8,["style","modelValue"]),N.value==="list"?(r(),u(O,{key:1,flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen},{default:a(()=>[T((r(),u(D,{disable:c(v).platform.is.mobile},{default:a(()=>[h(E(e.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"),1)]),_:2},1032,["disable"])),[[q]])]),_:2},1032,["icon","onClick"])):p("",!0),e.inFullscreen?p("",!0):(r(),u(O,{key:2,flat:"",round:"",dense:"",icon:N.value==="grid"?"list":"grid_on",onClick:o[11]||(o[11]=_=>{N.value=N.value==="grid"?"list":"grid",l.separator=N.value==="grid"?"none":"horizontal"})},{default:a(()=>[T((r(),u(D,{disable:c(v).platform.is.mobile},{default:a(()=>[h(E(N.value==="grid"?"List":"Grid"),1)]),_:1},8,["disable"])),[[q]])]),_:1},8,["icon"]))]),"body-cell-total":a(e=>[t(L,{props:e},{default:a(()=>[h(" $"+E(e.row.total),1)]),_:2},1032,["props"])]),"body-cell-cliente":a(e=>[t(L,{props:e},{default:a(()=>[h(E(e.row.customer_id.nombres),1)]),_:2},1032,["props"])]),"body-cell-sucursal":a(e=>[t(L,{props:e},{default:a(()=>[h(E(e.row.sucursal_id.nombre),1)]),_:2},1032,["props"])]),"body-cell-usuario":a(e=>[t(L,{props:e},{default:a(()=>[h(E(e.row.user_id.fullName.toUpperCase()),1)]),_:2},1032,["props"])]),"body-cell-estado":a(e=>[t(L,{props:e},{default:a(()=>[e.row.estadoSRI=="NO AUTORIZADO"||e.row.estadoSRI.trim()=="DEVUELTA"?(r(),u(B,{key:0,outline:"",class:"q-py-xs q-px-md",color:c(v).dark.isActive?"warning":"orange-10",label:e.row.estadoSRI},{default:a(()=>[t(D,{anchor:"center left",self:"center right",offset:[10,10],class:"blue-grey-9 text-subtitle2"},{default:a(()=>[h(E(e.row.respuestaSRI),1)]),_:2},1024)]),_:2},1032,["color","label"])):e.row.estadoSRI=="AUTORIZADO"?(r(),u(B,{key:1,outline:"",class:"q-py-xs q-px-md",color:"secondary",label:e.row.estadoSRI},null,8,["label"])):e.row.estadoSRI=="ANULADO"?(r(),u(B,{key:2,outline:"",class:"q-py-xs q-px-md",color:"red-4",label:e.row.estadoSRI},null,8,["label"])):(r(),u(B,{key:3,outline:"",class:"q-py-xs q-px-md",color:c(v).dark.isActive?"blue-grey-3":"blue-grey-7",label:e.row.estadoSRI},{default:a(()=>[t(D,{anchor:"center left",self:"center right",offset:[10,10],class:"blue-grey-9 text-subtitle2"},{default:a(()=>[h(E(e.row.respuestaSRI),1)]),_:2},1024)]),_:2},1032,["color","label"]))]),_:2},1032,["props"])]),"body-cell-acciones":a(e=>[t(L,{props:e},{default:a(()=>{var _;return[e.row.estadoSRI.trim()==="ERROR ENVIO RECEPCION"||e.row.estadoSRI.trim()==="ERROR ENVIO RECEPCION - ANULACION"||e.row.estadoSRI.trim()==="ERROR ENVIO AUTORIZACION"||e.row.estadoSRI.trim()==="ERROR ENVIO AUTORIZACION - ANULACION"?(r(),u(O,{key:0,round:"",color:"deep-orange-8",icon:"fa-solid fa-retweet",loading:e.row.loading,onClick:A=>ve(e.row),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(D,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[h(" Reenviar Factura Electr\xF3nica ")]),_:1})]),_:2},1032,["loading","onClick"])):p("",!0),e.row.estadoSRI.trim()!=="PROFORMA"?(r(),u(O,{key:1,round:"",color:"blue-grey",icon:"print",onClick:A=>G(e.row,"factura"),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(D,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[h(" Imprimir comprobante ")]),_:1})]),_:2},1032,["onClick"])):p("",!0),t(O,{round:"",color:"blue-grey",icon:"visibility",size:"10px",class:"q-mr-sm",onClick:A=>(f.value=!0,C.value={...e.row})},null,8,["onClick"]),e.row.estadoSRI=="PROFORMA"||e.row.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||e.row.estadoSRI.trim()=="ERROR ENVIO RECEPCION - ANULACION"||e.row.estadoSRI.trim()=="PENDIENTE"?(r(),u(O,{key:2,onClick:A=>l.$router.push(`ventas/add/${e.row.id}`),round:"",color:"blue-grey",icon:"description",size:"10px",class:"q-mr-sm"},null,8,["onClick"])):p("",!0),e.row.customer_id.nombres!=="CONSUMIDOR FINAL"&&(e.row.estadoSRI=="AUTORIZADO"||((_=e.row.respuestaSRI)==null?void 0:_.includes("ERROR SECUENCIAL REGISTRADO")))&&c(J)("anular.venta")?(r(),u(O,{key:3,round:"",color:"blue-grey",class:"q-mr-sm",onClick:A=>pe(e.row),loading:e.row.loading,icon:"close",size:"10px"},null,8,["onClick","loading"])):p("",!0),e.row.estadoSRI=="AUTORIZADO"||e.row.estadoSRI=="PROFORMA"?(r(),u(O,{key:4,round:"",color:"blue-grey",onClick:A=>(U.value=!0,ee.value=e.row),icon:"forward_to_inbox",size:"11px"},{default:a(()=>[t(D,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[h(" Enviar comprobante por email ")]),_:1})]),_:2},1032,["onClick"])):p("",!0)]}),_:2},1032,["props"])]),"no-data":a(({icon:e})=>[il]),_:1},8,["rows","hide-header","loading","grid","filter","pagination"])]),_:1})])])]),c(v).screen.width<=1023&&c(J)("crear.venta")?(r(),u(Oe,{key:0,position:"bottom-right",offset:[18,18]},{default:a(()=>[t(O,{round:"",color:"secondary",size:"lg",icon:"add",onClick:o[12]||(o[12]=e=>l.$router.push("/ventas/add"))})]),_:1})):p("",!0),t(ae,{modelValue:f.value,"onUpdate:modelValue":o[13]||(o[13]=e=>f.value=e)},{default:a(()=>[t(Ne,{detalleData:C.value},null,8,["detalleData"])]),_:1},8,["modelValue"]),t(ae,{modelValue:U.value,"onUpdate:modelValue":o[15]||(o[15]=e=>U.value=e)},{default:a(()=>[t(je,{onCloseModal:o[14]||(o[14]=e=>U.value=!1),detalleFactura:ee.value},null,8,["detalleFactura"])]),_:1},8,["modelValue"])],64))}};export{Tl as default};
