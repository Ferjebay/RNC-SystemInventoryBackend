import{api as d}from"./axios.aaa8af3b.js";import{u as V}from"./useHelpers.aa70fe88.js";import{r as o}from"./index.34de80b5.js";const m=o(!1),_=o(""),l=o([]),e=o({id:"",nombre_plan:"",descripcion:"",precio_plan:0,impuesto:0,descarga_Mbps:0,subida_Mbps:0,limit_at:0,burst_limit:0,prioridad:"",address_list:"",router_id:""}),u=o({nombre_plan:{message:"",isValid:!0},descripcion:{message:"",isValid:!0},precio_plan:{message:"",isValid:!0},impuesto:{message:"",isValid:!0},descarga_Mbps:{message:"",isValid:!0},subida_Mbps:{message:"",isValid:!0},limit_at:{message:"",isValid:!0},burst_limit:{message:"",isValid:!0},prioridad:{message:"",isValid:!0},address_list:{message:"",isValid:!0},router_id:{message:"",isValid:!0}}),h=s=>{let i=0;i=e.value[s];const t=/^\d{0,9}(\.\d{1,2})?$/;setTimeout(function(){let n=0;if(n=e.value[s],!t.test(n.toString())){const p=parseFloat(i.toString().substring(0,i.toString().length-1));e.value[s]=p}},0)},x=s=>{const{mostrarNotify:i,claim:t,router:n,route:p}=V(),c=["nombre_plan","precio_plan","descarga_Mbps","subida_Mbps","prioridad"],g=async()=>{l.value=[];const{data:r}=await d.get(`/router/find/${t.company.id}`);r.forEach(a=>{l.value.push({label:a.nombre,value:a.id})}),l.value.length>0&&(s||(e.value.router_id=l.value[0].value),_.value=l.value[0].value)},v=()=>{e.value={id:"",nombre_plan:"",descripcion:"",precio_plan:0,impuesto:0,descarga_Mbps:0,subida_Mbps:0,limit_at:0,burst_limit:0,prioridad:"",address_list:"",router_id:""}},b=()=>{c.push("router_id"),c.forEach(r=>{u.value[r].isValid=!0})},f=()=>{let r=!1;return c.forEach(a=>{(e.value[a].length==0||e.value[a]==0)&&(u.value[a].message="Debes completar este campo",u.value[a].isValid=!1,r=!0)}),!s&&e.value.router_id.length==0&&t.roles[0]=="Super-Administrador"&&(u.value.router_id.message="Debes elegir una empresa",u.value.router_id.isValid=!1,r=!0),r};return{api:d,claim:t,formInternet:e,loading:m,limpiarFormulario:v,listRouters:l,validaciones:u,cargarRouters:g,quitarErrores:b,route:p,selectedRouter:_,validDecimal:h,onSubmit:async r=>{if(!f())try{m.value=!0;let a={headers:{router_id:e.value.router_id,NotSetHeaderCompany:t.roles[0]=="Super-Administrador"}};r?await d.patch(`/internet/${e.value.id}`,e.value):await d.post("/internet",e.value,a),i("positive",`Router ${r?"editado":"agregado"} exitosamente`),m.value=!1,n.push({name:"internet.index"})}catch(a){m.value=!1,i("warning",a.response.data.message)}}}};export{x as u};
