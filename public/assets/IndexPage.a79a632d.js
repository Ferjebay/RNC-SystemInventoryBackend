import{r as v,o as r,a9 as d,g as a,f as t,aV as le,e as n,aa as R,O as T,h as C,ah as ge,i as S,af as p,ae as V,ab as O,c as $,ad as c,Q as Z,aU as ue,v as Y,ba as ae,aj as oe,ai as _e,bc as W}from"./index.88a4758e.js";import{Q as te}from"./QDate.2837a26d.js";import{Q as se}from"./QPopupProxy.13ed0862.js";import{Q as ne,d as re,a as ie}from"./format.cb747f31.js";import{Q as ye}from"./QList.2a156311.js";import{Q as Re}from"./QBtnDropdown.b6fa33fe.js";import{Q as he}from"./QInnerLoading.47cda076.js";import{Q as we,a as Ie}from"./QTable.258469d5.js";import{Q as Ce,a as D}from"./QTooltip.7d73e3b4.js";import{Q as X}from"./QSelect.725cedae.js";import{Q as P}from"./QTd.14894484.js";import{Q as B}from"./QBadge.275ab309.js";import{Q as Oe}from"./QPageSticky.cffa758c.js";import{C as q}from"./ClosePopup.6c14ad70.js";import{M as Ee}from"./index.2065a85c.js";import{u as xe}from"./useRolPermisos.fff07020.js";import{u as ce}from"./useHelpers.56598498.js";import{d as ke}from"./date.825f5c98.js";import{a as Ae}from"./use-quasar.ef536af4.js";import{E as Ve}from"./exceljs.min.beadbae0.js";import{_ as Ne}from"./DetalleProducts.f7eb81ce.js";import{u as Se}from"./useImpresion.4d2c76f5.js";import{e as De}from"./vue3-q-tel-input.esm.dd43d475.js";import"./QBtnGroup.3f802092.js";import"./axios.9d18f2e3.js";const Te=()=>({generarExcel:k=>{let h=k.map(i=>[i.created_at.split(" ")[0],i.numero_comprobante,i.clave_acceso,i.customer_id.nombres,i.customer_id.numero_documento,i.subtotal,i.iva,i.total,i.estadoSRI]);h=h.filter(i=>i[8]=="AUTORIZADO");const w=new Ve.Workbook,I=w.addWorksheet("Hoja1");I.columns=[{header:"Fecha",key:"Fecha",width:15,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"# Documento",key:"Documento",width:22,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"CA/NA",key:"CA",width:53,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Persona",key:"Persona",width:45,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Identificaci\xF3n",key:"Identificaci\xF3n",width:18,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Subtotal",key:"Subtotal",width:14,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"IVA",key:"IVA",width:10,style:{font:{bold:!0},alignment:{horizontal:"center"}}},{header:"Total",key:"Total",width:14,style:{font:{bold:!0},alignment:{horizontal:"center"}}}],h.forEach((i,b)=>{Object.assign(I.getCell(`A${b+2}`),{value:i[0],font:{bold:!1}}),Object.assign(I.getCell(`B${b+2}`),{value:i[1],font:{bold:!1}}),Object.assign(I.getCell(`C${b+2}`),{value:i[2],font:{bold:!1}}),Object.assign(I.getCell(`D${b+2}`),{value:i[3],font:{bold:!1}}),Object.assign(I.getCell(`E${b+2}`),{value:i[4],font:{bold:!1}}),Object.assign(I.getCell(`F${b+2}`),{value:i[5],font:{bold:!1}}),Object.assign(I.getCell(`G${b+2}`),{value:i[6],font:{bold:!1}}),Object.assign(I.getCell(`H${b+2}`),{value:i[7],font:{bold:!1}})}),w.xlsx.writeBuffer().then(i=>{const b=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),_=URL.createObjectURL(b),s=document.createElement("a");s.href=_,s.download="archivo.xlsx",document.body.appendChild(s),s.click(),document.body.removeChild(s)})}});const qe={class:"text-h6 text-center"},$e={class:"row flex flex-center"},Ue={class:"col-xs-11 col-sm-9 text-center q-mt-md q-mb-lg"},Fe=n("label",null,"Enviar por:",-1),Qe={key:0,class:"col-xs-11 col-sm-9 text-center q-mb-md"},Pe=n("label",null,"Celular del cliente:",-1),Le={key:1,class:"col-xs-11 col-sm-9 text-center"},ze=n("label",null,"Email del cliente:",-1),Me={class:"col-xs-9 col-md-12 flex justify-center q-ml-none"},je={__name:"ModalReenviarComproantes",props:["detalleFactura"],emits:["closeModal"],setup(H,{emit:k}){const h=H,{api:w,mostrarNotify:I,claim:i}=ce(),b=v(!1),_=v(!1),s=v({tipo_envio:"",telefono:"",email:""});s.value.telefono=h.detalleFactura.customer_id.celular,s.value.email=h.detalleFactura.customer_id.email;const L=()=>{b.value=!1;const E=/^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/;let u=[];return s.value.tipo_envio=="whatsapp"&&u.push("telefono"),s.value.tipo_envio=="email"&&u.push("email"),s.value.tipo_envio=="ambas"&&(u=["telefono","email"]),s.value.tipo_envio==""&&(u=["tipo_envio"]),s.value.email.length>5&&!E.test(s.value.email)&&(m.value.email.message="Ingresa un email valido",m.value.email.isValid=!1,b.value=!0),u.forEach(y=>{s.value[y].length==0&&(m.value[y].message="Debes completar este campo",m.value[y].isValid=!1,b.value=!0)}),b.value},m=v({telefono:{message:"",isValid:!0},tipo_envio:{message:"",isValid:!0},email:{message:"",isValid:!0}}),z=async()=>{const{data:E}=await w.get(`/companies/find/${i.company.id}`);if(!L()&&!((s.value.tipo_envio=="whatsapp"||s.value.tipo_envio=="ambas")&&!m.value.telefono.isValid))try{_.value=!0,await w.post("/CE/facturas/reenviar-comprobantes",{...s.value,factura:h.detalleFactura,number:s.value.telefono,telefono:E[0].telefono}),I("positive","Comprobantes enviados"),k("closeModal"),_.value=!1}catch(u){_.value=!1,I("warning",u.response.data.message),k("closeModal")}},G=E=>{m.value.telefono.isValid=!E};return(E,u)=>(r(),d(ue,{style:{width:"400px","max-width":"80vw"}},{default:a(()=>[t(le,null,{default:a(()=>[n("div",qe,[R(" Enviar Comprobantes "),T(t(C,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[q]])])]),_:1}),t(ge,{inset:""}),t(le,{class:"q-pt-none"},{default:a(()=>[n("div",$e,[n("div",Ue,[Fe,t(X,{filled:"",dense:"",modelValue:s.value.tipo_envio,"onUpdate:modelValue":u[0]||(u[0]=y=>s.value.tipo_envio=y),error:!m.value.tipo_envio.isValid,"emit-value":"","map-options":"",options:[{label:"WhatsApp",value:"whatsapp"},{label:"Email",value:"email"},{label:"Ambas",value:"ambas"}]},{append:a(()=>[s.value.tipo_envio.length!=0&&s.value.tipo_envio=="whatsapp"?(r(),d(S,{key:0,name:"fa-brands fa-whatsapp",color:"teal-7"})):p("",!0),s.value.tipo_envio.length!=0&&s.value.tipo_envio=="email"?(r(),d(S,{key:1,name:"mail",color:"indigo-5"})):p("",!0),s.value.tipo_envio.length!=0&&s.value.tipo_envio=="ambas"?(r(),d(S,{key:2,name:"fa-solid fa-list-check",color:"deep-orange-4"})):p("",!0)]),error:a(()=>[n("label",{class:V(E.$q.dark.isActive?"text-red-4":"text-negative")},O(m.value.tipo_envio.message),3)]),_:1},8,["modelValue","error"])]),s.value.tipo_envio=="whatsapp"||s.value.tipo_envio=="ambas"?(r(),$("div",Qe,[Pe,t(c(De),{"default-country":"EC","search-text":"Buscar pais...","onUpdate:modelValue":u[1]||(u[1]=y=>m.value.telefono.isValid=!0),onError:G,error:!m.value.telefono.isValid,filled:"",dense:"",tel:s.value.telefono,"onUpdate:tel":u[2]||(u[2]=y=>s.value.telefono=y)},{error:a(()=>[n("label",{class:V(E.$q.dark.isActive?"text-red-4":"text-negative")},O(m.value.telefono.message),3)]),_:1},8,["error","tel"])])):p("",!0),s.value.tipo_envio=="email"||s.value.tipo_envio=="ambas"?(r(),$("div",Le,[ze,t(Z,{type:"email",modelValue:s.value.email,"onUpdate:modelValue":[u[3]||(u[3]=y=>s.value.email=y),u[4]||(u[4]=y=>m.value.email.isValid=!0)],"input-class":"resaltarTextoInput",error:!m.value.email.isValid,"lazy-rules":"",dense:"",filled:""},{error:a(()=>[n("label",{class:V(E.$q.dark.isActive?"text-red-4":"text-negative")},O(m.value.email.message),3)]),_:1},8,["modelValue","error"])])):p("",!0),n("div",Me,[t(C,{label:"Enviar",onClick:z,loading:_.value,class:"q-px-xl q-mt-md q-mb-md",outline:"",rounded:"",style:{color:"#696cff"}},null,8,["loading"])])])]),_:1})]),_:1}))}};const Be={class:"q-mx-lg q-pt-md"},Ze={class:"row q-col-gutter-lg"},He={style:{display:"flex"}},Ge={class:"col-xs-12 col-sm-3"},Je={class:"q-mr-sm row q-pt-sm justify-center"},Ye={class:"col-xs-10 col-sm-4"},We={class:"row items-center justify-end"},Xe={class:"col-xs-12 col-sm-1 flex flex-center"},Ke={class:"col-xs-10 col-sm-4"},el={class:"row items-center justify-end"},ll={key:0,class:"flex flex-center"},al={class:"col-12 q-pt-none"},ol={key:0,class:"text-center row justify-center",style:{width:"100%"}},tl=n("label",{class:"q-mb-sm text-grey-7 text-h6"}," Listado de Comprobantes ",-1),sl=[tl],nl=n("label",{class:"q-mr-sm row items-center"},[n("span",null,"Tipo: ")],-1),rl=n("label",{class:"q-mr-sm row items-center"},[n("span",null,"Por Sucursal: ")],-1),il=n("div",{class:"full-width row flex-center text-lime-10 q-gutter-sm"},[n("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun resultado ")],-1),Tl={__name:"IndexPage",setup(H){let k;const{api:h,claim:w,route:I}=ce(),i=()=>{const l=new Ee("https://facturacion.rednuevaconexion.net/socket.io/socket.io.js",{extraHeaders:{autentication:w.id}});k==null||k.removeAllListeners(),k=l.socket("/"),k.on("updateStateInvoice",async()=>{await x()})},b=[{name:"acciones",label:"acciones",align:"center"},{name:"sucursal",label:"Sucursal",align:"center"},{name:"num_comprobante",label:"Num. Comprobante",field:"numero_comprobante",align:"center"},{name:"usuario",label:"Usuario",align:"center"},{name:"cliente",label:"Cliente",align:"center"},{name:"f/h",label:"Fecha/Hora",align:"center",field:"created_at"},{name:"total",label:"Total",name:"total",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"}],_=v(""),s=v(""),L=v([]),m=v(!1),z=v(!1),{generarExcel:G}=Te(),E=async(l,o)=>{l.company_name=l.sucursal_id.company_id.nombre_comercial,l.ruc=l.sucursal_id.company_id.ruc,l.direccion=l.sucursal_id.direccion;const e={cliente:l.customer_id.nombres,tipoDoc:l.customer_id.tipo_documento,num_doc:l.customer_id.numero_documento,email:l.customer_id.email};l.forma_pago=="01"&&(l.forma_pago="SIN UTILIZACION DEL SISTEMA FINANCIERO"),l.forma_pago=="15"&&(l.forma_pago="COMPENSACI\xD3N DE DEUDAS"),l.forma_pago=="16"&&(l.forma_pago="TARJETA DE D\xC9BITO"),l.forma_pago=="17"&&(l.forma_pago="DINERO ELECTR\xD3NICO"),l.forma_pago=="18"&&(l.forma_pago="TARJETA PREPAGO"),l.forma_pago=="19"&&(l.forma_pago="TARJETA DE CR\xC9DITO"),l.forma_pago=="20"&&(l.forma_pago="OTROS CON UTILIZACI\xD3N DEL SISTEMA FINANCIERO"),l.forma_pago=="21"&&(l.forma_pago="ENDOSO DE T\xCDTULOS");const{imprimirFactura:g}=Se();let A=g(l,e,w.fullName,o);var F=window.open("","_blank");F.document.write(A),F.print(),F.close()},u=v("FACTURAS"),y=v(""),K=v({}),M=v([]),U=v([]),ee=v({}),{validarPermisos:J}=xe(),f=Ae(),j=v(!1);Y(u,(l,o)=>{x()});const de=()=>{const{tipo:l,fecha:o}=I.params;l!=""&&(u.value=l),o!=""&&(_.value=o.split(" - ")[0].replace(/-/g,"/"),s.value=o.split(" - ")[1].replace(/-/g,"/"))},x=async()=>{try{j.value=!0;let l={headers:{tipo:u.value,"sucursal-id":U.value,desde:_.value,hasta:s.value}};const{data:o}=await h.get("/invoices",l);o.map(e=>{e.created_at=ke.formatDate(e.created_at,"DD/MM/YYYY HH:mm a"),e.loading=!1}),L.value=o,j.value=!1}catch(l){console.log(l),j.value=!1}},me=async()=>{const{data:l}=await h.post("/invoices/download-comprobantes",{sucursal_id:U.value,desde:_.value,hasta:s.value},{responseType:"arraybuffer"}),o=new Blob([l],{type:"application/zip"}),e=document.createElement("a");e.href=window.URL.createObjectURL(o),e.download="facturas.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)},pe=l=>{f.dialog({title:"<center>\xBFEstas seguro de anular esta factura?</center>",message:`<span style="display: block;width: 100%;display: flex;align-items: center;">
                  <strong style="display: inline-block;width: 40%;text-align: end;">
                    Num Comprobante:
                  </strong>
                  <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                    ${l.numero_comprobante}
                  </label>
                </span>
              <span class='q-my-xs' style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Cliente:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  ${l.customer_id.nombres}
                </label>
              </span>
              <span class='q-my-xs' style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Fecha/Hora:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  ${l.created_at}
                </label>
              </span>
              <span style="display: block;width: 100%;display: flex;align-items: center;">
                <strong style="display: inline-block;width: 40%;text-align: end;">
                  Total:
                </strong>
                <label style="display: inline-block;width: 57%;" class="q-ml-xs">
                  $${l.total}
                </label>
              </span>`,html:!0,ok:{push:!0,label:"Anular",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{l.loading=!0,await h.post("/CE/facturas/anularFactura",{factura:{...l,entity:"Ventas",tipo_comprobante:"nota_credito"}}),l.loading=!1}catch(o){console.log(o)}})};Y(U,(l,o)=>{x()});const fe=async l=>{j.value=!0,M.value=[];const{data:o}=await h.get(`/sucursal/find/${l}/company`);o.forEach(e=>{M.value.push({label:e.nombre,value:e.id})}),M.value.length!=0&&(U.value=M.value[0].value),x()},ve=async l=>{l.loading=!0;let o="",e="";l.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION"||l.estadoSRI.trim()=="ANULACION - RECIBIDA"?(o="factura",e=l.clave_acceso):(o="nota_credito",e=l.clave_acceso_nota_credito);const g=l.invoiceToProduct.map(Q=>({aplicaIva:Q.product_id.aplicaIva,cantidad:Q.cantidad,pvp:Q.product_id.pvp,descuento:Q.product_id.descuento,nombre:Q.product_id.nombre,codigoBarra:Q.product_id.codigoBarra}));let A={headers:{"sucursal-id":l.sucursal_id.id}},F={ambiente:l.sucursal_id.ambiente,clave_acceso:e,company_name:w.company.nombre_comercial,sucursal_id:l.sucursal_id.id,customer_id:l.customer_id.id,descripcion:l.descripcion,num_comprobante:l.numero_comprobante,tipo:"EMISION",subtotal:parseFloat(l.subtotal),iva:parseFloat(l.iva),descuento:parseFloat(l.descuento),total:parseFloat(l.total),entity:"Ventas",tipo_comprobante:o,pago_id:l.id,user_id:l.user_id.id,porcentaje_iva:l.porcentaje_iva,forma_pago:l.forma_pago,products:g};(l.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||l.estadoSRI.trim()=="ERROR ENVIO RECEPCION - ANULACION")&&await h.post("/CE/facturas/recepcionComprobantesOffline",F,A),(l.estadoSRI.trim()=="RECIBIDA"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION"||l.estadoSRI.trim()=="ERROR ENVIO AUTORIZACION - ANULACION")&&await h.post("/CE/facturas/autorizacionComprobantesOffline",F,A)};i(),Y(y,(l,o)=>{x()}),w.roles[0]=="SUPER-ADMINISTRADOR"||w.roles[0]=="ADMINISTRADOR"?fe(w.company.id):x(),de();const N=v("list"),be=v({rowsPerPage:10});return(l,o)=>(r(),$(oe,null,[n("div",Be,[n("div",Ze,[n("div",He,[n("div",{style:{display:"flex"},class:V([c(f).screen.xs?"q-mb-md q-mt-none q-pt-xs":"q-ml-lg q-pl-none q-my-md"])},[n("div",{class:V(["row",[c(f).screen.xs?"flex-center":""]])},[n("div",Ge,[n("label",Je,[n("span",{class:V([c(f).screen.xs?"text-weight-bold":""])}," Filtrar por fecha: ",2)])]),n("div",Ye,[t(Z,{outlined:"",dense:"",modelValue:_.value,"onUpdate:modelValue":o[2]||(o[2]=e=>_.value=e),mask:"date"},{append:a(()=>[_.value!==""?(r(),d(S,{key:0,name:"close",onClick:o[0]||(o[0]=e=>(_.value="",x())),class:"cursor-pointer"})):p("",!0),t(S,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(se,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(te,{modelValue:_.value,"onUpdate:modelValue":[o[1]||(o[1]=e=>_.value=e),x]},{default:a(()=>[n("div",We,[T(t(C,{label:"Close",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",Xe,[n("label",{class:V(["q-mx-md",[c(f).screen.xs?"text-weight-medium":""]])}," Hasta ",2)]),n("div",Ke,[t(Z,{outlined:"",dense:"",modelValue:s.value,"onUpdate:modelValue":o[5]||(o[5]=e=>s.value=e),mask:"date"},{append:a(()=>[s.value!==""?(r(),d(S,{key:0,name:"close",onClick:o[3]||(o[3]=e=>(s.value="",x())),class:"cursor-pointer"})):p("",!0),t(S,{name:"event",class:"cursor-pointer"},{default:a(()=>[t(se,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[t(te,{modelValue:s.value,"onUpdate:modelValue":[o[4]||(o[4]=e=>s.value=e),x]},{default:a(()=>[n("div",el,[T(t(C,{onClick:x,label:"Close",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])],2)],2),c(f).screen.width>=935?(r(),$("div",ll,[t(Re,{class:"q-ml-md",label:"Descargar Documento",outline:"",color:"primary",icon:"download"},{default:a(()=>[t(ye,null,{default:a(()=>[T((r(),d(ie,{clickable:"",onClick:me},{default:a(()=>[t(ne,null,{default:a(()=>[t(re,null,{default:a(()=>[R("Descargar Facturas")]),_:1})]),_:1})]),_:1})),[[q]]),T((r(),d(ie,{onClick:o[6]||(o[6]=e=>c(G)(L.value)),clickable:""},{default:a(()=>[t(ne,null,{default:a(()=>[t(re,null,{default:a(()=>[R("Descargar EXCEL")]),_:1})]),_:1})]),_:1})),[[q]])]),_:1})]),_:1})])):p("",!0)]),n("div",al,[t(ue,{flat:"",class:"shadow_custom"},{default:a(()=>[t(we,{"title-class":"text-grey-7 text-h6",rows:L.value,"hide-header":N.value==="grid",loading:j.value,columns:b,"row-key":"name",grid:N.value==="grid",filter:y.value,pagination:be.value},{loading:a(()=>[t(he,{showing:"",color:"primary"})]),header:a(e=>[t(Ce,{props:e,style:{height:"60px"}},{default:a(()=>[(r(!0),$(oe,null,_e(e.cols,g=>(r(),d(Ie,{key:g.name,props:e,class:"text-grey-7 text-weight-bold text-uppercase",style:{"font-size":"13px"}},{default:a(()=>[R(O(g.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"top-left":a(e=>[c(f).screen.xs?(r(),$("div",ol,sl)):p("",!0),n("div",{style:W([{display:"flex"},!c(f).screen.xs||"width: 100%;justify-content: center;position: relative;right: 8px;"]),class:V([c(f).screen.xs?"q-mb-md":""])},[nl,t(X,{outlined:"",dense:"",modelValue:u.value,"onUpdate:modelValue":o[7]||(o[7]=g=>u.value=g),"emit-value":"","map-options":"",options:[{label:"Todos",value:"TODOS"},{label:"Facturas",value:"FACTURAS"},{label:"Facturas Anuladas",value:"ANULADO"},{label:"Facturas Autorizadas",value:"AUTORIZADO"}]},null,8,["modelValue"])],6),c(w).roles[0]=="SUPER-ADMINISTRADOR"||c(w).roles[0]=="ADMINISTRADOR"?(r(),$("div",{key:1,style:W([!c(f).screen.xs||"width: 100%;justify-content: center;",{display:"flex"}]),class:V([c(f).screen.xs?"q-mb-md":"q-ml-lg"])},[rl,t(X,{outlined:"",dense:"",modelValue:U.value,"onUpdate:modelValue":o[8]||(o[8]=g=>U.value=g),"emit-value":"","map-options":"",options:M.value},null,8,["modelValue","options"])],6)):p("",!0)]),"top-right":a(e=>[c(f).screen.width>=1023&&c(J)("crear.venta")?(r(),d(C,{key:0,onClick:o[9]||(o[9]=g=>l.$router.push("/ventas/add")),outline:"",color:"primary",label:"Agregar Factura",class:"q-mr-xs"})):p("",!0),t(Z,{style:W(c(f).screen.width>700||"width: 70%"),outlined:"",dense:"",debounce:"300",modelValue:y.value,"onUpdate:modelValue":o[10]||(o[10]=g=>y.value=g),placeholder:"Buscar..."},{append:a(()=>[t(S,{name:"search"})]),_:1},8,["style","modelValue"]),N.value==="list"?(r(),d(C,{key:1,flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen},{default:a(()=>[T((r(),d(D,{disable:c(f).platform.is.mobile},{default:a(()=>[R(O(e.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"),1)]),_:2},1032,["disable"])),[[q]])]),_:2},1032,["icon","onClick"])):p("",!0),e.inFullscreen?p("",!0):(r(),d(C,{key:2,flat:"",round:"",dense:"",icon:N.value==="grid"?"list":"grid_on",onClick:o[11]||(o[11]=g=>{N.value=N.value==="grid"?"list":"grid",l.separator=N.value==="grid"?"none":"horizontal"})},{default:a(()=>[T((r(),d(D,{disable:c(f).platform.is.mobile},{default:a(()=>[R(O(N.value==="grid"?"List":"Grid"),1)]),_:1},8,["disable"])),[[q]])]),_:1},8,["icon"]))]),"body-cell-total":a(e=>[t(P,{props:e},{default:a(()=>[R(" $"+O(e.row.total),1)]),_:2},1032,["props"])]),"body-cell-cliente":a(e=>[t(P,{props:e},{default:a(()=>[R(O(e.row.customer_id.nombres),1)]),_:2},1032,["props"])]),"body-cell-sucursal":a(e=>[t(P,{props:e},{default:a(()=>[R(O(e.row.sucursal_id.nombre),1)]),_:2},1032,["props"])]),"body-cell-usuario":a(e=>[t(P,{props:e},{default:a(()=>[R(O(e.row.user_id.fullName.toUpperCase()),1)]),_:2},1032,["props"])]),"body-cell-estado":a(e=>[t(P,{props:e},{default:a(()=>[e.row.estadoSRI=="NO AUTORIZADO"||e.row.estadoSRI.trim()=="DEVUELTA"?(r(),d(B,{key:0,outline:"",class:"q-py-xs q-px-md",color:c(f).dark.isActive?"warning":"orange-10",label:e.row.estadoSRI},{default:a(()=>[t(D,{anchor:"center left",self:"center right",offset:[10,10],class:"blue-grey-9 text-subtitle2"},{default:a(()=>[R(O(e.row.respuestaSRI),1)]),_:2},1024)]),_:2},1032,["color","label"])):e.row.estadoSRI=="AUTORIZADO"?(r(),d(B,{key:1,outline:"",class:"q-py-xs q-px-md",color:"secondary",label:e.row.estadoSRI},null,8,["label"])):e.row.estadoSRI=="ANULADO"?(r(),d(B,{key:2,outline:"",class:"q-py-xs q-px-md",color:"red-4",label:e.row.estadoSRI},null,8,["label"])):(r(),d(B,{key:3,outline:"",class:"q-py-xs q-px-md",color:c(f).dark.isActive?"blue-grey-3":"blue-grey-7",label:e.row.estadoSRI},{default:a(()=>[t(D,{anchor:"center left",self:"center right",offset:[10,10],class:"blue-grey-9 text-subtitle2"},{default:a(()=>[R(O(e.row.respuestaSRI),1)]),_:2},1024)]),_:2},1032,["color","label"]))]),_:2},1032,["props"])]),"body-cell-acciones":a(e=>[t(P,{props:e},{default:a(()=>{var g;return[e.row.estadoSRI.trim()==="ERROR ENVIO RECEPCION"||e.row.estadoSRI.trim()==="ERROR ENVIO RECEPCION - ANULACION"||e.row.estadoSRI.trim()==="ERROR ENVIO AUTORIZACION"||e.row.estadoSRI.trim()==="ERROR ENVIO AUTORIZACION - ANULACION"?(r(),d(C,{key:0,round:"",color:"deep-orange-8",icon:"fa-solid fa-retweet",loading:e.row.loading,onClick:A=>ve(e.row),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(D,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[R(" Reenviar Factura Electr\xF3nica ")]),_:1})]),_:2},1032,["loading","onClick"])):p("",!0),e.row.estadoSRI.trim()!=="PROFORMA"?(r(),d(C,{key:1,round:"",color:"blue-grey",icon:"print",onClick:A=>E(e.row,"factura"),size:"10px",class:"q-mr-sm"},{default:a(()=>[t(D,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[R(" Imprimir comprobante ")]),_:1})]),_:2},1032,["onClick"])):p("",!0),t(C,{round:"",color:"blue-grey",icon:"visibility",size:"10px",class:"q-mr-sm",onClick:A=>(z.value=!0,K.value={...e.row})},null,8,["onClick"]),e.row.estadoSRI=="PROFORMA"||e.row.estadoSRI.trim()=="ERROR ENVIO RECEPCION"||e.row.estadoSRI.trim()=="ERROR ENVIO RECEPCION - ANULACION"||e.row.estadoSRI.trim()=="PENDIENTE"?(r(),d(C,{key:2,onClick:A=>l.$router.push(`ventas/add/${e.row.id}`),round:"",color:"blue-grey",icon:"description",size:"10px",class:"q-mr-sm"},null,8,["onClick"])):p("",!0),e.row.customer_id.nombres!=="CONSUMIDOR FINAL"&&(e.row.estadoSRI=="AUTORIZADO"||((g=e.row.respuestaSRI)==null?void 0:g.includes("ERROR SECUENCIAL REGISTRADO")))&&c(J)("anular.venta")?(r(),d(C,{key:3,round:"",color:"blue-grey",class:"q-mr-sm",onClick:A=>pe(e.row),loading:e.row.loading,icon:"close",size:"10px"},null,8,["onClick","loading"])):p("",!0),e.row.estadoSRI=="AUTORIZADO"||e.row.estadoSRI=="PROFORMA"?(r(),d(C,{key:4,round:"",color:"blue-grey",onClick:A=>(m.value=!0,ee.value=e.row),icon:"forward_to_inbox",size:"11px"},{default:a(()=>[t(D,{class:"bg-indigo",anchor:"top middle",self:"center middle"},{default:a(()=>[R(" Enviar comprobante por email ")]),_:1})]),_:2},1032,["onClick"])):p("",!0)]}),_:2},1032,["props"])]),"no-data":a(({icon:e})=>[il]),_:1},8,["rows","hide-header","loading","grid","filter","pagination"])]),_:1})])])]),c(f).screen.width<=1023&&c(J)("crear.venta")?(r(),d(Oe,{key:0,position:"bottom-right",offset:[18,18]},{default:a(()=>[t(C,{round:"",color:"secondary",size:"lg",icon:"add",onClick:o[12]||(o[12]=e=>l.$router.push("/ventas/add"))})]),_:1})):p("",!0),t(ae,{modelValue:z.value,"onUpdate:modelValue":o[13]||(o[13]=e=>z.value=e)},{default:a(()=>[t(Ne,{detalleData:K.value},null,8,["detalleData"])]),_:1},8,["modelValue"]),t(ae,{modelValue:m.value,"onUpdate:modelValue":o[15]||(o[15]=e=>m.value=e)},{default:a(()=>[t(je,{onCloseModal:o[14]||(o[14]=e=>m.value=!1),detalleFactura:ee.value},null,8,["detalleFactura"])]),_:1},8,["modelValue"])],64))}};export{Tl as default};
