import{r as p,o as f,a9 as w,g as a,f as e,aV as g,e as l,aa as $,O as L,h as x,ah as M,Q as C,ad as D,aU as N,c as B,aY as G,aj as I,ai as J,af as R,ab as K,by as j}from"./index.04b71378.js";import{Q as P}from"./QPopupEdit.8696d16f.js";import{m as O,Q as q,d as z,a as U}from"./format.e804e329.js";import{Q as H}from"./QList.83f6954b.js";import{Q as E}from"./QForm.983e6460.js";import{C as F}from"./ClosePopup.4cd066b5.js";import{u as A}from"./useHelpers.5e8ffe27.js";import{a as W}from"./use-quasar.49982070.js";import"./axios.bc73b9b6.js";const X={class:"text-h6 text-center"},Z={class:"row q-pt-lg q-gutter-lg justify-center"},ee={class:"col-xs-12"},ae=l("label",{class:"text-center"},"Nombre:",-1),te={class:"col-xs-12"},le=l("label",{class:"text-center"},"Descripcion:",-1),oe={class:"col-xs-9 col-sm-12 q-mt-lg q-mb-md flex justify-center"},se={__name:"ModalProforma",props:["clausulas","aceptacion"],emits:["hideModal"],setup(Q,{emit:y}){const b=Q,{capitalize:V}=O,d=p(!1),t=p({nombre:"",descripcion:""}),{api:v,mostrarNotify:i}=A(),_=async()=>{try{b.clausulas.unshift({...t.value}),await v.post("/proforma/clausula",{clausulas:b.clausulas,aceptacion_proforma:b.aceptacion}),i("positive","Clausula agregada exitosamente"),y("hideModal")}catch(h){console.log(h),i("warning","No se pudo agregar la clausula")}};return(h,o)=>(f(),w(N,{style:{width:"500px !important","max-width":"80vw"}},{default:a(()=>[e(g,null,{default:a(()=>[l("div",X,[$(" Nueva Clausula "),L(e(x,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[F]])])]),_:1}),e(M,{inset:""}),e(g,{class:"q-pt-none"},{default:a(()=>[e(E,{onSubmit:_},{default:a(()=>[l("div",Z,[l("div",ee,[ae,e(C,{modelValue:t.value.nombre,"onUpdate:modelValue":o[0]||(o[0]=n=>t.value.nombre=n),modelModifiers:{trim:!0},onKeyup:o[1]||(o[1]=n=>t.value.nombre=D(V)(t.value.nombre)),dense:"",filled:"",required:""},null,8,["modelValue"])]),l("div",te,[le,e(C,{type:"textarea",rows:"3",onKeyup:o[2]||(o[2]=n=>t.value.descripcion=D(V)(t.value.descripcion)),modelValue:t.value.descripcion,"onUpdate:modelValue":o[3]||(o[3]=n=>t.value.descripcion=n),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])]),l("div",oe,[e(x,{label:"Guardar",loading:d.value,outline:"",rounded:"",class:"q-px-xl",type:"submit",style:{color:"#696cff"}},null,8,["loading"])])])]),_:1})]),_:1})]),_:1}))}},ue={class:"text-h6 text-center"},ne={class:"row q-pt-lg q-gutter-lg justify-center"},re={class:"col-xs-12"},de=l("label",{class:"text-center"},"Detalle:",-1),ce={class:"col-xs-9 col-sm-12 q-mt-lg q-mb-md flex justify-center"},ie={__name:"ModalAceptacionPropuesta",props:["clausulas","aceptacion","proforma_id"],emits:["hideModal"],setup(Q,{emit:y}){const b=Q,{capitalize:V}=O,d=p(!1),t=p(""),{api:v,mostrarNotify:i}=A(),_=async()=>{try{await v.post("/proforma/clausula",{clausulas:b.clausulas,aceptacion_proforma:t.value}),i("positive","Clausula agregada exitosamente"),y("hideModal")}catch{i("warning","No se pudo agregar la clausula")}};return(h,o)=>(f(),w(N,{style:{width:"500px !important","max-width":"80vw"}},{default:a(()=>[e(g,null,{default:a(()=>[l("div",ue,[$(" Aceptaci\xF3n de la propuesta "),L(e(x,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[F]])])]),_:1}),e(M,{inset:""}),e(g,{class:"q-pt-none"},{default:a(()=>[e(E,{onSubmit:_},{default:a(()=>[l("div",ne,[l("div",re,[de,e(C,{type:"textarea",rows:"4",modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=n=>t.value=n),modelModifiers:{trim:!0},onKeyup:o[1]||(o[1]=n=>t.value=D(V)(t.value)),dense:"",filled:"",required:""},null,8,["modelValue"])]),l("div",ce,[e(x,{label:"Guardar",loading:d.value,outline:"",rounded:"",class:"q-px-xl",type:"submit",style:{color:"#696cff"}},null,8,["loading"])])])]),_:1})]),_:1})]),_:1}))}},me={class:"q-ma-lg q-pt-md"},pe={class:"row q-col-gutter-lg"},fe={class:"col-xs-12 col-sm-7"},ve=l("div",{class:"text-h6 q-pt-sm"},"Clausulas de la propuesta",-1),_e={class:"text-weight-medium text-left"},ge={class:"text-weight-medium text-justify"},xe={class:"text-grey-8 q-gutter-xs"},ye={class:"col-xs-12 col-sm-5"},be=l("div",{class:"text-h6 q-pt-sm"},"Aceptaci\xF3n de la propuesta",-1),Ve={class:"text-weight-medium text-justify",id:"text-aceptacion"},he={class:"text-grey-8 q-gutter-xs"},Se={__name:"IndexPage",setup(Q){const{api:y,claim:b,mostrarNotify:V}=A(),d=p([]),t=p(""),v=p("");p(!1);const i=p(!1),_=p(!1),h=W(),o=async()=>{const{data:m}=await y.get(`/proforma/${b.company.id}`);v.value=m.id,d.value=m.clausulas?m.clausulas:[],t.value=m.aceptacion_proforma?m.aceptacion_proforma:""},n=async()=>{setTimeout(async()=>{await y.patch(`/proforma/${v.value}`,{clausulas:d.value,aceptacion_proforma:t.value})},1e3)},T=m=>{h.dialog({title:"Confirmar",message:"Deseas quitar esta clausula?",ok:{push:!0,label:"Quitar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{d.value.splice(m,1),n()}catch(s){V("negative",s.response.data.message)}})},Y=()=>{h.dialog({title:"Confirmar",message:"Deseas quitar esta aceptaci\xF3n?",ok:{push:!0,label:"Quitar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{await y.patch(`/proforma/${v.value}`,{clausulas:d.value,aceptacion_proforma:""}),o()}catch(m){V("negative",m.response.data.message)}})};return o(),(m,s)=>(f(),B(I,null,[l("div",me,[l("div",pe,[l("div",fe,[e(N,{class:"my-card"},{default:a(()=>[e(g,{class:"text-white flex justify-between q-pt-sm q-pb-sm"},{default:a(()=>[ve,e(x,{onClick:s[0]||(s[0]=u=>i.value=!0),round:"",color:"primary",icon:"add"})]),_:1}),e(M),e(g,{class:"q-pa-none"},{default:a(()=>[e(H,{bordered:"",class:"rounded-borders q-pt-sm"},{default:a(()=>{var u;return[((u=d.value)==null?void 0:u.length)>0?(f(!0),B(I,{key:0},J(d.value,(r,k)=>(f(),w(U,{key:k},{default:a(()=>[e(q,{top:"",class:"col-2 gt-sm flex flex-center"},{default:a(()=>[l("span",_e,[$(K(r.nombre)+" ",1),e(P,{modelValue:r.nombre,"onUpdate:modelValue":c=>r.nombre=c,buttons:"",onSave:n,"label-set":"Guardar","label-cancel":"Cancelar","auto-save":""},{default:a(c=>[e(C,{modelValue:c.value,"onUpdate:modelValue":S=>c.value=S,dense:"",autofocus:"",counter:"",onKeyup:j(c.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024),e(q,{top:""},{default:a(()=>[l("span",ge,[$(K(r.descripcion)+" ",1),e(P,{modelValue:r.descripcion,"onUpdate:modelValue":c=>r.descripcion=c,buttons:"",onSave:n,"label-set":"Guardar","label-cancel":"Cancelar","auto-save":""},{default:a(c=>[e(C,{type:"textarea",rows:"4",modelValue:c.value,"onUpdate:modelValue":S=>c.value=S,dense:"",autofocus:"",counter:"",onKeyup:j(c.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024),e(q,{top:"",side:"",class:"flex flex-center"},{default:a(()=>[l("div",xe,[e(x,{class:"gt-xs",onClick:c=>T(k),size:"12px",flat:"",dense:"",round:"",icon:"delete"},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128)):(f(),w(U,{key:1,class:"text-center"},{default:a(()=>[e(q,{top:"",class:"col-12 gt-sm"},{default:a(()=>[e(z,{class:"q-mt-sm"},{default:a(()=>[$(" No hay clausulas ")]),_:1})]),_:1})]),_:1}))]}),_:1})]),_:1})]),_:1})]),l("div",ye,[e(N,{class:"my-card"},{default:a(()=>[e(g,{class:"text-white flex justify-between q-pt-sm q-pb-sm"},{default:a(()=>{var u;return[be,((u=t.value)==null?void 0:u.length)==0?(f(),w(x,{key:0,onClick:s[1]||(s[1]=r=>_.value=!0),round:"",color:"primary",icon:"add"})):R("",!0)]}),_:1}),e(M),e(g,{class:"q-pa-none"},{default:a(()=>[e(H,{bordered:"",class:"rounded-borders q-pt-sm"},{default:a(()=>{var u;return[((u=t.value)==null?void 0:u.length)>0?(f(),w(U,{key:0},{default:a(()=>[e(q,{top:""},{default:a(()=>[l("span",Ve,[$(K(t.value)+" ",1),e(P,{modelValue:t.value,"onUpdate:modelValue":s[2]||(s[2]=r=>t.value=r),buttons:"",onSave:n,"label-set":"Guardar","label-cancel":"Cancelar","auto-save":""},{default:a(r=>[e(C,{type:"textarea",rows:"4",modelValue:r.value,"onUpdate:modelValue":k=>r.value=k,dense:"",autofocus:"",counter:"",onKeyup:j(r.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])]),_:1}),e(q,{top:"",side:""},{default:a(()=>[l("div",he,[e(x,{class:"gt-xs",onClick:Y,size:"12px",flat:"",dense:"",round:"",icon:"delete"})])]),_:1})]),_:1})):(f(),w(U,{key:1,class:"text-center"},{default:a(()=>[e(q,{top:"",class:"col-12 gt-sm"},{default:a(()=>[e(z,{class:"q-mt-sm"},{default:a(()=>[$(" No hay clausulas ")]),_:1})]),_:1})]),_:1}))]}),_:1})]),_:1})]),_:1})])])]),e(G,{modelValue:i.value,"onUpdate:modelValue":s[4]||(s[4]=u=>i.value=u)},{default:a(()=>[e(se,{clausulas:d.value,aceptacion:t.value,onHideModal:s[3]||(s[3]=u=>(i.value=!1,o()))},null,8,["clausulas","aceptacion"])]),_:1},8,["modelValue"]),e(G,{modelValue:_.value,"onUpdate:modelValue":s[6]||(s[6]=u=>_.value=u)},{default:a(()=>[e(ie,{clausulas:d.value,aceptacion:t.value,proforma_id:v.value,onHideModal:s[5]||(s[5]=u=>(_.value=!1,o()))},null,8,["clausulas","aceptacion","proforma_id"])]),_:1},8,["modelValue"])],64))}};export{Se as default};
