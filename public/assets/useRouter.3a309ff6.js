import{a as d}from"./axios.ab86b581.js";import{u as b}from"./useHelpers.1b2bb70e.js";import{r as t}from"./index.2f0c67bd.js";const l=t(!1),y=t(!0),m=t([]),a=t({id:"",nombre:"",user_api:"",tipo_router:"",password_api:"",ubicacion:"",registro_trafico:"",ip_host:"",puerto_api:"",control_velocidad:"",seguridad:"",seguridad_alterna:"",company_id:""}),s=t({nombre:{message:"",isValid:!0},user_api:{message:"",isValid:!0},tipo_router:{message:"",isValid:!0},password_api:{message:"",isValid:!0},ubicacion:{message:"",isValid:!0},registro_trafico:{message:"",isValid:!0},ip_host:{message:"",isValid:!0},puerto_api:{message:"",isValid:!0},control_velocidad:{message:"",isValid:!0},seguridad:{message:"",isValid:!0},seguridad_alterna:{message:"",isValid:!0},company_id:{message:"",isValid:!0}}),w=async()=>{m.value=[];const{data:p}=await d.get("/companies/true");p.forEach(r=>{m.value.push({label:r.nombre_comercial,value:r.id})})},R=p=>{const{mostrarNotify:r,claim:n,router:g,route:v}=b(),c=["nombre","user_api","tipo_router","password_api","ubicacion","registro_trafico","control_velocidad","seguridad","seguridad_alterna","ip_host","puerto_api"],f=()=>{a.value={id:"",nombre:"",user_api:"",tipo_router:"",password_api:"",ubicacion:"",registro_trafico:"",ip_host:"",control_velocidad:"",puerto_api:"",seguridad:"",seguridad_alterna:"",company_id:""}},h=()=>{c.push("ip_host","company_id"),c.forEach(e=>{s.value[e].isValid=!0})},V=()=>{let e=!1;const i=/^([0-9]{1,3}\.){3}[0-9]{1,3}$/,o=a.value.ip_host;return i.test(o)&&(o.split(".").every(_=>parseInt(_,10)>=0&&parseInt(_,10)<=255)?(s.value.ip_host.isValid=!0,e=!1):(s.value.ip_host.message="la ip no es valida",s.value.ip_host.isValid=!1,e=!0)),c.forEach(u=>{a.value[u].length==0&&(s.value[u].message="Debes completar este campo",s.value[u].isValid=!1,e=!0)}),!p&&a.value.company_id.length==0&&n.roles[0]=="Super-Administrador"&&(s.value.company_id.message="Debes elegir una empresa",s.value.company_id.isValid=!1,e=!0),e};return{api:d,claim:n,formRouter:a,loading:l,limpiarFormulario:f,listCompanies:m,showPass:y,validaciones:s,cargarCompanies:w,quitarErrores:h,route:v,onSubmit:async e=>{if(!V())try{l.value=!0;let i={headers:{company_id:a.value.company_id,NotSetHeaderCompany:n.roles[0]=="Super-Administrador"}},o;e?o=await d.patch("/router/"+a.value.id,a.value):o=await d.post("/router",a.value,i),r("positive",`Router ${e?"editado":"agregado"} exitosamente`),l.value=!1,g.push({name:"index.routers"})}catch(i){l.value=!1,r("warning",i.response.data.message)}}}};export{R as u};
