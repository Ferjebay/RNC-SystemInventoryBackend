import{api as l}from"./axios.5c7113cb.js";import{u as h}from"./useHelpers.b36448cb.js";import{r as t}from"./index.d115d997.js";const u=t(!1),V=t(!0),c=t([]),i=t({id:"",nombre:"",user_api:"",tipo_router:"",password_api:"",ubicacion:"",registro_trafico:"",ip_host:"",puerto_api:"",control_velocidad:"",seguridad:"",seguridad_alterna:"",company_id:""}),s=t({nombre:{message:"",isValid:!0},user_api:{message:"",isValid:!0},tipo_router:{message:"",isValid:!0},password_api:{message:"",isValid:!0},ubicacion:{message:"",isValid:!0},registro_trafico:{message:"",isValid:!0},ip_host:{message:"",isValid:!0},puerto_api:{message:"",isValid:!0},control_velocidad:{message:"",isValid:!0},seguridad:{message:"",isValid:!0},seguridad_alterna:{message:"",isValid:!0},company_id:{message:"",isValid:!0}}),b=async()=>{c.value=[];const{data:d}=await l.get("/companies/true");d.forEach(o=>{c.value.push({label:o.nombre_comercial,value:o.id})})},E=d=>{const{mostrarNotify:o,claim:n,router:m,route:_}=h(),p=["nombre","user_api","tipo_router","password_api","ubicacion","registro_trafico","control_velocidad","seguridad","seguridad_alterna","puerto_api"],g=()=>{i.value={id:"",nombre:"",user_api:"",tipo_router:"",password_api:"",ubicacion:"",registro_trafico:"",ip_host:"",control_velocidad:"",seguridad:"",seguridad_alterna:"",company_id:""}},v=()=>{p.push("ip_host","company_id"),p.forEach(e=>{s.value[e].isValid=!0})},f=()=>{let e=!1;p.forEach(r=>{i.value[r].length==0&&(s.value[r].message="Debes completar este campo",s.value[r].isValid=!1,e=!0)});const a=i.value.ip_host.split(".");return a.length==1?(s.value.ip_host.message="Ingresa el IP/HOST",s.value.ip_host.isValid=!1,e=!0):a.length>1&&(a[0].includes("_")||a[1].includes("_")||a[2].includes("_")||a[3].includes("_"))&&(s.value.ip_host.message="Completa este campo",s.value.ip_host.isValid=!1,e=!0),!d&&i.value.company_id.length==0&&n.roles[0]=="Super-Administrador"&&(s.value.company_id.message="Debes elegir una empresa",s.value.company_id.isValid=!1,e=!0),e};return{api:l,claim:n,formRouter:i,loading:u,limpiarFormulario:g,listCompanies:c,showPass:V,validaciones:s,cargarCompanies:b,quitarErrores:v,route:_,onSubmit:async e=>{if(!f())try{u.value=!0;let a={headers:{company_id:i.value.company_id,NotSetHeaderCompany:n.roles[0]=="Super-Administrador"}},r;e?r=await l.patch("/router/"+i.value.id,i.value):r=await l.post("/router",i.value,a),o("positive",`Router ${e?"editado":"agregado"} exitosamente`),u.value=!1,m.push({name:"index.routers"})}catch(a){u.value=!1,o("warning",a.response.data.message)}}}};export{E as u};
