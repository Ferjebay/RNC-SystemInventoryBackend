import{Q as oe,a as L,b as R,c as te}from"./QTable.df3e25c9.js";import{Q as se,a as ne,b as O}from"./QPageSticky.1cdb0d3b.js";import{r as v,t as ie,C as P,d as D,o as r,ab as p,g as t,af as o,e as s,f as l,Q as S,h as _,aM as I,ac as q,O as F,aN as B,N as W,c as $,aP as w,aQ as k,aR as j,aj as Q,ai as re,i as E,ad as z}from"./index.becc66bd.js";import{C as U}from"./ClosePopup.796684c7.js";import{api as A}from"./axios.44f0b70d.js";import{u as X}from"./useHelpers.62c49a13.js";import{Q as ue}from"./QSelect.467cdfd1.js";import{Q as ce}from"./QForm.c1623bd2.js";import"./QList.66169e49.js";import"./QItemLabel.8aa7a3d0.js";import"./use-quasar.0f71ce4b.js";import"./QChip.e97fbc5d.js";import"./format.2bc25e5f.js";const N=v(!1),a=v({nombre:"",direccion:"",establecimiento:"",punto_emision:"",secuencia_factura_produccion:"",secuencia_factura_pruebas:"",ambiente:"PRUEBA"}),G=v(!1),H=v(!1),J=v(!1),K=()=>{const{mostrarNotify:b}=X(),y=()=>{a.value.nombre="",a.value.direccion="",a.value.establecimiento="",a.value.punto_emision="",a.value.secuencia_factura_produccion=""},n=()=>{a.value.establecimiento=a.value.establecimiento.toString().replace(/\D/g,""),a.value.punto_emision=a.value.punto_emision.toString().replace(/\D/g,""),a.value.secuencia_factura_produccion=a.value.secuencia_factura_produccion.toString().replace(/\D/g,"")};return ie(()=>{P(a.value,(m,x)=>{a.value.nombre=m.nombre.toUpperCase()})}),{actualizarLista:J,formSucursal:a,loading:N,limpiarFormulario:y,allowOnlyNumber:n,modalAgregarSucursal:G,modalEditarSucursal:H,onSubmit:async m=>{if(parseInt(a.value.establecimiento)<=0||parseInt(a.value.punto_emision)<=0||parseInt(a.value.secuencia_factura_produccion)<=0)return b("warning","Los valores deben ser mayor o igual a 1");try{N.value=!0,m?(a.value.establecimiento=a.value.establecimiento.toString(),a.value.punto_emision=a.value.punto_emision.toString(),a.value.secuencia_factura_produccion=a.value.secuencia_factura_produccion.toString(),await A.patch("/sucursal/"+a.value.id,a.value)):await A.post("/sucursal",a.value),b("positive",`Sucursal ${m?"editado":"agregado"} exitosamente`),G.value=!1,H.value=!1,J.value=!0,N.value=!1}catch(x){b("warning",x.response.data.message),N.value=!1}}}},de={class:"row q-pt-lg q-gutter-lg justify-center"},me={class:"col-xs-12 col-md-11"},fe=s("label",null,"Nombre del establecimiento:",-1),pe={class:"col-xs-12 col-md-11"},_e=s("label",null,"Direcci\xF3n:",-1),ge={class:"col-xs-12 col-md-5"},ve=s("label",null,"Numero de Establecimiento:",-1),be={class:"col-xs-12 col-md-5"},ye=s("label",null,"N\xB0 punto de emisi\xF3n:",-1),xe={class:"col-xs-12 col-md-5"},he=s("label",null,"N\xB0 secuencial Factura:",-1),we={class:"col-xs-12 col-md-5"},Se=s("label",null,"N\xB0 secuencial Factura Pruebas:",-1),Ve={class:"col-xs-12 col-md-5"},ke=s("label",null,"Ambiente:",-1),qe={class:"col-xs-9 col-md-12 flex justify-center"},Y=D({__name:"FormSucursal",props:{edit:{type:Boolean}},setup(b){const y=b,{formSucursal:n,loading:u,allowOnlyNumber:m,onSubmit:x}=K();return(V,i)=>(r(),p(ce,{onSubmit:i[7]||(i[7]=c=>o(x)(y.edit))},{default:t(()=>[s("div",de,[s("div",me,[fe,l(S,{modelValue:o(n).nombre,"onUpdate:modelValue":i[0]||(i[0]=c=>o(n).nombre=c),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])]),s("div",pe,[_e,l(S,{modelValue:o(n).direccion,"onUpdate:modelValue":i[1]||(i[1]=c=>o(n).direccion=c),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])]),s("div",ge,[ve,l(S,{modelValue:o(n).establecimiento,"onUpdate:modelValue":i[2]||(i[2]=c=>o(n).establecimiento=c),maxlength:3,dense:"",filled:"",required:"",onKeyup:o(m)},null,8,["modelValue","onKeyup"])]),s("div",be,[ye,l(S,{modelValue:o(n).punto_emision,"onUpdate:modelValue":i[3]||(i[3]=c=>o(n).punto_emision=c),maxlength:3,dense:"",filled:"",required:"",onKeyup:o(m)},null,8,["modelValue","onKeyup"])]),s("div",xe,[he,l(S,{modelValue:o(n).secuencia_factura_produccion,"onUpdate:modelValue":i[4]||(i[4]=c=>o(n).secuencia_factura_produccion=c),modelModifiers:{trim:!0},maxlength:9,onKeyup:o(m),dense:"",filled:"",required:""},null,8,["modelValue","onKeyup"])]),s("div",we,[Se,l(S,{modelValue:o(n).secuencia_factura_pruebas,"onUpdate:modelValue":i[5]||(i[5]=c=>o(n).secuencia_factura_pruebas=c),modelModifiers:{trim:!0},maxlength:9,onKeyup:o(m),dense:"",filled:"",required:""},null,8,["modelValue","onKeyup"])]),s("div",Ve,[ke,l(ue,{dense:"",modelValue:o(n).ambiente,"onUpdate:modelValue":i[6]||(i[6]=c=>o(n).ambiente=c),modelModifiers:{trim:!0},filled:"",options:["PRODUCCION","PRUEBA"]},null,8,["modelValue"])]),s("div",qe,[l(_,{label:V.edit?"Editar":"Guardar",loading:o(u),class:"q-px-xl q-my-xs",type:"submit",color:"green-9"},null,8,["label","loading"])])])]),_:1}))}}),Ce={class:"text-h6"},$e=D({__name:"AddSucursal",setup(b){const{limpiarFormulario:y}=K();return y(),(n,u)=>(r(),p(I,{style:{width:"713px !important","max-width":"fit-content"}},{default:t(()=>[l(B,null,{default:t(()=>[s("div",Ce,[q(" Nueva Sucursal "),F(l(_,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[U]])])]),_:1}),l(W,{inset:""}),l(B,{class:"q-pt-none"},{default:t(()=>[l(Y,{edit:!1})]),_:1})]),_:1}))}}),Qe={class:"text-h6"},Ne=D({__name:"EditSucursal",setup(b){return(y,n)=>(r(),p(I,{style:{width:"713px !important","max-width":"fit-content"}},{default:t(()=>[l(B,null,{default:t(()=>[s("div",Qe,[q(" Editar Sucursal "),F(l(_,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[U]])])]),_:1}),l(W,{inset:""}),l(B,{class:"q-pt-none"},{default:t(()=>[l(Y,{edit:!0})]),_:1})]),_:1}))}}),Fe={class:"q-ma-lg q-pt-md"},Be={class:"row q-col-gutter-lg"},Ue={class:"col-12"},Ae={class:"full-width row flex-center text-lime-10 q-gutter-sm"},De=s("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun Resultado ",-1),Je=D({__name:"IndexPage",setup(b){const y=[{name:"acciones",label:"acciones",align:"center"},{align:"center",label:"Sucursal",field:"nombre",name:"nombre"},{align:"center",label:"Direcci\xF3n",field:"direccion",name:"direccion"},{align:"center",label:"N\xB0 de establecimiento",field:"establecimiento",name:"esta"},{label:"Punto de emisi\xF3n",field:"punto_emision",align:"center",name:"p_v"},{label:"N\xB0 de factura",field:"secuencia_factura_produccion",align:"center",name:"sec"},{name:"estado",label:"Estado",align:"center"}];let{actualizarLista:n,modalAgregarSucursal:u,modalEditarSucursal:m,formSucursal:x}=K();const V=v(""),i=v([]),c=v(!1),{mostrarNotify:M,confirmDelete:Z,isDeleted:ee}=X();P(n,(f,d)=>{f&&C()});const C=async()=>{c.value=!0;try{const{data:f}=await A.get("/sucursal");i.value=f,n.value=!1}catch(f){M("warning",f.response.data.message)}c.value=!1},T=async(f,d)=>{try{const{data:{msg:e}}=await A.patch(`/sucursal/${f}/${d}`);M("positive",e),C()}catch(e){console.log(e)}};P(ee,(f,d)=>{f&&C()});const le=async f=>{try{Z("Estas seguro de eliminar esta sucursal?",`/sucursal/${f}`)}catch(d){console.log(d)}};C();const h=v("list"),ae=v({rowsPerPage:10});return(f,d)=>(r(),$(Q,null,[s("div",Fe,[s("div",Be,[s("div",Ue,[l(I,{flat:"",class:"shadow_custom"},{default:t(()=>[l(oe,{"title-class":"text-grey-7 text-h6",title:"Listado de Sucursales",rows:i.value,loading:c.value,"hide-header":h.value==="grid",columns:y,"row-key":"name",grid:h.value==="grid",filter:V.value,pagination:ae.value},{header:t(e=>[l(ne,{props:e,style:{height:"60px"}},{default:t(()=>[(r(!0),$(Q,null,re(e.cols,g=>(r(),p(te,{key:g.name,props:e,class:"text-grey-7 text-weight-bold text-uppercase",style:{"font-size":"13px"}},{default:t(()=>[q(z(g.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"top-right":t(e=>[f.$q.screen.xs?w("",!0):(r(),p(_,{key:0,onClick:d[0]||(d[0]=g=>k(u)?u.value=!o(u):u=!o(u)),outline:"",color:"primary",label:"Agregar Sucursal",class:"q-mr-xs"})),l(S,{outlined:"",dense:"",debounce:"300",modelValue:V.value,"onUpdate:modelValue":d[1]||(d[1]=g=>V.value=g),placeholder:"Buscar..."},{append:t(()=>[l(E,{name:"search"})]),_:1},8,["modelValue"]),h.value==="list"?(r(),p(_,{key:1,flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen},{default:t(()=>[F((r(),p(O,{disable:f.$q.platform.is.mobile},{default:t(()=>[q(z(e.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"),1)]),_:2},1032,["disable"])),[[U]])]),_:2},1032,["icon","onClick"])):w("",!0),e.inFullscreen?w("",!0):(r(),p(_,{key:2,flat:"",round:"",dense:"",icon:h.value==="grid"?"list":"grid_on",onClick:d[2]||(d[2]=g=>{h.value=h.value==="grid"?"list":"grid",f.separator=h.value==="grid"?"none":"horizontal"})},{default:t(()=>[F((r(),p(O,{disable:f.$q.platform.is.mobile},{default:t(()=>[q(z(h.value==="grid"?"List":"Grid"),1)]),_:1},8,["disable"])),[[U]])]),_:1},8,["icon"]))]),"body-cell-estado":t(e=>[l(L,{props:e},{default:t(()=>[e.row.isActive?(r(),p(R,{key:0,outline:"",color:"positive",label:"Activo",class:"q-pa-sm"})):(r(),p(R,{key:1,outline:"",color:"red",label:"Inactivo",class:"q-pa-sm"}))]),_:2},1032,["props"])]),"body-cell-acciones":t(e=>[l(L,{props:e},{default:t(()=>[l(_,{round:"",color:"blue-grey",onClick:g=>(k(x)?x.value={...e.row}:x={...e.row},k(m)?m.value=!0:m=!0),icon:"edit",class:"q-mr-sm",size:"10px"},null,8,["onClick"]),e.row.isActive?(r(),$(Q,{key:0},[e.row.isActive?(r(),p(_,{key:0,round:"",color:"blue-grey",icon:"close",onClick:g=>T(e.row.id,!1),size:"10px"},null,8,["onClick"])):w("",!0)],64)):(r(),$(Q,{key:1},[e.row.isActive?w("",!0):(r(),p(_,{key:0,round:"",color:"blue-grey",icon:"done",onClick:g=>T(e.row.id,!0),size:"10px"},null,8,["onClick"])),e.row.estado?w("",!0):(r(),p(_,{key:1,round:"",color:"blue-grey",class:"q-ml-sm",icon:"delete",onClick:g=>le(e.row.id),size:"10px"},null,8,["onClick"]))],64))]),_:2},1032,["props"])]),"no-data":t(({icon:e})=>[s("div",Ae,[l(E,{size:"2em",name:"sentiment_dissatisfied"}),De,l(E,{size:"2em",name:V.value?"filter_b_and_w":e},null,8,["name"])])]),_:1},8,["rows","loading","hide-header","grid","filter","pagination"])]),_:1})])])]),f.$q.screen.xs?(r(),p(se,{key:0,position:"bottom-right",offset:[18,18]},{default:t(()=>[l(_,{round:"",color:"secondary",size:"lg",icon:"add",onClick:d[3]||(d[3]=e=>k(u)?u.value=!o(u):u=!o(u))})]),_:1})):w("",!0),l(j,{modelValue:o(u),"onUpdate:modelValue":d[4]||(d[4]=e=>k(u)?u.value=e:u=e)},{default:t(()=>[l($e)]),_:1},8,["modelValue"]),l(j,{modelValue:o(m),"onUpdate:modelValue":d[5]||(d[5]=e=>k(m)?m.value=e:m=e)},{default:t(()=>[l(Ne)]),_:1},8,["modelValue"])],64))}});export{Je as default};
